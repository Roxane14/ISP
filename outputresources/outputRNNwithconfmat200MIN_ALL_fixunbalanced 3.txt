nter passphrase for key '/home/delairra/.ssh/id_ed25519':
Enumerating objects: 449, done.
Counting objects: 100% (444/444), done.
Delta compression using up to 8 threads
Compressing objects: 100% (435/435), done.
Writing objects: 100% (435/435), 17.96 MiB | 1.70 MiB/s, done.
Total 435 (delta 254), reused 0 (delta 0)
remote: Resolving deltas: 100% (254/254), completed with 8 local objects.
To github.com:Roxane14/ISP.git
   87ff0d1..952caef  main -> main
delairra@LAPTOP-2L5S26NL:/mnt/c/Users/delai/Desktop/root/Cours/FIB/ISP/gitrepo/ISP/scripts$ python3 trainingModelsFromCsv_fix_unbalanced.py
2021-01-13 01:51:08.828680: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2021-01-13 01:51:08.829789: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
nb different output for 5 is 2
nb different output for 6 is 2
nb different output for 7 is 2
nb different output for 8 is 2
nb different output for 9 is 2
nb different output for 10 is 3
nb different output for 11 is 3
nb different output for 12 is 3
nb different output for 13 is 3
nb different output for 14 is 3
nb different output for 15 is 4
nb different output for 16 is 4
nb different output for 17 is 4
nb different output for 18 is 4
nb different output for 19 is 5
nb different output for 20 is 4
nb different output for 21 is 4
nb different output for 22 is 5
nb different output for 23 is 4
nb different output for 24 is 5
nb different output for 25 is 4
nb different output for 26 is 5
nb different output for 27 is 5
nb different output for 28 is 4
nb different output for 29 is 5
nb different output for 30 is 4
nb different output for 31 is 4
nb different output for 32 is 4
nb different output for 33 is 3
nb different output for 34 is 3
nb different output for 35 is 3
nb different output for 36 is 3
nb different output for 37 is 3
nb different output for 38 is 3
nb different output for 39 is 2
nb different output for 40 is 2
nb different output for 41 is 2
Dummy note
Dummy note
Dummy note
Dummy note
Dummy note
For 5 nbtrain = 93762, nbtest = 23442
For 6 nbtrain = 24055, nbtest = 6015
For 7 nbtrain = 58380, nbtest = 14597
For 8 nbtrain = 56838, nbtest = 14210
For 9 nbtrain = 21930, nbtest = 5484
For 10 nbtrain = 89730, nbtest = 22434
For 11 nbtrain = 22051, nbtest = 5514
For 12 nbtrain = 83854, nbtest = 20965
For 13 nbtrain = 34177, nbtest = 8546
For 14 nbtrain = 38497, nbtest = 9626
For 15 nbtrain = 85353, nbtest = 21341
For 16 nbtrain = 23927, nbtest = 5984
For 17 nbtrain = 84061, nbtest = 21017
For 18 nbtrain = 25957, nbtest = 6490
For 19 nbtrain = 87853, nbtest = 21967
For 20 nbtrain = 65779, nbtest = 16445
For 21 nbtrain = 32979, nbtest = 8246
For 22 nbtrain = 83176, nbtest = 20797
For 23 nbtrain = 25894, nbtest = 6476
For 24 nbtrain = 101424, nbtest = 25359
For 25 nbtrain = 40952, nbtest = 10239
For 26 nbtrain = 50087, nbtest = 12524
For 27 nbtrain = 68049, nbtest = 17015
For 28 nbtrain = 22896, nbtest = 5726
For 29 nbtrain = 65069, nbtest = 16268
For 30 nbtrain = 21093, nbtest = 5275
For 31 nbtrain = 48768, nbtest = 12195
For 32 nbtrain = 36088, nbtest = 9024
For 33 nbtrain = 17950, nbtest = 4489
For 34 nbtrain = 39836, nbtest = 9960
For 35 nbtrain = 11204, nbtest = 2802
For 36 nbtrain = 32911, nbtest = 8229
For 37 nbtrain = 13030, nbtest = 3259
For 38 nbtrain = 14172, nbtest = 3545
For 39 nbtrain = 19534, nbtest = 4885
For 40 nbtrain = 5403, nbtest = 1352
For 41 nbtrain = 12937, nbtest = 3236
Dummy note
Dummy note
Dummy note
Dummy note
Dummy note
Dummy note
Dummy note
trainingshape 5
(93762, 7)
(93762, 7, 1)
testingshape 5
(23442, 7)
(23442, 7, 1)
nb occurences
Counter({0: 59057, 1: 34705})
weights={0: 1.5876526068035963, 1: 2.7016856360754935}
2021-01-13 01:51:17.909190: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-01-13 01:51:17.909640: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2021-01-13 01:51:17.910253: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (LAPTOP-2L5S26NL): /proc/driver/nvidia/version does not exist
2021-01-13 01:51:17.912753: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-01-13 01:51:17.938967: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2100000000 Hz
2021-01-13 01:51:17.942299: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x6a61db0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-01-13 01:51:17.942750: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru (GRU)                    (None, 7, 8)              264
_________________________________________________________________
gru_1 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense (Dense)                (None, 2)                 18
_________________________________________________________________
activation (Activation)      (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
733/733 [==============================] - 5s 7ms/step - loss: 0.9581 - accuracy: 0.7969
Epoch 2/40
733/733 [==============================] - 5s 6ms/step - loss: 0.8084 - accuracy: 0.8333
Epoch 3/40
733/733 [==============================] - 4s 6ms/step - loss: 0.7220 - accuracy: 0.8504
Epoch 4/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6774 - accuracy: 0.8562
Epoch 5/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6674 - accuracy: 0.8583
Epoch 6/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6599 - accuracy: 0.8595
Epoch 7/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6551 - accuracy: 0.8602
Epoch 8/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6504 - accuracy: 0.8613
Epoch 9/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6483 - accuracy: 0.8609
Epoch 10/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6432 - accuracy: 0.8630
Epoch 11/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6408 - accuracy: 0.8629
Epoch 12/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6403 - accuracy: 0.8632
Epoch 13/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6380 - accuracy: 0.8639
Epoch 14/40
733/733 [==============================] - 5s 6ms/step - loss: 0.6369 - accuracy: 0.8635
Epoch 15/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6344 - accuracy: 0.8643
Epoch 16/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6328 - accuracy: 0.8640
Epoch 17/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6323 - accuracy: 0.8651
Epoch 18/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6300 - accuracy: 0.8654
Epoch 19/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6302 - accuracy: 0.8658
Epoch 20/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6292 - accuracy: 0.8660
Epoch 21/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6279 - accuracy: 0.8666
Epoch 22/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6259 - accuracy: 0.8662
Epoch 23/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6255 - accuracy: 0.8665
Epoch 24/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6248 - accuracy: 0.8670
Epoch 25/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6238 - accuracy: 0.8677
Epoch 26/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6232 - accuracy: 0.8673
Epoch 27/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6236 - accuracy: 0.8675
Epoch 28/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6210 - accuracy: 0.8670
Epoch 29/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6207 - accuracy: 0.8684
Epoch 30/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6200 - accuracy: 0.8675
Epoch 31/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6196 - accuracy: 0.8677
Epoch 32/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6187 - accuracy: 0.8683
Epoch 33/40
733/733 [==============================] - 4s 5ms/step - loss: 0.6178 - accuracy: 0.8674
Epoch 34/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6173 - accuracy: 0.8674
Epoch 35/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6176 - accuracy: 0.8681
Epoch 36/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6150 - accuracy: 0.8685
Epoch 37/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6159 - accuracy: 0.8683
Epoch 38/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6140 - accuracy: 0.8686
Epoch 39/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6147 - accuracy: 0.8686
Epoch 40/40
733/733 [==============================] - 4s 6ms/step - loss: 0.6136 - accuracy: 0.8691
184/184 [==============================] - 0s 2ms/step - loss: 0.2965 - accuracy: 0.8726


For 5: Test ACC=[0.29652276635169983, 0.8726217746734619]
Confusion Matrix
[[13392  1373]
 [ 1613  7064]]
Classification Report
              precision    recall  f1-score   support

           0       0.89      0.91      0.90     14765
           1       0.84      0.81      0.83      8677

    accuracy                           0.87     23442
   macro avg       0.86      0.86      0.86     23442
weighted avg       0.87      0.87      0.87     23442

WARNING:tensorflow:From /home/delairra/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-01-13 01:54:14.912690: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/delairra/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
trainingshape 6
(24055, 7)
(24055, 7, 1)
testingshape 6
(6015, 7)
(6015, 7, 1)
nb occurences
Counter({0: 14460, 1: 9595})
weights={0: 1.6635546334716458, 1: 2.5070349140177175}
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_2 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_3 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_1 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
188/188 [==============================] - 1s 7ms/step - loss: 1.3005 - accuracy: 0.6309
Epoch 2/40
188/188 [==============================] - 1s 6ms/step - loss: 1.1178 - accuracy: 0.7199
Epoch 3/40
188/188 [==============================] - 1s 6ms/step - loss: 1.0741 - accuracy: 0.7456
Epoch 4/40
188/188 [==============================] - 1s 6ms/step - loss: 1.0430 - accuracy: 0.7583
Epoch 5/40
188/188 [==============================] - 1s 6ms/step - loss: 1.0187 - accuracy: 0.7633
Epoch 6/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9998 - accuracy: 0.7694
Epoch 7/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9879 - accuracy: 0.7758
Epoch 8/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9764 - accuracy: 0.7773
Epoch 9/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9644 - accuracy: 0.7826
Epoch 10/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9592 - accuracy: 0.7842
Epoch 11/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9478 - accuracy: 0.7868
Epoch 12/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9428 - accuracy: 0.7892
Epoch 13/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9357 - accuracy: 0.7924
Epoch 14/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9309 - accuracy: 0.7958
Epoch 15/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9279 - accuracy: 0.7957
Epoch 16/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9229 - accuracy: 0.7982
Epoch 17/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9214 - accuracy: 0.8003
Epoch 18/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9166 - accuracy: 0.7994
Epoch 19/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9164 - accuracy: 0.8029
Epoch 20/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9114 - accuracy: 0.8038
Epoch 21/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9051 - accuracy: 0.8054
Epoch 22/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9025 - accuracy: 0.8055
Epoch 23/40
188/188 [==============================] - 1s 6ms/step - loss: 0.9022 - accuracy: 0.8065
Epoch 24/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8973 - accuracy: 0.8063
Epoch 25/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8943 - accuracy: 0.8086
Epoch 26/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8927 - accuracy: 0.8080
Epoch 27/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8891 - accuracy: 0.8081
Epoch 28/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8886 - accuracy: 0.8099
Epoch 29/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8846 - accuracy: 0.8109
Epoch 30/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8828 - accuracy: 0.8127
Epoch 31/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8795 - accuracy: 0.8120
Epoch 32/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8773 - accuracy: 0.8138
Epoch 33/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8749 - accuracy: 0.8145
Epoch 34/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8751 - accuracy: 0.8144
Epoch 35/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8717 - accuracy: 0.8136
Epoch 36/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8727 - accuracy: 0.8134
Epoch 37/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8693 - accuracy: 0.8135
Epoch 38/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8688 - accuracy: 0.8154
Epoch 39/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8631 - accuracy: 0.8150
Epoch 40/40
188/188 [==============================] - 1s 6ms/step - loss: 0.8639 - accuracy: 0.8147
47/47 [==============================] - 0s 2ms/step - loss: 0.4198 - accuracy: 0.8213


For 6: Test ACC=[0.4198138415813446, 0.8212801218032837]
Confusion Matrix
[[3067  549]
 [ 526 1873]]
Classification Report
              precision    recall  f1-score   support

           0       0.85      0.85      0.85      3616
           1       0.77      0.78      0.78      2399

    accuracy                           0.82      6015
   macro avg       0.81      0.81      0.81      6015
weighted avg       0.82      0.82      0.82      6015

trainingshape 7
(58380, 7)
(58380, 7, 1)
testingshape 7
(14597, 7)
(14597, 7, 1)
nb occurences
Counter({0: 39524, 1: 18856})
weights={0: 1.4770772189049692, 1: 3.0960967331353415}
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_4 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_5 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_2 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
457/457 [==============================] - 3s 6ms/step - loss: 1.0925 - accuracy: 0.7368
Epoch 2/40
457/457 [==============================] - 3s 6ms/step - loss: 0.8684 - accuracy: 0.8372
Epoch 3/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7955 - accuracy: 0.8627
Epoch 4/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7808 - accuracy: 0.8646
Epoch 5/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7717 - accuracy: 0.8663
Epoch 6/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7654 - accuracy: 0.8677
Epoch 7/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7583 - accuracy: 0.8692
Epoch 8/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7529 - accuracy: 0.8711
Epoch 9/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7503 - accuracy: 0.8708
Epoch 10/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7470 - accuracy: 0.8714
Epoch 11/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7439 - accuracy: 0.8719
Epoch 12/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7408 - accuracy: 0.8720
Epoch 13/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7378 - accuracy: 0.8724
Epoch 14/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7362 - accuracy: 0.8730
Epoch 15/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7324 - accuracy: 0.8730
Epoch 16/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7303 - accuracy: 0.8730
Epoch 17/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7285 - accuracy: 0.8729
Epoch 18/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7255 - accuracy: 0.8738
Epoch 19/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7232 - accuracy: 0.8737
Epoch 20/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7222 - accuracy: 0.8728
Epoch 21/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7204 - accuracy: 0.8727
Epoch 22/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7194 - accuracy: 0.8724
Epoch 23/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7173 - accuracy: 0.8734
Epoch 24/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7152 - accuracy: 0.8730
Epoch 25/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7155 - accuracy: 0.8725
Epoch 26/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7131 - accuracy: 0.8734
Epoch 27/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7123 - accuracy: 0.8729
Epoch 28/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7105 - accuracy: 0.8733
Epoch 29/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7092 - accuracy: 0.8735
Epoch 30/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7076 - accuracy: 0.8730
Epoch 31/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7076 - accuracy: 0.8735
Epoch 32/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7054 - accuracy: 0.8733
Epoch 33/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7044 - accuracy: 0.8744
Epoch 34/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7022 - accuracy: 0.8740
Epoch 35/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7025 - accuracy: 0.8734
Epoch 36/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7016 - accuracy: 0.8733
Epoch 37/40
457/457 [==============================] - 3s 6ms/step - loss: 0.7000 - accuracy: 0.8747
Epoch 38/40
457/457 [==============================] - 3s 6ms/step - loss: 0.6999 - accuracy: 0.8740
Epoch 39/40
457/457 [==============================] - 3s 6ms/step - loss: 0.6976 - accuracy: 0.8745
Epoch 40/40
457/457 [==============================] - 3s 6ms/step - loss: 0.6973 - accuracy: 0.8752
115/115 [==============================] - 0s 2ms/step - loss: 0.3393 - accuracy: 0.8734


For 7: Test ACC=[0.33927208185195923, 0.8733986616134644]
Confusion Matrix
[[8978  904]
 [ 944 3771]]
Classification Report
              precision    recall  f1-score   support

           0       0.90      0.91      0.91      9882
           1       0.81      0.80      0.80      4715

    accuracy                           0.87     14597
   macro avg       0.86      0.85      0.85     14597
weighted avg       0.87      0.87      0.87     14597

trainingshape 8
(56838, 7)
(56838, 7, 1)
testingshape 8
(14210, 7)
(14210, 7, 1)
nb occurences
Counter({0: 44931, 1: 11907})
weights={0: 1.2650063430593577, 1: 4.773494583018392}
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_6 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_7 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_3 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
445/445 [==============================] - 3s 6ms/step - loss: 1.1731 - accuracy: 0.6309
Epoch 2/40
445/445 [==============================] - 3s 6ms/step - loss: 0.9332 - accuracy: 0.7008
Epoch 3/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8634 - accuracy: 0.7099
Epoch 4/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8361 - accuracy: 0.7143
Epoch 5/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8236 - accuracy: 0.7159
Epoch 6/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8130 - accuracy: 0.7182
Epoch 7/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8058 - accuracy: 0.7204
Epoch 8/40
445/445 [==============================] - 3s 6ms/step - loss: 0.8008 - accuracy: 0.7215
Epoch 9/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7975 - accuracy: 0.7227
Epoch 10/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7928 - accuracy: 0.7232
Epoch 11/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7898 - accuracy: 0.7239
Epoch 12/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7871 - accuracy: 0.7247
Epoch 13/40
445/445 [==============================] - 2s 6ms/step - loss: 0.7846 - accuracy: 0.7253
Epoch 14/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7839 - accuracy: 0.7262
Epoch 15/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7813 - accuracy: 0.7265
Epoch 16/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7791 - accuracy: 0.7272
Epoch 17/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7791 - accuracy: 0.7273
Epoch 18/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7776 - accuracy: 0.7276
Epoch 19/40
445/445 [==============================] - 3s 8ms/step - loss: 0.7762 - accuracy: 0.7286
Epoch 20/40
445/445 [==============================] - 3s 7ms/step - loss: 0.7750 - accuracy: 0.7283
Epoch 21/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7741 - accuracy: 0.7289
Epoch 22/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7731 - accuracy: 0.7291
Epoch 23/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7715 - accuracy: 0.7290
Epoch 24/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7714 - accuracy: 0.7292
Epoch 25/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7689 - accuracy: 0.7292
Epoch 26/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7699 - accuracy: 0.7295
Epoch 27/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7685 - accuracy: 0.7298
Epoch 28/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7669 - accuracy: 0.7299
Epoch 29/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7669 - accuracy: 0.7300
Epoch 30/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7650 - accuracy: 0.7305
Epoch 31/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7673 - accuracy: 0.7292
Epoch 32/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7628 - accuracy: 0.7304
Epoch 33/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7633 - accuracy: 0.7308
Epoch 34/40
445/445 [==============================] - 3s 7ms/step - loss: 0.7620 - accuracy: 0.7310
Epoch 35/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7617 - accuracy: 0.7308
Epoch 36/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7600 - accuracy: 0.7313
Epoch 37/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7606 - accuracy: 0.7310
Epoch 38/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7595 - accuracy: 0.7316
Epoch 39/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7594 - accuracy: 0.7315
Epoch 40/40
445/445 [==============================] - 3s 6ms/step - loss: 0.7580 - accuracy: 0.7314
112/112 [==============================] - 0s 2ms/step - loss: 0.3988 - accuracy: 0.7235


For 8: Test ACC=[0.3988233506679535, 0.7235046029090881]
Confusion Matrix
[[7400 3833]
 [  96 2881]]
Classification Report
              precision    recall  f1-score   support

           0       0.99      0.66      0.79     11233
           1       0.43      0.97      0.59      2977

    accuracy                           0.72     14210
   macro avg       0.71      0.81      0.69     14210
weighted avg       0.87      0.72      0.75     14210

trainingshape 9
(21930, 7)
(21930, 7, 1)
testingshape 9
(5484, 7)
(5484, 7, 1)
nb occurences
Counter({0: 17133, 1: 4797})
weights={0: 1.2799859919453687, 1: 4.571607254534084}
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_8 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_9 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_4 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
172/172 [==============================] - 1s 6ms/step - loss: 1.2542 - accuracy: 0.7560
Epoch 2/40
172/172 [==============================] - 1s 6ms/step - loss: 0.8553 - accuracy: 0.8227
Epoch 3/40
172/172 [==============================] - 1s 6ms/step - loss: 0.8120 - accuracy: 0.8323
Epoch 4/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7897 - accuracy: 0.8400
Epoch 5/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7685 - accuracy: 0.8492
Epoch 6/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7487 - accuracy: 0.8576
Epoch 7/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7349 - accuracy: 0.8620
Epoch 8/40
172/172 [==============================] - 1s 7ms/step - loss: 0.7230 - accuracy: 0.8665
Epoch 9/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7191 - accuracy: 0.8685
Epoch 10/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7155 - accuracy: 0.8686
Epoch 11/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7113 - accuracy: 0.8708
Epoch 12/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7111 - accuracy: 0.8694
Epoch 13/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7062 - accuracy: 0.8715
Epoch 14/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7052 - accuracy: 0.8720
Epoch 15/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7040 - accuracy: 0.8711
Epoch 16/40
172/172 [==============================] - 1s 6ms/step - loss: 0.7010 - accuracy: 0.8727
Epoch 17/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6992 - accuracy: 0.8732
Epoch 18/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6971 - accuracy: 0.8750
Epoch 19/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6965 - accuracy: 0.8735
Epoch 20/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6938 - accuracy: 0.8752
Epoch 21/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6959 - accuracy: 0.8744
Epoch 22/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6921 - accuracy: 0.8751
Epoch 23/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6909 - accuracy: 0.8742
Epoch 24/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6898 - accuracy: 0.8756
Epoch 25/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6871 - accuracy: 0.8765
Epoch 26/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6876 - accuracy: 0.8746
Epoch 27/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6843 - accuracy: 0.8760
Epoch 28/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6866 - accuracy: 0.8760
Epoch 29/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6824 - accuracy: 0.8757
Epoch 30/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6810 - accuracy: 0.8759
Epoch 31/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6802 - accuracy: 0.8755
Epoch 32/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6797 - accuracy: 0.8756
Epoch 33/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6782 - accuracy: 0.8768
Epoch 34/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6790 - accuracy: 0.8762
Epoch 35/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6768 - accuracy: 0.8772
Epoch 36/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6735 - accuracy: 0.8782
Epoch 37/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6751 - accuracy: 0.8774
Epoch 38/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6737 - accuracy: 0.8780
Epoch 39/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6725 - accuracy: 0.8793
Epoch 40/40
172/172 [==============================] - 1s 6ms/step - loss: 0.6742 - accuracy: 0.8785
43/43 [==============================] - 0s 2ms/step - loss: 0.3659 - accuracy: 0.8550


For 9: Test ACC=[0.3659490942955017, 0.8550328016281128]
Confusion Matrix
[[3681  603]
 [ 192 1008]]
Classification Report
              precision    recall  f1-score   support

           0       0.95      0.86      0.90      4284
           1       0.63      0.84      0.72      1200

    accuracy                           0.86      5484
   macro avg       0.79      0.85      0.81      5484
weighted avg       0.88      0.86      0.86      5484

trainingshape 10
(89730, 7)
(89730, 7, 1)
testingshape 10
(22434, 7)
(22434, 7, 1)
nb occurences
Counter({0: 43413, 1: 41373, 2: 4944})
weights={0: 2.0668924055006563, 1: 2.1688057428757883, 2: 18.149271844660195}
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_10 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_11 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_5 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_5 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
702/702 [==============================] - 4s 6ms/step - loss: 3.1467 - accuracy: 0.4359
Epoch 2/40
702/702 [==============================] - 4s 6ms/step - loss: 3.0198 - accuracy: 0.4719
Epoch 3/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9855 - accuracy: 0.4726
Epoch 4/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9715 - accuracy: 0.4707
Epoch 5/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9617 - accuracy: 0.4715
Epoch 6/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9555 - accuracy: 0.4731
Epoch 7/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9513 - accuracy: 0.4767
Epoch 8/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9452 - accuracy: 0.4792
Epoch 9/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9407 - accuracy: 0.4859
Epoch 10/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9344 - accuracy: 0.4851
Epoch 11/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9294 - accuracy: 0.4874
Epoch 12/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9229 - accuracy: 0.4882
Epoch 13/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9175 - accuracy: 0.4880
Epoch 14/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9119 - accuracy: 0.4908
Epoch 15/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9087 - accuracy: 0.4899
Epoch 16/40
702/702 [==============================] - 4s 6ms/step - loss: 2.9009 - accuracy: 0.4835
Epoch 17/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8959 - accuracy: 0.4839
Epoch 18/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8897 - accuracy: 0.4860
Epoch 19/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8819 - accuracy: 0.4962
Epoch 20/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8738 - accuracy: 0.5001
Epoch 21/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8689 - accuracy: 0.5041
Epoch 22/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8623 - accuracy: 0.5095
Epoch 23/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8569 - accuracy: 0.5104
Epoch 24/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8530 - accuracy: 0.5122
Epoch 25/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8489 - accuracy: 0.5166
Epoch 26/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8467 - accuracy: 0.5178
Epoch 27/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8439 - accuracy: 0.5166
Epoch 28/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8386 - accuracy: 0.5189
Epoch 29/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8418 - accuracy: 0.5144
Epoch 30/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8332 - accuracy: 0.5205
Epoch 31/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8303 - accuracy: 0.5201
Epoch 32/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8265 - accuracy: 0.5203
Epoch 33/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8249 - accuracy: 0.5215
Epoch 34/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8232 - accuracy: 0.5196
Epoch 35/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8193 - accuracy: 0.5222
Epoch 36/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8159 - accuracy: 0.5228
Epoch 37/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8137 - accuracy: 0.5239
Epoch 38/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8093 - accuracy: 0.5228
Epoch 39/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8101 - accuracy: 0.5210
Epoch 40/40
702/702 [==============================] - 4s 6ms/step - loss: 2.8050 - accuracy: 0.5241
176/176 [==============================] - 0s 2ms/step - loss: 0.9828 - accuracy: 0.5053


For 10: Test ACC=[0.9828498959541321, 0.5052598714828491]
Confusion Matrix
[[4700 4529 1625]
 [2254 5971 2119]
 [ 201  371  664]]
Classification Report
              precision    recall  f1-score   support

           0       0.66      0.43      0.52     10854
           1       0.55      0.58      0.56     10344
           2       0.15      0.54      0.24      1236

    accuracy                           0.51     22434
   macro avg       0.45      0.52      0.44     22434
weighted avg       0.58      0.51      0.53     22434

trainingshape 11
(22051, 7)
(22051, 7, 1)
testingshape 11
(5514, 7)
(5514, 7, 1)
nb occurences
Counter({1: 11258, 0: 8959, 2: 1834})
weights={0: 2.4613238084607656, 1: 1.9586960383727126, 2: 12.023446019629226}
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_12 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_13 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_6 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
173/173 [==============================] - 1s 7ms/step - loss: 3.3082 - accuracy: 0.3673
Epoch 2/40
173/173 [==============================] - 1s 6ms/step - loss: 3.2074 - accuracy: 0.4138
Epoch 3/40
173/173 [==============================] - 1s 6ms/step - loss: 3.1294 - accuracy: 0.4291
Epoch 4/40
173/173 [==============================] - 1s 6ms/step - loss: 3.0823 - accuracy: 0.4387
Epoch 5/40
173/173 [==============================] - 1s 6ms/step - loss: 3.0643 - accuracy: 0.4352
Epoch 6/40
173/173 [==============================] - 1s 6ms/step - loss: 3.0484 - accuracy: 0.4402
Epoch 7/40
173/173 [==============================] - 1s 5ms/step - loss: 3.0338 - accuracy: 0.4409
Epoch 8/40
173/173 [==============================] - 1s 6ms/step - loss: 3.0197 - accuracy: 0.4515
Epoch 9/40
173/173 [==============================] - 1s 6ms/step - loss: 3.0099 - accuracy: 0.4454
Epoch 10/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9961 - accuracy: 0.4541
Epoch 11/40
173/173 [==============================] - 1s 7ms/step - loss: 2.9827 - accuracy: 0.4539
Epoch 12/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9762 - accuracy: 0.4613
Epoch 13/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9636 - accuracy: 0.4675
Epoch 14/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9517 - accuracy: 0.4651
Epoch 15/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9374 - accuracy: 0.4738
Epoch 16/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9302 - accuracy: 0.4789
Epoch 17/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9182 - accuracy: 0.4803
Epoch 18/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9118 - accuracy: 0.4795
Epoch 19/40
173/173 [==============================] - 1s 6ms/step - loss: 2.9016 - accuracy: 0.4935
Epoch 20/40
173/173 [==============================] - 1s 6ms/step - loss: 2.8870 - accuracy: 0.5054
Epoch 21/40
173/173 [==============================] - 1s 6ms/step - loss: 2.8759 - accuracy: 0.5179
Epoch 22/40
173/173 [==============================] - 1s 6ms/step - loss: 2.8595 - accuracy: 0.5395
Epoch 23/40
173/173 [==============================] - 1s 6ms/step - loss: 2.8312 - accuracy: 0.5466
Epoch 24/40
173/173 [==============================] - 1s 5ms/step - loss: 2.8017 - accuracy: 0.5673
Epoch 25/40
173/173 [==============================] - 1s 5ms/step - loss: 2.7845 - accuracy: 0.5771
Epoch 26/40
173/173 [==============================] - 1s 6ms/step - loss: 2.7530 - accuracy: 0.5767
Epoch 27/40
173/173 [==============================] - 1s 6ms/step - loss: 2.7337 - accuracy: 0.5867
Epoch 28/40
173/173 [==============================] - 1s 6ms/step - loss: 2.7217 - accuracy: 0.5876
Epoch 29/40
173/173 [==============================] - 1s 6ms/step - loss: 2.7081 - accuracy: 0.5915
Epoch 30/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6892 - accuracy: 0.5926
Epoch 31/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6783 - accuracy: 0.5983
Epoch 32/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6656 - accuracy: 0.5997
Epoch 33/40
173/173 [==============================] - 1s 5ms/step - loss: 2.6557 - accuracy: 0.6028
Epoch 34/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6458 - accuracy: 0.6055
Epoch 35/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6369 - accuracy: 0.6090
Epoch 36/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6166 - accuracy: 0.6134
Epoch 37/40
173/173 [==============================] - 1s 5ms/step - loss: 2.6073 - accuracy: 0.6155
Epoch 38/40
173/173 [==============================] - 1s 6ms/step - loss: 2.6003 - accuracy: 0.6161
Epoch 39/40
173/173 [==============================] - 1s 5ms/step - loss: 2.5900 - accuracy: 0.6212
Epoch 40/40
173/173 [==============================] - 1s 6ms/step - loss: 2.5780 - accuracy: 0.6236
44/44 [==============================] - 0s 2ms/step - loss: 0.8864 - accuracy: 0.6137


For 11: Test ACC=[0.8864433765411377, 0.6137105822563171]
Confusion Matrix
[[1343  531  366]
 [ 472 1737  606]
 [  53  102  304]]
Classification Report
              precision    recall  f1-score   support

           0       0.72      0.60      0.65      2240
           1       0.73      0.62      0.67      2815
           2       0.24      0.66      0.35       459

    accuracy                           0.61      5514
   macro avg       0.56      0.63      0.56      5514
weighted avg       0.69      0.61      0.64      5514

trainingshape 12
(83854, 7)
(83854, 7, 1)
testingshape 12
(20965, 7)
(20965, 7, 1)
nb occurences
Counter({0: 47352, 1: 32371, 2: 4131})
weights={0: 1.7708650109815849, 1: 2.590404992122579, 2: 20.298717017671265}
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_14 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_15 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_7 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_7 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
656/656 [==============================] - 4s 6ms/step - loss: 3.2091 - accuracy: 0.3952
Epoch 2/40
656/656 [==============================] - 4s 6ms/step - loss: 2.8600 - accuracy: 0.4658
Epoch 3/40
656/656 [==============================] - 4s 6ms/step - loss: 2.7620 - accuracy: 0.5106
Epoch 4/40
656/656 [==============================] - 4s 6ms/step - loss: 2.6950 - accuracy: 0.5448
Epoch 5/40
656/656 [==============================] - 4s 6ms/step - loss: 2.6225 - accuracy: 0.5810
Epoch 6/40
656/656 [==============================] - 4s 6ms/step - loss: 2.5587 - accuracy: 0.6098
Epoch 7/40
656/656 [==============================] - 4s 6ms/step - loss: 2.4930 - accuracy: 0.6325
Epoch 8/40
656/656 [==============================] - 4s 6ms/step - loss: 2.4550 - accuracy: 0.6449
Epoch 9/40
656/656 [==============================] - 4s 6ms/step - loss: 2.4197 - accuracy: 0.6555
Epoch 10/40
656/656 [==============================] - 4s 6ms/step - loss: 2.4038 - accuracy: 0.6576
Epoch 11/40
656/656 [==============================] - 4s 6ms/step - loss: 2.3649 - accuracy: 0.6696
Epoch 12/40
656/656 [==============================] - 4s 6ms/step - loss: 2.3311 - accuracy: 0.6789
Epoch 13/40
656/656 [==============================] - 4s 6ms/step - loss: 2.3077 - accuracy: 0.6836
Epoch 14/40
656/656 [==============================] - 4s 6ms/step - loss: 2.2821 - accuracy: 0.6879
Epoch 15/40
656/656 [==============================] - 4s 6ms/step - loss: 2.2636 - accuracy: 0.6904
Epoch 16/40
656/656 [==============================] - 4s 6ms/step - loss: 2.2400 - accuracy: 0.6950
Epoch 17/40
656/656 [==============================] - 4s 6ms/step - loss: 2.2269 - accuracy: 0.6943
Epoch 18/40
656/656 [==============================] - 4s 6ms/step - loss: 2.2061 - accuracy: 0.6981
Epoch 19/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1856 - accuracy: 0.6987
Epoch 20/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1786 - accuracy: 0.6999
Epoch 21/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1646 - accuracy: 0.7002
Epoch 22/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1588 - accuracy: 0.6987
Epoch 23/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1420 - accuracy: 0.7012
Epoch 24/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1362 - accuracy: 0.7021
Epoch 25/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1242 - accuracy: 0.7044
Epoch 26/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1170 - accuracy: 0.7037
Epoch 27/40
656/656 [==============================] - 4s 6ms/step - loss: 2.1024 - accuracy: 0.7074
Epoch 28/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0944 - accuracy: 0.7103
Epoch 29/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0789 - accuracy: 0.7112
Epoch 30/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0720 - accuracy: 0.7135
Epoch 31/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0739 - accuracy: 0.7132
Epoch 32/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0534 - accuracy: 0.7175
Epoch 33/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0391 - accuracy: 0.7195
Epoch 34/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0504 - accuracy: 0.7177
Epoch 35/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0272 - accuracy: 0.7196
Epoch 36/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0297 - accuracy: 0.7207
Epoch 37/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0172 - accuracy: 0.7234
Epoch 38/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0215 - accuracy: 0.7221
Epoch 39/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0052 - accuracy: 0.7249
Epoch 40/40
656/656 [==============================] - 4s 6ms/step - loss: 2.0064 - accuracy: 0.7254
164/164 [==============================] - 0s 2ms/step - loss: 0.7501 - accuracy: 0.7002


For 12: Test ACC=[0.7500782012939453, 0.7001669406890869]
Confusion Matrix
[[8316 1528 1995]
 [ 908 5551 1634]
 [  77  144  812]]
Classification Report
              precision    recall  f1-score   support

           0       0.89      0.70      0.79     11839
           1       0.77      0.69      0.72      8093
           2       0.18      0.79      0.30      1033

    accuracy                           0.70     20965
   macro avg       0.62      0.72      0.60     20965
weighted avg       0.81      0.70      0.74     20965

trainingshape 13
(34177, 7)
(34177, 7, 1)
testingshape 13
(8546, 7)
(8546, 7, 1)
nb occurences
Counter({0: 23961, 1: 8910, 2: 1306})
weights={0: 1.426359500855557, 1: 3.8358024691358024, 2: 26.169218989280246}
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_16 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_17 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_8 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
268/268 [==============================] - 2s 6ms/step - loss: 3.1999 - accuracy: 0.3561
Epoch 2/40
268/268 [==============================] - 2s 6ms/step - loss: 2.9880 - accuracy: 0.3678
Epoch 3/40
268/268 [==============================] - 2s 6ms/step - loss: 2.9012 - accuracy: 0.4054
Epoch 4/40
268/268 [==============================] - 2s 6ms/step - loss: 2.8587 - accuracy: 0.4577
Epoch 5/40
268/268 [==============================] - 2s 6ms/step - loss: 2.8361 - accuracy: 0.5190
Epoch 6/40
268/268 [==============================] - 2s 6ms/step - loss: 2.8102 - accuracy: 0.5713
Epoch 7/40
268/268 [==============================] - 2s 6ms/step - loss: 2.7848 - accuracy: 0.5842
Epoch 8/40
268/268 [==============================] - 2s 6ms/step - loss: 2.7702 - accuracy: 0.5472
Epoch 9/40
268/268 [==============================] - 2s 6ms/step - loss: 2.7393 - accuracy: 0.5620
Epoch 10/40
268/268 [==============================] - 2s 6ms/step - loss: 2.7119 - accuracy: 0.5920
Epoch 11/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6947 - accuracy: 0.5851
Epoch 12/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6763 - accuracy: 0.5432
Epoch 13/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6807 - accuracy: 0.4700
Epoch 14/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6502 - accuracy: 0.5765
Epoch 15/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6383 - accuracy: 0.5866
Epoch 16/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6222 - accuracy: 0.5500
Epoch 17/40
268/268 [==============================] - 2s 6ms/step - loss: 2.6119 - accuracy: 0.5956
Epoch 18/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5978 - accuracy: 0.5790
Epoch 19/40
268/268 [==============================] - 2s 7ms/step - loss: 2.5843 - accuracy: 0.5721
Epoch 20/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5690 - accuracy: 0.6149
Epoch 21/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5596 - accuracy: 0.5707
Epoch 22/40
268/268 [==============================] - 1s 6ms/step - loss: 2.5451 - accuracy: 0.5858
Epoch 23/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5429 - accuracy: 0.6075
Epoch 24/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5283 - accuracy: 0.6066
Epoch 25/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5160 - accuracy: 0.5833
Epoch 26/40
268/268 [==============================] - 2s 6ms/step - loss: 2.5038 - accuracy: 0.6522
Epoch 27/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4957 - accuracy: 0.5831
Epoch 28/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4826 - accuracy: 0.6345
Epoch 29/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4745 - accuracy: 0.5989
Epoch 30/40
268/268 [==============================] - 1s 6ms/step - loss: 2.4699 - accuracy: 0.6636
Epoch 31/40
268/268 [==============================] - 1s 6ms/step - loss: 2.4594 - accuracy: 0.6665
Epoch 32/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4517 - accuracy: 0.6203
Epoch 33/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4433 - accuracy: 0.6665
Epoch 34/40
268/268 [==============================] - 2s 6ms/step - loss: 2.4386 - accuracy: 0.6512
Epoch 35/40
268/268 [==============================] - 2s 7ms/step - loss: 2.4286 - accuracy: 0.6316
Epoch 36/40
268/268 [==============================] - 1s 5ms/step - loss: 2.4297 - accuracy: 0.6387
Epoch 37/40
268/268 [==============================] - 1s 5ms/step - loss: 2.4173 - accuracy: 0.6955
Epoch 38/40
268/268 [==============================] - 1s 5ms/step - loss: 2.4118 - accuracy: 0.6920
Epoch 39/40
268/268 [==============================] - 2s 6ms/step - loss: 2.3990 - accuracy: 0.7080
Epoch 40/40
268/268 [==============================] - 1s 5ms/step - loss: 2.3897 - accuracy: 0.6652
67/67 [==============================] - 0s 2ms/step - loss: 0.7564 - accuracy: 0.8165


For 13: Test ACC=[0.7564226984977722, 0.8165223598480225]
Confusion Matrix
[[5219  506  266]
 [ 476 1652  100]
 [ 170   50  107]]
Classification Report
              precision    recall  f1-score   support

           0       0.89      0.87      0.88      5991
           1       0.75      0.74      0.74      2228
           2       0.23      0.33      0.27       327

    accuracy                           0.82      8546
   macro avg       0.62      0.65      0.63      8546
weighted avg       0.83      0.82      0.82      8546

trainingshape 14
(38497, 7)
(38497, 7, 1)
testingshape 14
(9626, 7)
(9626, 7, 1)
nb occurences
Counter({0: 25740, 1: 11588, 2: 1169})
weights={0: 1.4956099456099456, 1: 3.3221435968243007, 2: 32.93156544054747}
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_18 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_19 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_9 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_9 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
301/301 [==============================] - 2s 6ms/step - loss: 3.0999 - accuracy: 0.4834
Epoch 2/40
301/301 [==============================] - 2s 6ms/step - loss: 2.8506 - accuracy: 0.3869
Epoch 3/40
301/301 [==============================] - 2s 6ms/step - loss: 2.8183 - accuracy: 0.4007
Epoch 4/40
301/301 [==============================] - 2s 6ms/step - loss: 2.8033 - accuracy: 0.4117
Epoch 5/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7925 - accuracy: 0.4255
Epoch 6/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7839 - accuracy: 0.4370
Epoch 7/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7712 - accuracy: 0.4483
Epoch 8/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7625 - accuracy: 0.4742
Epoch 9/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7516 - accuracy: 0.4814
Epoch 10/40
301/301 [==============================] - 2s 7ms/step - loss: 2.7384 - accuracy: 0.5094
Epoch 11/40
301/301 [==============================] - 2s 7ms/step - loss: 2.7243 - accuracy: 0.5131
Epoch 12/40
301/301 [==============================] - 2s 6ms/step - loss: 2.7099 - accuracy: 0.5379
Epoch 13/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6906 - accuracy: 0.5486
Epoch 14/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6759 - accuracy: 0.5543
Epoch 15/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6711 - accuracy: 0.5598
Epoch 16/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6481 - accuracy: 0.5718
Epoch 17/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6387 - accuracy: 0.5752
Epoch 18/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6211 - accuracy: 0.5809
Epoch 19/40
301/301 [==============================] - 2s 6ms/step - loss: 2.6098 - accuracy: 0.5867
Epoch 20/40
301/301 [==============================] - 2s 6ms/step - loss: 2.5914 - accuracy: 0.5884
Epoch 21/40
301/301 [==============================] - 2s 6ms/step - loss: 2.5771 - accuracy: 0.5929
Epoch 22/40
301/301 [==============================] - 2s 6ms/step - loss: 2.5606 - accuracy: 0.6041
Epoch 23/40
301/301 [==============================] - 2s 6ms/step - loss: 2.5314 - accuracy: 0.6099
Epoch 24/40
301/301 [==============================] - 2s 6ms/step - loss: 2.5167 - accuracy: 0.6137
Epoch 25/40
301/301 [==============================] - 2s 6ms/step - loss: 2.4946 - accuracy: 0.6192
Epoch 26/40
301/301 [==============================] - 2s 6ms/step - loss: 2.4902 - accuracy: 0.6230
Epoch 27/40
301/301 [==============================] - 2s 6ms/step - loss: 2.4591 - accuracy: 0.6326
Epoch 28/40
301/301 [==============================] - 2s 6ms/step - loss: 2.4361 - accuracy: 0.6316
Epoch 29/40
301/301 [==============================] - 2s 6ms/step - loss: 2.4241 - accuracy: 0.6384
Epoch 30/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3979 - accuracy: 0.6464
Epoch 31/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3783 - accuracy: 0.6502
Epoch 32/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3632 - accuracy: 0.6495
Epoch 33/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3350 - accuracy: 0.6568
Epoch 34/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3178 - accuracy: 0.6604
Epoch 35/40
301/301 [==============================] - 2s 6ms/step - loss: 2.3074 - accuracy: 0.6586
Epoch 36/40
301/301 [==============================] - 2s 6ms/step - loss: 2.2920 - accuracy: 0.6649
Epoch 37/40
301/301 [==============================] - 2s 6ms/step - loss: 2.2710 - accuracy: 0.6637
Epoch 38/40
301/301 [==============================] - 2s 6ms/step - loss: 2.2764 - accuracy: 0.6626
Epoch 39/40
301/301 [==============================] - 2s 6ms/step - loss: 2.2462 - accuracy: 0.6660
Epoch 40/40
301/301 [==============================] - 2s 6ms/step - loss: 2.2359 - accuracy: 0.6697
76/76 [==============================] - 0s 2ms/step - loss: 0.8149 - accuracy: 0.6333


For 14: Test ACC=[0.8148834109306335, 0.633284866809845]
Confusion Matrix
[[3683 1527 1225]
 [ 309 2207  382]
 [  32   55  206]]
Classification Report
              precision    recall  f1-score   support

           0       0.92      0.57      0.70      6435
           1       0.58      0.76      0.66      2898
           2       0.11      0.70      0.20       293

    accuracy                           0.63      9626
   macro avg       0.54      0.68      0.52      9626
weighted avg       0.79      0.63      0.68      9626

trainingshape 15
(85353, 7)
(85353, 7, 1)
testingshape 15
(21341, 7)
(21341, 7, 1)
nb occurences
Counter({0: 42768, 1: 32909, 2: 8120, 3: 1556})
weights={0: 1.9957210998877664, 1: 2.593606612172962, 2: 10.511453201970443, 3: 54.85411311053984}
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_20 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_21 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_10 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_10 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
667/667 [==============================] - 4s 6ms/step - loss: 5.0025 - accuracy: 0.2890
Epoch 2/40
667/667 [==============================] - 4s 6ms/step - loss: 4.6108 - accuracy: 0.4510
Epoch 3/40
667/667 [==============================] - 4s 6ms/step - loss: 4.5274 - accuracy: 0.4736
Epoch 4/40
667/667 [==============================] - 4s 6ms/step - loss: 4.4720 - accuracy: 0.4735
Epoch 5/40
667/667 [==============================] - 4s 6ms/step - loss: 4.4148 - accuracy: 0.4780
Epoch 6/40
667/667 [==============================] - 4s 6ms/step - loss: 4.3725 - accuracy: 0.4936
Epoch 7/40
667/667 [==============================] - 4s 6ms/step - loss: 4.3132 - accuracy: 0.5191
Epoch 8/40
667/667 [==============================] - 4s 6ms/step - loss: 4.2576 - accuracy: 0.5456
Epoch 9/40
667/667 [==============================] - 4s 6ms/step - loss: 4.2224 - accuracy: 0.5561
Epoch 10/40
667/667 [==============================] - 4s 6ms/step - loss: 4.1764 - accuracy: 0.5621
Epoch 11/40
667/667 [==============================] - 4s 6ms/step - loss: 4.1306 - accuracy: 0.5726
Epoch 12/40
667/667 [==============================] - 4s 6ms/step - loss: 4.0956 - accuracy: 0.5785
Epoch 13/40
667/667 [==============================] - 4s 6ms/step - loss: 4.0583 - accuracy: 0.5827
Epoch 14/40
667/667 [==============================] - 4s 6ms/step - loss: 4.0177 - accuracy: 0.5870
Epoch 15/40
667/667 [==============================] - 4s 6ms/step - loss: 3.9716 - accuracy: 0.5946
Epoch 16/40
667/667 [==============================] - 4s 6ms/step - loss: 3.9479 - accuracy: 0.5949
Epoch 17/40
667/667 [==============================] - 4s 6ms/step - loss: 3.9271 - accuracy: 0.6007
Epoch 18/40
667/667 [==============================] - 4s 6ms/step - loss: 3.8952 - accuracy: 0.6051
Epoch 19/40
667/667 [==============================] - 4s 6ms/step - loss: 3.8718 - accuracy: 0.6093
Epoch 20/40
667/667 [==============================] - 4s 6ms/step - loss: 3.8460 - accuracy: 0.6110
Epoch 21/40
667/667 [==============================] - 4s 6ms/step - loss: 3.8258 - accuracy: 0.6165
Epoch 22/40
667/667 [==============================] - 4s 6ms/step - loss: 3.8028 - accuracy: 0.6222
Epoch 23/40
667/667 [==============================] - 4s 6ms/step - loss: 3.7879 - accuracy: 0.6243
Epoch 24/40
667/667 [==============================] - 4s 6ms/step - loss: 3.7707 - accuracy: 0.6322
Epoch 25/40
667/667 [==============================] - 4s 6ms/step - loss: 3.7469 - accuracy: 0.6345
Epoch 26/40
667/667 [==============================] - 4s 6ms/step - loss: 3.7400 - accuracy: 0.6377
Epoch 27/40
667/667 [==============================] - 4s 6ms/step - loss: 3.7142 - accuracy: 0.6425
Epoch 28/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6900 - accuracy: 0.6452
Epoch 29/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6830 - accuracy: 0.6489
Epoch 30/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6647 - accuracy: 0.6531
Epoch 31/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6504 - accuracy: 0.6527
Epoch 32/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6257 - accuracy: 0.6576
Epoch 33/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6133 - accuracy: 0.6573
Epoch 34/40
667/667 [==============================] - 4s 6ms/step - loss: 3.6057 - accuracy: 0.6601
Epoch 35/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5901 - accuracy: 0.6611
Epoch 36/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5790 - accuracy: 0.6623
Epoch 37/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5635 - accuracy: 0.6639
Epoch 38/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5596 - accuracy: 0.6644
Epoch 39/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5519 - accuracy: 0.6649
Epoch 40/40
667/667 [==============================] - 4s 6ms/step - loss: 3.5415 - accuracy: 0.6675
167/167 [==============================] - 0s 2ms/step - loss: 0.9266 - accuracy: 0.6410


For 15: Test ACC=[0.9265714287757874, 0.6410196423530579]
Confusion Matrix
[[7501 1115 1652  425]
 [ 850 4492 1671 1215]
 [ 129  298 1490  113]
 [  19  119   55  197]]
Classification Report
              precision    recall  f1-score   support

           0       0.88      0.70      0.78     10693
           1       0.75      0.55      0.63      8228
           2       0.31      0.73      0.43      2030
           3       0.10      0.51      0.17       390

    accuracy                           0.64     21341
   macro avg       0.51      0.62      0.50     21341
weighted avg       0.76      0.64      0.68     21341

trainingshape 16
(23927, 7)
(23927, 7, 1)
testingshape 16
(5984, 7)
(5984, 7, 1)
nb occurences
Counter({1: 11101, 0: 9954, 2: 2453, 3: 419})
weights={0: 2.403757283504119, 1: 2.155391406179623, 2: 9.75417855686914, 3: 57.105011933174225}
Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_22 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_23 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_11 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_11 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
187/187 [==============================] - 1s 6ms/step - loss: 5.5540 - accuracy: 0.2498
Epoch 2/40
187/187 [==============================] - 1s 6ms/step - loss: 5.4363 - accuracy: 0.3596
Epoch 3/40
187/187 [==============================] - 1s 6ms/step - loss: 5.3509 - accuracy: 0.3706
Epoch 4/40
187/187 [==============================] - 1s 6ms/step - loss: 5.3055 - accuracy: 0.4011
Epoch 5/40
187/187 [==============================] - 1s 6ms/step - loss: 5.2845 - accuracy: 0.3918
Epoch 6/40
187/187 [==============================] - 1s 6ms/step - loss: 5.2608 - accuracy: 0.3917
Epoch 7/40
187/187 [==============================] - 1s 6ms/step - loss: 5.2436 - accuracy: 0.3879
Epoch 8/40
187/187 [==============================] - 1s 6ms/step - loss: 5.2304 - accuracy: 0.4029
Epoch 9/40
187/187 [==============================] - 1s 6ms/step - loss: 5.2109 - accuracy: 0.3898
Epoch 10/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1862 - accuracy: 0.3968
Epoch 11/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1716 - accuracy: 0.3863
Epoch 12/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1527 - accuracy: 0.3993
Epoch 13/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1327 - accuracy: 0.4021
Epoch 14/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1301 - accuracy: 0.3960
Epoch 15/40
187/187 [==============================] - 1s 6ms/step - loss: 5.1086 - accuracy: 0.3981
Epoch 16/40
187/187 [==============================] - 1s 6ms/step - loss: 5.0940 - accuracy: 0.3984
Epoch 17/40
187/187 [==============================] - 1s 7ms/step - loss: 5.0826 - accuracy: 0.3930
Epoch 18/40
187/187 [==============================] - 1s 6ms/step - loss: 5.0623 - accuracy: 0.4092
Epoch 19/40
187/187 [==============================] - 1s 6ms/step - loss: 5.0525 - accuracy: 0.4029
Epoch 20/40
187/187 [==============================] - 1s 6ms/step - loss: 5.0346 - accuracy: 0.4007
Epoch 21/40
187/187 [==============================] - 1s 6ms/step - loss: 5.0093 - accuracy: 0.4059
Epoch 22/40
187/187 [==============================] - 1s 7ms/step - loss: 4.9984 - accuracy: 0.4067
Epoch 23/40
187/187 [==============================] - 1s 6ms/step - loss: 4.9836 - accuracy: 0.4142
Epoch 24/40
187/187 [==============================] - 1s 6ms/step - loss: 4.9632 - accuracy: 0.4003
Epoch 25/40
187/187 [==============================] - 1s 6ms/step - loss: 4.9395 - accuracy: 0.4043
Epoch 26/40
187/187 [==============================] - 1s 6ms/step - loss: 4.9361 - accuracy: 0.4115
Epoch 27/40
187/187 [==============================] - 1s 6ms/step - loss: 4.9115 - accuracy: 0.4089
Epoch 28/40
187/187 [==============================] - 1s 6ms/step - loss: 4.8836 - accuracy: 0.4110
Epoch 29/40
187/187 [==============================] - 1s 6ms/step - loss: 4.8887 - accuracy: 0.4113
Epoch 30/40
187/187 [==============================] - 1s 6ms/step - loss: 4.8598 - accuracy: 0.4118
Epoch 31/40
187/187 [==============================] - 1s 6ms/step - loss: 4.8455 - accuracy: 0.4121
Epoch 32/40
187/187 [==============================] - 1s 6ms/step - loss: 4.8134 - accuracy: 0.4112
Epoch 33/40
187/187 [==============================] - 1s 6ms/step - loss: 4.7931 - accuracy: 0.4178
Epoch 34/40
187/187 [==============================] - 1s 6ms/step - loss: 4.7824 - accuracy: 0.4184
Epoch 35/40
187/187 [==============================] - 1s 6ms/step - loss: 4.7567 - accuracy: 0.4239
Epoch 36/40
187/187 [==============================] - 1s 6ms/step - loss: 4.7414 - accuracy: 0.4165
Epoch 37/40
187/187 [==============================] - 1s 6ms/step - loss: 4.7174 - accuracy: 0.4210
Epoch 38/40
187/187 [==============================] - 1s 6ms/step - loss: 4.6936 - accuracy: 0.4258
Epoch 39/40
187/187 [==============================] - 1s 6ms/step - loss: 4.6780 - accuracy: 0.4258
Epoch 40/40
187/187 [==============================] - 1s 6ms/step - loss: 4.6648 - accuracy: 0.4266
47/47 [==============================] - 0s 2ms/step - loss: 1.2290 - accuracy: 0.4343


For 16: Test ACC=[1.2289528846740723, 0.43432486057281494]
Confusion Matrix
[[1190  491  474  334]
 [ 598 1100  787  291]
 [ 130  116  250  118]
 [   9   19   18   59]]
Classification Report
              precision    recall  f1-score   support

           0       0.62      0.48      0.54      2489
           1       0.64      0.40      0.49      2776
           2       0.16      0.41      0.23       614
           3       0.07      0.56      0.13       105

    accuracy                           0.43      5984
   macro avg       0.37      0.46      0.35      5984
weighted avg       0.57      0.43      0.48      5984

trainingshape 17
(84061, 7)
(84061, 7, 1)
testingshape 17
(21017, 7)
(21017, 7, 1)
nb occurences
Counter({0: 48159, 1: 29846, 2: 5446, 3: 610})
weights={0: 1.7454889013476194, 1: 2.8164913221202172, 2: 15.435365405802424, 3: 137.80491803278687}
Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_24 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_25 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_12 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_12 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
657/657 [==============================] - 4s 6ms/step - loss: 5.3062 - accuracy: 0.1277
Epoch 2/40
657/657 [==============================] - 4s 6ms/step - loss: 5.0996 - accuracy: 0.2007
Epoch 3/40
657/657 [==============================] - 4s 6ms/step - loss: 4.9765 - accuracy: 0.2522
Epoch 4/40
657/657 [==============================] - 4s 6ms/step - loss: 4.8698 - accuracy: 0.2795
Epoch 5/40
657/657 [==============================] - 4s 6ms/step - loss: 4.7732 - accuracy: 0.3113
Epoch 6/40
657/657 [==============================] - 4s 6ms/step - loss: 4.6801 - accuracy: 0.3400
Epoch 7/40
657/657 [==============================] - 4s 6ms/step - loss: 4.5921 - accuracy: 0.3534
Epoch 8/40
657/657 [==============================] - 4s 6ms/step - loss: 4.5464 - accuracy: 0.3747
Epoch 9/40
657/657 [==============================] - 4s 6ms/step - loss: 4.5051 - accuracy: 0.3719
Epoch 10/40
657/657 [==============================] - 4s 6ms/step - loss: 4.4748 - accuracy: 0.4050
Epoch 11/40
657/657 [==============================] - 4s 6ms/step - loss: 4.4569 - accuracy: 0.4135
Epoch 12/40
657/657 [==============================] - 4s 6ms/step - loss: 4.4250 - accuracy: 0.4154
Epoch 13/40
657/657 [==============================] - 4s 6ms/step - loss: 4.4082 - accuracy: 0.4378
Epoch 14/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3878 - accuracy: 0.4339
Epoch 15/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3696 - accuracy: 0.4414
Epoch 16/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3514 - accuracy: 0.4176
Epoch 17/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3502 - accuracy: 0.4460
Epoch 18/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3323 - accuracy: 0.4452
Epoch 19/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3094 - accuracy: 0.4428
Epoch 20/40
657/657 [==============================] - 4s 6ms/step - loss: 4.3066 - accuracy: 0.4324
Epoch 21/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2971 - accuracy: 0.4574
Epoch 22/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2951 - accuracy: 0.4583
Epoch 23/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2773 - accuracy: 0.4440
Epoch 24/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2677 - accuracy: 0.4455
Epoch 25/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2519 - accuracy: 0.4723
Epoch 26/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2451 - accuracy: 0.4615
Epoch 27/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2403 - accuracy: 0.4492
Epoch 28/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2317 - accuracy: 0.4669
Epoch 29/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2273 - accuracy: 0.4639
Epoch 30/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2120 - accuracy: 0.4730
Epoch 31/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2146 - accuracy: 0.4676
Epoch 32/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2118 - accuracy: 0.4601
Epoch 33/40
657/657 [==============================] - 4s 6ms/step - loss: 4.2007 - accuracy: 0.4856
Epoch 34/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1878 - accuracy: 0.4812
Epoch 35/40
657/657 [==============================] - 5s 7ms/step - loss: 4.1820 - accuracy: 0.4927
Epoch 36/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1853 - accuracy: 0.4797
Epoch 37/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1731 - accuracy: 0.4757
Epoch 38/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1600 - accuracy: 0.4701
Epoch 39/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1524 - accuracy: 0.4916
Epoch 40/40
657/657 [==============================] - 4s 6ms/step - loss: 4.1480 - accuracy: 0.4892
165/165 [==============================] - 0s 2ms/step - loss: 1.0990 - accuracy: 0.3989


For 17: Test ACC=[1.0989990234375, 0.39886757731437683]
Confusion Matrix
[[4814 1335 5669  222]
 [ 845 2585 3730  302]
 [ 169  225  879   89]
 [   7    9   32  105]]
Classification Report
              precision    recall  f1-score   support

           0       0.83      0.40      0.54     12040
           1       0.62      0.35      0.45      7462
           2       0.09      0.65      0.15      1362
           3       0.15      0.69      0.24       153

    accuracy                           0.40     21017
   macro avg       0.42      0.52      0.34     21017
weighted avg       0.70      0.40      0.48     21017

trainingshape 18
(25957, 7)
(25957, 7, 1)
testingshape 18
(6490, 7)
(6490, 7, 1)
nb occurences
Counter({0: 15976, 1: 7923, 2: 1476, 3: 582})
weights={0: 1.6247496244366548, 1: 3.27615802095166, 2: 17.586043360433603, 3: 44.59965635738831}
Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_26 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_27 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_13 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_13 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
203/203 [==============================] - 1s 6ms/step - loss: 5.4457 - accuracy: 0.2231
Epoch 2/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0214 - accuracy: 0.1869
Epoch 3/40
203/203 [==============================] - 1s 6ms/step - loss: 4.7531 - accuracy: 0.2690
Epoch 4/40
203/203 [==============================] - 1s 6ms/step - loss: 4.5430 - accuracy: 0.2854
Epoch 5/40
203/203 [==============================] - 1s 6ms/step - loss: 4.4425 - accuracy: 0.3877
Epoch 6/40
203/203 [==============================] - 1s 6ms/step - loss: 4.4061 - accuracy: 0.3977
Epoch 7/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3852 - accuracy: 0.3975
Epoch 8/40
203/203 [==============================] - 1s 5ms/step - loss: 4.3710 - accuracy: 0.4535
Epoch 9/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3657 - accuracy: 0.4439
Epoch 10/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3450 - accuracy: 0.4446
Epoch 11/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3279 - accuracy: 0.4634
Epoch 12/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3140 - accuracy: 0.4378
Epoch 13/40
203/203 [==============================] - 1s 6ms/step - loss: 4.3023 - accuracy: 0.3735
Epoch 14/40
203/203 [==============================] - 1s 6ms/step - loss: 4.2851 - accuracy: 0.4289
Epoch 15/40
203/203 [==============================] - 1s 6ms/step - loss: 4.2749 - accuracy: 0.4754
Epoch 16/40
203/203 [==============================] - 1s 6ms/step - loss: 4.2489 - accuracy: 0.5210
Epoch 17/40
203/203 [==============================] - 1s 6ms/step - loss: 4.2333 - accuracy: 0.4798
Epoch 18/40
203/203 [==============================] - 1s 6ms/step - loss: 4.2052 - accuracy: 0.4846
Epoch 19/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1905 - accuracy: 0.4877
Epoch 20/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1713 - accuracy: 0.5027
Epoch 21/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1621 - accuracy: 0.4964
Epoch 22/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1435 - accuracy: 0.5017
Epoch 23/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1272 - accuracy: 0.4947
Epoch 24/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1222 - accuracy: 0.4912
Epoch 25/40
203/203 [==============================] - 1s 6ms/step - loss: 4.1136 - accuracy: 0.4959
Epoch 26/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0851 - accuracy: 0.4933
Epoch 27/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0823 - accuracy: 0.4953
Epoch 28/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0709 - accuracy: 0.4987
Epoch 29/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0592 - accuracy: 0.4980
Epoch 30/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0459 - accuracy: 0.4937
Epoch 31/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0404 - accuracy: 0.5004
Epoch 32/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0309 - accuracy: 0.5034
Epoch 33/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0267 - accuracy: 0.4995
Epoch 34/40
203/203 [==============================] - 1s 6ms/step - loss: 4.0136 - accuracy: 0.5022
Epoch 35/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9998 - accuracy: 0.5075
Epoch 36/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9904 - accuracy: 0.5053
Epoch 37/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9831 - accuracy: 0.5053
Epoch 38/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9888 - accuracy: 0.5035
Epoch 39/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9669 - accuracy: 0.5080
Epoch 40/40
203/203 [==============================] - 1s 6ms/step - loss: 3.9552 - accuracy: 0.5077
51/51 [==============================] - 0s 2ms/step - loss: 1.0762 - accuracy: 0.5048


For 18: Test ACC=[1.076214075088501, 0.5047765970230103]
Confusion Matrix
[[1835  480 1269  410]
 [ 288 1137  394  162]
 [  71   48  197   53]
 [  15    5   19  107]]
Classification Report
              precision    recall  f1-score   support

           0       0.83      0.46      0.59      3994
           1       0.68      0.57      0.62      1981
           2       0.10      0.53      0.18       369
           3       0.15      0.73      0.24       146

    accuracy                           0.50      6490
   macro avg       0.44      0.58      0.41      6490
weighted avg       0.73      0.50      0.57      6490

trainingshape 19
(87853, 7)
(87853, 7, 1)
testingshape 19
(21967, 7)
(21967, 7, 1)
nb occurences
Counter({0: 38736, 1: 26893, 2: 18609, 3: 3147, 4: 468})
weights={0: 2.2679935976869063, 1: 3.266760867140148, 2: 4.72099521736794, 3: 27.91642834445504, 4: 187.72008547008548}
Model: "sequential_14"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_28 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_29 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_14 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_14 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
687/687 [==============================] - 4s 6ms/step - loss: 7.1113 - accuracy: 0.4265
Epoch 2/40
687/687 [==============================] - 4s 6ms/step - loss: 6.6411 - accuracy: 0.4554
Epoch 3/40
687/687 [==============================] - 4s 6ms/step - loss: 6.5438 - accuracy: 0.4777
Epoch 4/40
687/687 [==============================] - 4s 6ms/step - loss: 6.4564 - accuracy: 0.4766
Epoch 5/40
687/687 [==============================] - 4s 6ms/step - loss: 6.3137 - accuracy: 0.4772
Epoch 6/40
687/687 [==============================] - 4s 6ms/step - loss: 6.0594 - accuracy: 0.4996
Epoch 7/40
687/687 [==============================] - 4s 6ms/step - loss: 5.8962 - accuracy: 0.5144
Epoch 8/40
687/687 [==============================] - 4s 6ms/step - loss: 5.7913 - accuracy: 0.5363
Epoch 9/40
687/687 [==============================] - 4s 6ms/step - loss: 5.7417 - accuracy: 0.5376
Epoch 10/40
687/687 [==============================] - 4s 6ms/step - loss: 5.7209 - accuracy: 0.5448
Epoch 11/40
687/687 [==============================] - 4s 6ms/step - loss: 5.6695 - accuracy: 0.5545
Epoch 12/40
687/687 [==============================] - 4s 6ms/step - loss: 5.6638 - accuracy: 0.5548
Epoch 13/40
687/687 [==============================] - 4s 6ms/step - loss: 5.6236 - accuracy: 0.5487
Epoch 14/40
687/687 [==============================] - 4s 6ms/step - loss: 5.6164 - accuracy: 0.5607
Epoch 15/40
687/687 [==============================] - 4s 6ms/step - loss: 5.5801 - accuracy: 0.5550
Epoch 16/40
687/687 [==============================] - 4s 6ms/step - loss: 5.5567 - accuracy: 0.5696
Epoch 17/40
687/687 [==============================] - 4s 6ms/step - loss: 5.5416 - accuracy: 0.5589
Epoch 18/40
687/687 [==============================] - 4s 6ms/step - loss: 5.5349 - accuracy: 0.5719
Epoch 19/40
687/687 [==============================] - 4s 6ms/step - loss: 5.5080 - accuracy: 0.5739
Epoch 20/40
687/687 [==============================] - 4s 6ms/step - loss: 5.4864 - accuracy: 0.5682
Epoch 21/40
687/687 [==============================] - 4s 6ms/step - loss: 5.4666 - accuracy: 0.5750
Epoch 22/40
687/687 [==============================] - 4s 6ms/step - loss: 5.4618 - accuracy: 0.5768
Epoch 23/40
687/687 [==============================] - 4s 7ms/step - loss: 5.4459 - accuracy: 0.5653
Epoch 24/40
687/687 [==============================] - 4s 6ms/step - loss: 5.4217 - accuracy: 0.5793
Epoch 25/40
687/687 [==============================] - 4s 6ms/step - loss: 5.4218 - accuracy: 0.5793
Epoch 26/40
687/687 [==============================] - 5s 7ms/step - loss: 5.3894 - accuracy: 0.5786
Epoch 27/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3661 - accuracy: 0.5816
Epoch 28/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3631 - accuracy: 0.5804
Epoch 29/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3460 - accuracy: 0.5802
Epoch 30/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3365 - accuracy: 0.5797
Epoch 31/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3335 - accuracy: 0.5805
Epoch 32/40
687/687 [==============================] - 4s 6ms/step - loss: 5.3086 - accuracy: 0.5849
Epoch 33/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2931 - accuracy: 0.5857
Epoch 34/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2736 - accuracy: 0.5839
Epoch 35/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2657 - accuracy: 0.5907
Epoch 36/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2489 - accuracy: 0.5888
Epoch 37/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2400 - accuracy: 0.5948
Epoch 38/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2310 - accuracy: 0.5898
Epoch 39/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2067 - accuracy: 0.5983
Epoch 40/40
687/687 [==============================] - 4s 6ms/step - loss: 5.2074 - accuracy: 0.6030
172/172 [==============================] - 0s 2ms/step - loss: 1.0019 - accuracy: 0.6055


For 19: Test ACC=[1.0019415616989136, 0.605453610420227]
Confusion Matrix
[[6801 1103  754  953   74]
 [ 665 3050 1472 1478   59]
 [ 239  797 3050  480   87]
 [  11  282  103  320   71]
 [   1   15    7   16   79]]
Classification Report
              precision    recall  f1-score   support

           0       0.88      0.70      0.78      9685
           1       0.58      0.45      0.51      6724
           2       0.57      0.66      0.61      4653
           3       0.10      0.41      0.16       787
           4       0.21      0.67      0.32       118

    accuracy                           0.61     21967
   macro avg       0.47      0.58      0.48     21967
weighted avg       0.69      0.61      0.64     21967

trainingshape 20
(65779, 7)
(65779, 7, 1)
testingshape 20
(16445, 7)
(16445, 7, 1)
nb occurences
Counter({0: 28160, 1: 25152, 2: 10127, 3: 2340})
weights={0: 2.3359019886363637, 1: 2.6152592239185752, 2: 6.4954083144070305, 3: 28.11068376068376}
Model: "sequential_15"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_30 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_31 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_15 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_15 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
514/514 [==============================] - 3s 6ms/step - loss: 5.5078 - accuracy: 0.2754
Epoch 2/40
514/514 [==============================] - 3s 6ms/step - loss: 5.3503 - accuracy: 0.3225
Epoch 3/40
514/514 [==============================] - 3s 6ms/step - loss: 5.2264 - accuracy: 0.3857
Epoch 4/40
514/514 [==============================] - 3s 6ms/step - loss: 5.1565 - accuracy: 0.4144
Epoch 5/40
514/514 [==============================] - 3s 6ms/step - loss: 5.1072 - accuracy: 0.3834
Epoch 6/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0738 - accuracy: 0.3720
Epoch 7/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0532 - accuracy: 0.3763
Epoch 8/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0399 - accuracy: 0.3772
Epoch 9/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0281 - accuracy: 0.3642
Epoch 10/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0179 - accuracy: 0.3556
Epoch 11/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0129 - accuracy: 0.3502
Epoch 12/40
514/514 [==============================] - 3s 6ms/step - loss: 5.0077 - accuracy: 0.3720
Epoch 13/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9952 - accuracy: 0.3668
Epoch 14/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9913 - accuracy: 0.3546
Epoch 15/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9814 - accuracy: 0.3702
Epoch 16/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9802 - accuracy: 0.3704
Epoch 17/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9717 - accuracy: 0.3644
Epoch 18/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9648 - accuracy: 0.3753
Epoch 19/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9561 - accuracy: 0.3738
Epoch 20/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9489 - accuracy: 0.3765
Epoch 21/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9384 - accuracy: 0.3779
Epoch 22/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9346 - accuracy: 0.3658
Epoch 23/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9313 - accuracy: 0.3787
Epoch 24/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9267 - accuracy: 0.3829
Epoch 25/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9207 - accuracy: 0.3736
Epoch 26/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9162 - accuracy: 0.3775
Epoch 27/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9190 - accuracy: 0.3713
Epoch 28/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9094 - accuracy: 0.3766
Epoch 29/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9007 - accuracy: 0.3654
Epoch 30/40
514/514 [==============================] - 3s 6ms/step - loss: 4.9012 - accuracy: 0.3857
Epoch 31/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8942 - accuracy: 0.3841
Epoch 32/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8865 - accuracy: 0.3708
Epoch 33/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8817 - accuracy: 0.3714
Epoch 34/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8767 - accuracy: 0.3596
Epoch 35/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8714 - accuracy: 0.3689
Epoch 36/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8666 - accuracy: 0.3682
Epoch 37/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8621 - accuracy: 0.3699
Epoch 38/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8559 - accuracy: 0.3619
Epoch 39/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8550 - accuracy: 0.3617
Epoch 40/40
514/514 [==============================] - 3s 6ms/step - loss: 4.8517 - accuracy: 0.3561
129/129 [==============================] - 0s 2ms/step - loss: 1.2017 - accuracy: 0.3874


For 20: Test ACC=[1.2016801834106445, 0.38741257786750793]
Confusion Matrix
[[4100  463 2146  331]
 [2830  375 2455  628]
 [ 472   89 1693  278]
 [ 160   35  187  203]]
Classification Report
              precision    recall  f1-score   support

           0       0.54      0.58      0.56      7040
           1       0.39      0.06      0.10      6288
           2       0.26      0.67      0.38      2532
           3       0.14      0.35      0.20       585

    accuracy                           0.39     16445
   macro avg       0.33      0.41      0.31     16445
weighted avg       0.43      0.39      0.34     16445

trainingshape 21
(32979, 7)
(32979, 7, 1)
testingshape 21
(8246, 7)
(8246, 7, 1)
nb occurences
Counter({0: 15448, 1: 12264, 2: 4012, 3: 1255})
weights={0: 2.1348394614189536, 1: 2.6890900195694716, 2: 8.220089730807576, 3: 26.27808764940239}
Model: "sequential_16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_32 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_33 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_16 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_16 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
258/258 [==============================] - 2s 6ms/step - loss: 4.9769 - accuracy: 0.4429
Epoch 2/40
258/258 [==============================] - 2s 6ms/step - loss: 4.6066 - accuracy: 0.3969
Epoch 3/40
258/258 [==============================] - 1s 6ms/step - loss: 4.5623 - accuracy: 0.4135
Epoch 4/40
258/258 [==============================] - 1s 6ms/step - loss: 4.5348 - accuracy: 0.4279
Epoch 5/40
258/258 [==============================] - 2s 6ms/step - loss: 4.5142 - accuracy: 0.4412
Epoch 6/40
258/258 [==============================] - 1s 6ms/step - loss: 4.4898 - accuracy: 0.4546
Epoch 7/40
258/258 [==============================] - 2s 6ms/step - loss: 4.4755 - accuracy: 0.4581
Epoch 8/40
258/258 [==============================] - 2s 6ms/step - loss: 4.4568 - accuracy: 0.4625
Epoch 9/40
258/258 [==============================] - 2s 6ms/step - loss: 4.4393 - accuracy: 0.4644
Epoch 10/40
258/258 [==============================] - 1s 6ms/step - loss: 4.4240 - accuracy: 0.4712
Epoch 11/40
258/258 [==============================] - 2s 6ms/step - loss: 4.4135 - accuracy: 0.4771
Epoch 12/40
258/258 [==============================] - 2s 6ms/step - loss: 4.4034 - accuracy: 0.4785
Epoch 13/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3830 - accuracy: 0.4758
Epoch 14/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3790 - accuracy: 0.4762
Epoch 15/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3628 - accuracy: 0.4782
Epoch 16/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3523 - accuracy: 0.4851
Epoch 17/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3432 - accuracy: 0.4791
Epoch 18/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3263 - accuracy: 0.4888
Epoch 19/40
258/258 [==============================] - 2s 6ms/step - loss: 4.3187 - accuracy: 0.4861
Epoch 20/40
258/258 [==============================] - 1s 6ms/step - loss: 4.2938 - accuracy: 0.4922
Epoch 21/40
258/258 [==============================] - 2s 6ms/step - loss: 4.2869 - accuracy: 0.4966
Epoch 22/40
258/258 [==============================] - 2s 6ms/step - loss: 4.2682 - accuracy: 0.5029
Epoch 23/40
258/258 [==============================] - 1s 6ms/step - loss: 4.2479 - accuracy: 0.5030
Epoch 24/40
258/258 [==============================] - 2s 6ms/step - loss: 4.2289 - accuracy: 0.5129
Epoch 25/40
258/258 [==============================] - 2s 6ms/step - loss: 4.2096 - accuracy: 0.5196
Epoch 26/40
258/258 [==============================] - 2s 6ms/step - loss: 4.1820 - accuracy: 0.5231
Epoch 27/40
258/258 [==============================] - 1s 6ms/step - loss: 4.1576 - accuracy: 0.5294
Epoch 28/40
258/258 [==============================] - 2s 6ms/step - loss: 4.1452 - accuracy: 0.5351
Epoch 29/40
258/258 [==============================] - 2s 6ms/step - loss: 4.1195 - accuracy: 0.5414
Epoch 30/40
258/258 [==============================] - 1s 6ms/step - loss: 4.1038 - accuracy: 0.5447
Epoch 31/40
258/258 [==============================] - 2s 6ms/step - loss: 4.0772 - accuracy: 0.5469
Epoch 32/40
258/258 [==============================] - 2s 6ms/step - loss: 4.0658 - accuracy: 0.5574
Epoch 33/40
258/258 [==============================] - 2s 6ms/step - loss: 4.0428 - accuracy: 0.5616
Epoch 34/40
258/258 [==============================] - 2s 6ms/step - loss: 4.0321 - accuracy: 0.5671
Epoch 35/40
258/258 [==============================] - 2s 7ms/step - loss: 4.0160 - accuracy: 0.5673
Epoch 36/40
258/258 [==============================] - 2s 7ms/step - loss: 4.0046 - accuracy: 0.5748
Epoch 37/40
258/258 [==============================] - 2s 7ms/step - loss: 3.9848 - accuracy: 0.5777
Epoch 38/40
258/258 [==============================] - 2s 6ms/step - loss: 3.9876 - accuracy: 0.5786
Epoch 39/40
258/258 [==============================] - 1s 6ms/step - loss: 3.9717 - accuracy: 0.5865
Epoch 40/40
258/258 [==============================] - 2s 7ms/step - loss: 3.9544 - accuracy: 0.5848
65/65 [==============================] - 0s 2ms/step - loss: 1.0268 - accuracy: 0.5634


For 21: Test ACC=[1.0267952680587769, 0.5634247064590454]
Confusion Matrix
[[2441  466  676  279]
 [ 368 1400  540  758]
 [ 174  113  614  103]
 [  16   60   47  191]]
Classification Report
              precision    recall  f1-score   support

           0       0.81      0.63      0.71      3862
           1       0.69      0.46      0.55      3066
           2       0.33      0.61      0.43      1004
           3       0.14      0.61      0.23       314

    accuracy                           0.56      8246
   macro avg       0.49      0.58      0.48      8246
weighted avg       0.68      0.56      0.60      8246

trainingshape 22
(83176, 7)
(83176, 7, 1)
testingshape 22
(20797, 7)
(20797, 7, 1)
nb occurences
Counter({0: 43650, 1: 29432, 2: 8406, 3: 1427, 4: 261})
weights={0: 1.905521191294387, 1: 2.8260396846969282, 2: 9.894837021175352, 3: 58.28731604765242, 4: 318.68199233716473}
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_34 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_35 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_17 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_17 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
650/650 [==============================] - 4s 6ms/step - loss: 7.9202 - accuracy: 0.2216
Epoch 2/40
650/650 [==============================] - 4s 6ms/step - loss: 7.4949 - accuracy: 0.2250
Epoch 3/40
650/650 [==============================] - 4s 6ms/step - loss: 7.3558 - accuracy: 0.2161
Epoch 4/40
650/650 [==============================] - 4s 6ms/step - loss: 7.2350 - accuracy: 0.2789
Epoch 5/40
650/650 [==============================] - 4s 6ms/step - loss: 7.1230 - accuracy: 0.3298
Epoch 6/40
650/650 [==============================] - 4s 6ms/step - loss: 7.0190 - accuracy: 0.3666
Epoch 7/40
650/650 [==============================] - 4s 6ms/step - loss: 6.9541 - accuracy: 0.3924
Epoch 8/40
650/650 [==============================] - 4s 6ms/step - loss: 6.9214 - accuracy: 0.4149
Epoch 9/40
650/650 [==============================] - 4s 6ms/step - loss: 6.8611 - accuracy: 0.4267
Epoch 10/40
650/650 [==============================] - 4s 6ms/step - loss: 6.8549 - accuracy: 0.4373
Epoch 11/40
650/650 [==============================] - 4s 6ms/step - loss: 6.7935 - accuracy: 0.4509
Epoch 12/40
650/650 [==============================] - 4s 6ms/step - loss: 6.7769 - accuracy: 0.4505
Epoch 13/40
650/650 [==============================] - 4s 6ms/step - loss: 6.6986 - accuracy: 0.4659
Epoch 14/40
650/650 [==============================] - 4s 6ms/step - loss: 6.6941 - accuracy: 0.4687
Epoch 15/40
650/650 [==============================] - 4s 6ms/step - loss: 6.9501 - accuracy: 0.4244
Epoch 16/40
650/650 [==============================] - 4s 6ms/step - loss: 6.7971 - accuracy: 0.4191
Epoch 17/40
650/650 [==============================] - 4s 6ms/step - loss: 6.6249 - accuracy: 0.4705
Epoch 18/40
650/650 [==============================] - 4s 6ms/step - loss: 6.5035 - accuracy: 0.4948
Epoch 19/40
650/650 [==============================] - 4s 6ms/step - loss: 6.4008 - accuracy: 0.5098
Epoch 20/40
650/650 [==============================] - 4s 6ms/step - loss: 6.3278 - accuracy: 0.5155
Epoch 21/40
650/650 [==============================] - 4s 6ms/step - loss: 6.2752 - accuracy: 0.5214
Epoch 22/40
650/650 [==============================] - 4s 6ms/step - loss: 6.2018 - accuracy: 0.5295
Epoch 23/40
650/650 [==============================] - 4s 6ms/step - loss: 6.1741 - accuracy: 0.5284
Epoch 24/40
650/650 [==============================] - 4s 6ms/step - loss: 6.1599 - accuracy: 0.5301
Epoch 25/40
650/650 [==============================] - 4s 6ms/step - loss: 6.1057 - accuracy: 0.5302
Epoch 26/40
650/650 [==============================] - 4s 6ms/step - loss: 6.0908 - accuracy: 0.5350
Epoch 27/40
650/650 [==============================] - 4s 6ms/step - loss: 6.0614 - accuracy: 0.5332
Epoch 28/40
650/650 [==============================] - 4s 6ms/step - loss: 6.0287 - accuracy: 0.5344
Epoch 29/40
650/650 [==============================] - 4s 6ms/step - loss: 6.0142 - accuracy: 0.5381
Epoch 30/40
650/650 [==============================] - 4s 6ms/step - loss: 6.0091 - accuracy: 0.5371
Epoch 31/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9656 - accuracy: 0.5362
Epoch 32/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9631 - accuracy: 0.5418
Epoch 33/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9267 - accuracy: 0.5450
Epoch 34/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9511 - accuracy: 0.5392
Epoch 35/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9006 - accuracy: 0.5459
Epoch 36/40
650/650 [==============================] - 4s 6ms/step - loss: 5.9029 - accuracy: 0.5502
Epoch 37/40
650/650 [==============================] - 4s 6ms/step - loss: 5.8604 - accuracy: 0.5500
Epoch 38/40
650/650 [==============================] - 4s 6ms/step - loss: 5.8437 - accuracy: 0.5525
Epoch 39/40
650/650 [==============================] - 4s 6ms/step - loss: 5.8654 - accuracy: 0.5389
Epoch 40/40
650/650 [==============================] - 4s 6ms/step - loss: 5.7477 - accuracy: 0.5433
163/163 [==============================] - 0s 2ms/step - loss: 1.1009 - accuracy: 0.5755


For 22: Test ACC=[1.1008543968200684, 0.575467586517334]
Confusion Matrix
[[7873  977 1340  474  249]
 [1270 2707 2330  365  687]
 [ 203  442 1189  179   89]
 [  66   43   70  160   18]
 [   4    4   15    4   39]]
Classification Report
              precision    recall  f1-score   support

           0       0.84      0.72      0.77     10913
           1       0.65      0.37      0.47      7359
           2       0.24      0.57      0.34      2102
           3       0.14      0.45      0.21       357
           4       0.04      0.59      0.07        66

    accuracy                           0.58     20797
   macro avg       0.38      0.54      0.37     20797
weighted avg       0.70      0.58      0.61     20797

trainingshape 23
(25894, 7)
(25894, 7, 1)
testingshape 23
(6476, 7)
(6476, 7, 1)
nb occurences
Counter({0: 13320, 1: 9676, 2: 2437, 3: 461})
weights={0: 1.9439939939939939, 1: 2.6761058288548987, 2: 10.625359048009848, 3: 56.16919739696313}
Model: "sequential_18"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_36 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_37 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_18 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_18 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
203/203 [==============================] - 1s 6ms/step - loss: 5.4900 - accuracy: 0.2900
Epoch 2/40
203/203 [==============================] - 1s 6ms/step - loss: 5.4395 - accuracy: 0.3410
Epoch 3/40
203/203 [==============================] - 1s 6ms/step - loss: 5.4233 - accuracy: 0.2862
Epoch 4/40
203/203 [==============================] - 1s 6ms/step - loss: 5.4107 - accuracy: 0.2662
Epoch 5/40
203/203 [==============================] - 1s 6ms/step - loss: 5.3983 - accuracy: 0.2814
Epoch 6/40
203/203 [==============================] - 1s 6ms/step - loss: 5.3848 - accuracy: 0.3180
Epoch 7/40
203/203 [==============================] - 1s 6ms/step - loss: 5.3677 - accuracy: 0.2730
Epoch 8/40
203/203 [==============================] - 1s 6ms/step - loss: 5.3437 - accuracy: 0.2591
Epoch 9/40
203/203 [==============================] - 1s 6ms/step - loss: 5.3105 - accuracy: 0.2697
Epoch 10/40
203/203 [==============================] - 1s 6ms/step - loss: 5.2750 - accuracy: 0.2680
Epoch 11/40
203/203 [==============================] - 1s 6ms/step - loss: 5.2390 - accuracy: 0.2905
Epoch 12/40
203/203 [==============================] - 1s 6ms/step - loss: 5.1958 - accuracy: 0.2905
Epoch 13/40
203/203 [==============================] - 1s 6ms/step - loss: 5.1502 - accuracy: 0.3246
Epoch 14/40
203/203 [==============================] - 1s 6ms/step - loss: 5.1088 - accuracy: 0.3025
Epoch 15/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0744 - accuracy: 0.3426
Epoch 16/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0499 - accuracy: 0.3166
Epoch 17/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0283 - accuracy: 0.3394
Epoch 18/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0456 - accuracy: 0.3093
Epoch 19/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9972 - accuracy: 0.3198
Epoch 20/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9858 - accuracy: 0.3250
Epoch 21/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0220 - accuracy: 0.3130
Epoch 22/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9699 - accuracy: 0.3286
Epoch 23/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9580 - accuracy: 0.3368
Epoch 24/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9580 - accuracy: 0.3097
Epoch 25/40
203/203 [==============================] - 1s 6ms/step - loss: 5.0092 - accuracy: 0.3041
Epoch 26/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9497 - accuracy: 0.3084
Epoch 27/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9399 - accuracy: 0.3064
Epoch 28/40
203/203 [==============================] - 1s 7ms/step - loss: 4.9441 - accuracy: 0.3096
Epoch 29/40
203/203 [==============================] - 1s 7ms/step - loss: 4.9331 - accuracy: 0.3251
Epoch 30/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9223 - accuracy: 0.3218
Epoch 31/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9135 - accuracy: 0.3058
Epoch 32/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9766 - accuracy: 0.3030
Epoch 33/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9142 - accuracy: 0.3068
Epoch 34/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9081 - accuracy: 0.3094
Epoch 35/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9039 - accuracy: 0.3066
Epoch 36/40
203/203 [==============================] - 1s 6ms/step - loss: 4.8962 - accuracy: 0.3157
Epoch 37/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9188 - accuracy: 0.3013
Epoch 38/40
203/203 [==============================] - 1s 6ms/step - loss: 4.9676 - accuracy: 0.2993
Epoch 39/40
203/203 [==============================] - 1s 6ms/step - loss: 4.8913 - accuracy: 0.3158
Epoch 40/40
203/203 [==============================] - 1s 6ms/step - loss: 4.8850 - accuracy: 0.3274
51/51 [==============================] - 0s 2ms/step - loss: 1.2069 - accuracy: 0.3311


For 23: Test ACC=[1.206937551498413, 0.33106857538223267]
Confusion Matrix
[[ 968  667 1693    3]
 [ 222  720 1468    9]
 [   4  157  431   18]
 [   2   19   70   25]]
Classification Report
              precision    recall  f1-score   support

           0       0.81      0.29      0.43      3331
           1       0.46      0.30      0.36      2419
           2       0.12      0.71      0.20       610
           3       0.45      0.22      0.29       116

    accuracy                           0.33      6476
   macro avg       0.46      0.38      0.32      6476
weighted avg       0.61      0.33      0.38      6476

trainingshape 24
(101424, 7)
(101424, 7, 1)
testingshape 24
(25359, 7)
(25359, 7, 1)
nb occurences
Counter({0: 42648, 1: 28168, 2: 23370, 3: 6354, 4: 884})
weights={0: 2.37816544738323, 1: 3.6006816245384834, 2: 4.33992297817715, 3: 15.96222851746931, 4: 114.73303167420815}
Model: "sequential_19"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_38 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_39 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_19 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_19 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
793/793 [==============================] - 5s 6ms/step - loss: 7.9029 - accuracy: 0.3031
Epoch 2/40
793/793 [==============================] - 5s 6ms/step - loss: 7.5707 - accuracy: 0.3532
Epoch 3/40
793/793 [==============================] - 5s 6ms/step - loss: 7.3729 - accuracy: 0.3608
Epoch 4/40
793/793 [==============================] - 5s 6ms/step - loss: 7.2490 - accuracy: 0.3791
Epoch 5/40
793/793 [==============================] - 5s 6ms/step - loss: 7.1112 - accuracy: 0.3830
Epoch 6/40
793/793 [==============================] - 5s 6ms/step - loss: 6.9978 - accuracy: 0.4052
Epoch 7/40
793/793 [==============================] - 5s 6ms/step - loss: 6.8572 - accuracy: 0.4198
Epoch 8/40
793/793 [==============================] - 5s 6ms/step - loss: 6.6735 - accuracy: 0.4285
Epoch 9/40
793/793 [==============================] - 5s 6ms/step - loss: 6.4930 - accuracy: 0.4473
Epoch 10/40
793/793 [==============================] - 5s 6ms/step - loss: 6.3537 - accuracy: 0.4642
Epoch 11/40
793/793 [==============================] - 5s 6ms/step - loss: 6.2484 - accuracy: 0.4748
Epoch 12/40
793/793 [==============================] - 5s 6ms/step - loss: 6.1761 - accuracy: 0.4801
Epoch 13/40
793/793 [==============================] - 5s 6ms/step - loss: 6.1054 - accuracy: 0.4839
Epoch 14/40
793/793 [==============================] - 5s 6ms/step - loss: 6.0446 - accuracy: 0.4949
Epoch 15/40
793/793 [==============================] - 5s 6ms/step - loss: 5.9969 - accuracy: 0.4991
Epoch 16/40
793/793 [==============================] - 5s 6ms/step - loss: 5.9373 - accuracy: 0.5095
Epoch 17/40
793/793 [==============================] - 5s 6ms/step - loss: 5.9029 - accuracy: 0.5075
Epoch 18/40
793/793 [==============================] - 5s 6ms/step - loss: 5.8446 - accuracy: 0.5158
Epoch 19/40
793/793 [==============================] - 5s 6ms/step - loss: 5.7831 - accuracy: 0.5193
Epoch 20/40
793/793 [==============================] - 5s 7ms/step - loss: 5.7410 - accuracy: 0.5251
Epoch 21/40
793/793 [==============================] - 5s 6ms/step - loss: 5.6769 - accuracy: 0.5359
Epoch 22/40
793/793 [==============================] - 5s 6ms/step - loss: 5.6235 - accuracy: 0.5376
Epoch 23/40
793/793 [==============================] - 5s 6ms/step - loss: 5.6077 - accuracy: 0.5396
Epoch 24/40
793/793 [==============================] - 5s 6ms/step - loss: 5.5634 - accuracy: 0.5379
Epoch 25/40
793/793 [==============================] - 5s 6ms/step - loss: 5.5242 - accuracy: 0.5394
Epoch 26/40
793/793 [==============================] - 5s 6ms/step - loss: 5.4949 - accuracy: 0.5389
Epoch 27/40
793/793 [==============================] - 5s 6ms/step - loss: 5.4649 - accuracy: 0.5421
Epoch 28/40
793/793 [==============================] - 5s 6ms/step - loss: 5.4503 - accuracy: 0.5351
Epoch 29/40
793/793 [==============================] - 5s 6ms/step - loss: 5.4206 - accuracy: 0.5397
Epoch 30/40
793/793 [==============================] - 5s 6ms/step - loss: 5.4253 - accuracy: 0.5379
Epoch 31/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3818 - accuracy: 0.5369
Epoch 32/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3748 - accuracy: 0.5370
Epoch 33/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3453 - accuracy: 0.5411
Epoch 34/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3331 - accuracy: 0.5325
Epoch 35/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3207 - accuracy: 0.5411
Epoch 36/40
793/793 [==============================] - 5s 6ms/step - loss: 5.3134 - accuracy: 0.5362
Epoch 37/40
793/793 [==============================] - 4s 6ms/step - loss: 5.2905 - accuracy: 0.5330
Epoch 38/40
793/793 [==============================] - 5s 6ms/step - loss: 5.2779 - accuracy: 0.5338
Epoch 39/40
793/793 [==============================] - 5s 6ms/step - loss: 5.2767 - accuracy: 0.5376
Epoch 40/40
793/793 [==============================] - 5s 6ms/step - loss: 5.2640 - accuracy: 0.5394
199/199 [==============================] - 0s 2ms/step - loss: 1.1180 - accuracy: 0.5013


For 24: Test ACC=[1.1180310249328613, 0.501321017742157]
Confusion Matrix
[[5073  594 1770  304 2922]
 [1285 4205  889   99  565]
 [1171  234 2349  188 1901]
 [  51   22  304  915  297]
 [   1    4   32   13  171]]
Classification Report
              precision    recall  f1-score   support

           0       0.67      0.48      0.56     10663
           1       0.83      0.60      0.69      7043
           2       0.44      0.40      0.42      5843
           3       0.60      0.58      0.59      1589
           4       0.03      0.77      0.06       221

    accuracy                           0.50     25359
   macro avg       0.51      0.56      0.46     25359
weighted avg       0.65      0.50      0.56     25359

trainingshape 25
(40952, 7)
(40952, 7, 1)
testingshape 25
(10239, 7)
(10239, 7, 1)
nb occurences
Counter({0: 15332, 1: 13630, 2: 9243, 3: 2747})
weights={0: 2.671014870858335, 1: 3.0045487894350695, 2: 4.430596126798658, 3: 14.907899526756461}
Model: "sequential_20"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_40 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_41 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_20 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_20 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
320/320 [==============================] - 2s 6ms/step - loss: 5.5965 - accuracy: 0.2135
Epoch 2/40
320/320 [==============================] - 2s 6ms/step - loss: 5.4189 - accuracy: 0.3310
Epoch 3/40
320/320 [==============================] - 2s 6ms/step - loss: 5.2986 - accuracy: 0.3703
Epoch 4/40
320/320 [==============================] - 2s 6ms/step - loss: 5.1768 - accuracy: 0.3601
Epoch 5/40
320/320 [==============================] - 2s 6ms/step - loss: 5.1184 - accuracy: 0.3677
Epoch 6/40
320/320 [==============================] - 2s 6ms/step - loss: 5.0931 - accuracy: 0.3655
Epoch 7/40
320/320 [==============================] - 2s 6ms/step - loss: 5.0787 - accuracy: 0.3719
Epoch 8/40
320/320 [==============================] - 2s 6ms/step - loss: 5.0566 - accuracy: 0.3749
Epoch 9/40
320/320 [==============================] - 2s 6ms/step - loss: 5.0383 - accuracy: 0.3744
Epoch 10/40
320/320 [==============================] - 2s 6ms/step - loss: 5.0198 - accuracy: 0.3793
Epoch 11/40
320/320 [==============================] - 2s 6ms/step - loss: 4.9931 - accuracy: 0.3852
Epoch 12/40
320/320 [==============================] - 2s 6ms/step - loss: 4.9866 - accuracy: 0.3856
Epoch 13/40
320/320 [==============================] - 2s 6ms/step - loss: 4.9637 - accuracy: 0.3885
Epoch 14/40
320/320 [==============================] - 2s 6ms/step - loss: 4.9311 - accuracy: 0.3971
Epoch 15/40
320/320 [==============================] - 2s 6ms/step - loss: 4.9127 - accuracy: 0.3997
Epoch 16/40
320/320 [==============================] - 2s 6ms/step - loss: 4.8891 - accuracy: 0.4028
Epoch 17/40
320/320 [==============================] - 2s 6ms/step - loss: 4.8512 - accuracy: 0.4141
Epoch 18/40
320/320 [==============================] - 2s 6ms/step - loss: 4.8260 - accuracy: 0.4154
Epoch 19/40
320/320 [==============================] - 2s 6ms/step - loss: 4.8075 - accuracy: 0.4220
Epoch 20/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7896 - accuracy: 0.4226
Epoch 21/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7763 - accuracy: 0.4295
Epoch 22/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7484 - accuracy: 0.4302
Epoch 23/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7438 - accuracy: 0.4346
Epoch 24/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7224 - accuracy: 0.4397
Epoch 25/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7211 - accuracy: 0.4359
Epoch 26/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7122 - accuracy: 0.4401
Epoch 27/40
320/320 [==============================] - 2s 6ms/step - loss: 4.7052 - accuracy: 0.4398
Epoch 28/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6825 - accuracy: 0.4420
Epoch 29/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6865 - accuracy: 0.4440
Epoch 30/40
320/320 [==============================] - 2s 8ms/step - loss: 4.6630 - accuracy: 0.4498
Epoch 31/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6564 - accuracy: 0.4453
Epoch 32/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6483 - accuracy: 0.4505
Epoch 33/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6489 - accuracy: 0.4526
Epoch 34/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6394 - accuracy: 0.4476
Epoch 35/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6323 - accuracy: 0.4510
Epoch 36/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6317 - accuracy: 0.4489
Epoch 37/40
320/320 [==============================] - 2s 6ms/step - loss: 4.6132 - accuracy: 0.4542
Epoch 38/40
320/320 [==============================] - 2s 6ms/step - loss: 4.5952 - accuracy: 0.4551
Epoch 39/40
320/320 [==============================] - 2s 6ms/step - loss: 4.5784 - accuracy: 0.4603
Epoch 40/40
320/320 [==============================] - 2s 6ms/step - loss: 4.5701 - accuracy: 0.4586
80/80 [==============================] - 0s 2ms/step - loss: 1.1446 - accuracy: 0.4873


For 25: Test ACC=[1.1445963382720947, 0.48725461959838867]
Confusion Matrix
[[1730 1174  708  221]
 [ 752 2072  267  317]
 [ 611  542  843  315]
 [  74  161  108  344]]
Classification Report
              precision    recall  f1-score   support

           0       0.55      0.45      0.49      3833
           1       0.52      0.61      0.56      3408
           2       0.44      0.36      0.40      2311
           3       0.29      0.50      0.37       687

    accuracy                           0.49     10239
   macro avg       0.45      0.48      0.46     10239
weighted avg       0.50      0.49      0.49     10239

trainingshape 26
(50087, 7)
(50087, 7, 1)
testingshape 26
(12524, 7)
(12524, 7, 1)
nb occurences
Counter({0: 21706, 1: 17573, 2: 8352, 3: 2079, 4: 377})
weights={0: 2.307518658435456, 1: 2.850224776645991, 2: 5.997006704980842, 3: 24.09187109187109, 4: 132.85676392572944}
Model: "sequential_21"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_42 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_43 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_21 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_21 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
392/392 [==============================] - 2s 6ms/step - loss: 8.0343 - accuracy: 0.2565
Epoch 2/40
392/392 [==============================] - 2s 6ms/step - loss: 7.8119 - accuracy: 0.3296
Epoch 3/40
392/392 [==============================] - 2s 6ms/step - loss: 7.7273 - accuracy: 0.3212
Epoch 4/40
392/392 [==============================] - 2s 6ms/step - loss: 7.6906 - accuracy: 0.3268
Epoch 5/40
392/392 [==============================] - 2s 6ms/step - loss: 7.6717 - accuracy: 0.3161
Epoch 6/40
392/392 [==============================] - 2s 6ms/step - loss: 7.6412 - accuracy: 0.3136
Epoch 7/40
392/392 [==============================] - 2s 6ms/step - loss: 7.6038 - accuracy: 0.3126
Epoch 8/40
392/392 [==============================] - 2s 6ms/step - loss: 7.5629 - accuracy: 0.3115
Epoch 9/40
392/392 [==============================] - 2s 6ms/step - loss: 7.5295 - accuracy: 0.3119
Epoch 10/40
392/392 [==============================] - 2s 6ms/step - loss: 7.4858 - accuracy: 0.3104
Epoch 11/40
392/392 [==============================] - 2s 6ms/step - loss: 7.4206 - accuracy: 0.3132
Epoch 12/40
392/392 [==============================] - 2s 6ms/step - loss: 7.3458 - accuracy: 0.3066
Epoch 13/40
392/392 [==============================] - 2s 6ms/step - loss: 7.2934 - accuracy: 0.3042
Epoch 14/40
392/392 [==============================] - 2s 6ms/step - loss: 7.2090 - accuracy: 0.3116
Epoch 15/40
392/392 [==============================] - 2s 6ms/step - loss: 7.1865 - accuracy: 0.3135
Epoch 16/40
392/392 [==============================] - 2s 6ms/step - loss: 7.1349 - accuracy: 0.3210
Epoch 17/40
392/392 [==============================] - 2s 6ms/step - loss: 7.0955 - accuracy: 0.3218
Epoch 18/40
392/392 [==============================] - 2s 6ms/step - loss: 7.1169 - accuracy: 0.3250
Epoch 19/40
392/392 [==============================] - 2s 6ms/step - loss: 7.0504 - accuracy: 0.3272
Epoch 20/40
392/392 [==============================] - 2s 6ms/step - loss: 7.0374 - accuracy: 0.3247
Epoch 21/40
392/392 [==============================] - 2s 6ms/step - loss: 6.9971 - accuracy: 0.3326
Epoch 22/40
392/392 [==============================] - 2s 6ms/step - loss: 6.9502 - accuracy: 0.3316
Epoch 23/40
392/392 [==============================] - 2s 6ms/step - loss: 6.9490 - accuracy: 0.3357
Epoch 24/40
392/392 [==============================] - 2s 6ms/step - loss: 6.9060 - accuracy: 0.3340
Epoch 25/40
392/392 [==============================] - 2s 6ms/step - loss: 6.9041 - accuracy: 0.3364
Epoch 26/40
392/392 [==============================] - 2s 6ms/step - loss: 6.8663 - accuracy: 0.3439
Epoch 27/40
392/392 [==============================] - 2s 6ms/step - loss: 6.8703 - accuracy: 0.3417
Epoch 28/40
392/392 [==============================] - 2s 6ms/step - loss: 6.8359 - accuracy: 0.3436
Epoch 29/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7871 - accuracy: 0.3498
Epoch 30/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7851 - accuracy: 0.3456
Epoch 31/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7589 - accuracy: 0.3485
Epoch 32/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7947 - accuracy: 0.3495
Epoch 33/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7677 - accuracy: 0.3482
Epoch 34/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7169 - accuracy: 0.3532
Epoch 35/40
392/392 [==============================] - 2s 6ms/step - loss: 6.7118 - accuracy: 0.3534
Epoch 36/40
392/392 [==============================] - 2s 6ms/step - loss: 6.6845 - accuracy: 0.3591
Epoch 37/40
392/392 [==============================] - 2s 6ms/step - loss: 6.6465 - accuracy: 0.3580
Epoch 38/40
392/392 [==============================] - 2s 6ms/step - loss: 6.6374 - accuracy: 0.3610
Epoch 39/40
392/392 [==============================] - 2s 6ms/step - loss: 6.6439 - accuracy: 0.3631
Epoch 40/40
392/392 [==============================] - 2s 6ms/step - loss: 6.6251 - accuracy: 0.3622
98/98 [==============================] - 0s 2ms/step - loss: 1.4346 - accuracy: 0.3501


For 26: Test ACC=[1.4346438646316528, 0.3501277565956116]
Confusion Matrix
[[2373  912  877  344  921]
 [ 709 1233  618  185 1649]
 [ 239  335  453  254  807]
 [  28   86   44  249  113]
 [   0    8    5    5   77]]
Classification Report
              precision    recall  f1-score   support

           0       0.71      0.44      0.54      5427
           1       0.48      0.28      0.35      4394
           2       0.23      0.22      0.22      2088
           3       0.24      0.48      0.32       520
           4       0.02      0.81      0.04        95

    accuracy                           0.35     12524
   macro avg       0.34      0.44      0.30     12524
weighted avg       0.52      0.35      0.41     12524

trainingshape 27
(68049, 7)
(68049, 7, 1)
testingshape 27
(17015, 7)
(17015, 7, 1)
nb occurences
Counter({0: 29756, 1: 21742, 2: 13276, 3: 3101, 4: 174})
weights={0: 2.2869001209840034, 1: 3.1298408610063473, 2: 5.125715576981018, 3: 21.94421154466301, 4: 391.08620689655174}
Model: "sequential_22"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_44 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_45 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_22 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_22 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
532/532 [==============================] - 3s 6ms/step - loss: 7.7448 - accuracy: 0.2316
Epoch 2/40
532/532 [==============================] - 3s 6ms/step - loss: 7.4078 - accuracy: 0.3051
Epoch 3/40
532/532 [==============================] - 3s 6ms/step - loss: 7.2011 - accuracy: 0.3366
Epoch 4/40
532/532 [==============================] - 3s 6ms/step - loss: 7.0145 - accuracy: 0.3633
Epoch 5/40
532/532 [==============================] - 3s 6ms/step - loss: 6.8398 - accuracy: 0.3804
Epoch 6/40
532/532 [==============================] - 3s 6ms/step - loss: 6.6938 - accuracy: 0.4022
Epoch 7/40
532/532 [==============================] - 3s 6ms/step - loss: 6.5782 - accuracy: 0.3957
Epoch 8/40
532/532 [==============================] - 3s 6ms/step - loss: 6.5033 - accuracy: 0.4053
Epoch 9/40
532/532 [==============================] - 3s 6ms/step - loss: 6.4202 - accuracy: 0.3991
Epoch 10/40
532/532 [==============================] - 3s 6ms/step - loss: 6.3448 - accuracy: 0.4121
Epoch 11/40
532/532 [==============================] - 3s 6ms/step - loss: 6.2667 - accuracy: 0.4118
Epoch 12/40
532/532 [==============================] - 3s 6ms/step - loss: 6.2117 - accuracy: 0.4200
Epoch 13/40
532/532 [==============================] - 3s 6ms/step - loss: 6.1737 - accuracy: 0.4273
Epoch 14/40
532/532 [==============================] - 3s 6ms/step - loss: 6.0987 - accuracy: 0.4225
Epoch 15/40
532/532 [==============================] - 3s 6ms/step - loss: 6.0547 - accuracy: 0.4272
Epoch 16/40
532/532 [==============================] - 3s 6ms/step - loss: 5.9985 - accuracy: 0.4319
Epoch 17/40
532/532 [==============================] - 3s 6ms/step - loss: 5.9910 - accuracy: 0.4259
Epoch 18/40
532/532 [==============================] - 3s 6ms/step - loss: 5.9180 - accuracy: 0.4303
Epoch 19/40
532/532 [==============================] - 3s 6ms/step - loss: 5.8580 - accuracy: 0.4324
Epoch 20/40
532/532 [==============================] - 3s 6ms/step - loss: 5.8280 - accuracy: 0.4414
Epoch 21/40
532/532 [==============================] - 3s 6ms/step - loss: 5.7813 - accuracy: 0.4425
Epoch 22/40
532/532 [==============================] - 3s 6ms/step - loss: 5.7538 - accuracy: 0.4558
Epoch 23/40
532/532 [==============================] - 3s 6ms/step - loss: 5.7062 - accuracy: 0.4398
Epoch 24/40
532/532 [==============================] - 3s 6ms/step - loss: 5.6731 - accuracy: 0.4516
Epoch 25/40
532/532 [==============================] - 3s 6ms/step - loss: 5.6457 - accuracy: 0.4558
Epoch 26/40
532/532 [==============================] - 3s 6ms/step - loss: 5.6245 - accuracy: 0.4494
Epoch 27/40
532/532 [==============================] - 3s 6ms/step - loss: 5.6018 - accuracy: 0.4563
Epoch 28/40
532/532 [==============================] - 3s 6ms/step - loss: 5.5756 - accuracy: 0.4506
Epoch 29/40
532/532 [==============================] - 3s 6ms/step - loss: 5.6439 - accuracy: 0.4508
Epoch 30/40
532/532 [==============================] - 3s 6ms/step - loss: 5.5052 - accuracy: 0.4537
Epoch 31/40
532/532 [==============================] - 3s 6ms/step - loss: 5.5245 - accuracy: 0.4576
Epoch 32/40
532/532 [==============================] - 3s 6ms/step - loss: 5.5084 - accuracy: 0.4574
Epoch 33/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4881 - accuracy: 0.4591
Epoch 34/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4516 - accuracy: 0.4577
Epoch 35/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4248 - accuracy: 0.4595
Epoch 36/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4605 - accuracy: 0.4535
Epoch 37/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4180 - accuracy: 0.4536
Epoch 38/40
532/532 [==============================] - 3s 6ms/step - loss: 5.4103 - accuracy: 0.4620
Epoch 39/40
532/532 [==============================] - 3s 6ms/step - loss: 5.3925 - accuracy: 0.4573
Epoch 40/40
532/532 [==============================] - 3s 6ms/step - loss: 5.3767 - accuracy: 0.4578
133/133 [==============================] - 0s 2ms/step - loss: 1.2255 - accuracy: 0.4414


For 27: Test ACC=[1.2254655361175537, 0.44143402576446533]
Confusion Matrix
[[2654 1666 2506  515   99]
 [ 756 2695  932  926  127]
 [ 456  699 1789  341   34]
 [  30  192  163  346   45]
 [   1    7    5    4   27]]
Classification Report
              precision    recall  f1-score   support

           0       0.68      0.36      0.47      7440
           1       0.51      0.50      0.50      5436
           2       0.33      0.54      0.41      3319
           3       0.16      0.45      0.24       776
           4       0.08      0.61      0.14        44

    accuracy                           0.44     17015
   macro avg       0.35      0.49      0.35     17015
weighted avg       0.53      0.44      0.46     17015

trainingshape 28
(22896, 7)
(22896, 7, 1)
testingshape 28
(5726, 7)
(5726, 7, 1)
nb occurences
Counter({0: 10764, 1: 7462, 2: 3882, 3: 788})
weights={0: 2.1270903010033444, 1: 3.068346287858483, 2: 5.897990726429676, 3: 29.055837563451774}
Model: "sequential_23"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_46 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_47 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_23 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_23 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
179/179 [==============================] - 1s 7ms/step - loss: 5.4152 - accuracy: 0.3801
Epoch 2/40
179/179 [==============================] - 1s 6ms/step - loss: 5.2699 - accuracy: 0.2708
Epoch 3/40
179/179 [==============================] - 1s 6ms/step - loss: 5.1465 - accuracy: 0.3205
Epoch 4/40
179/179 [==============================] - 1s 6ms/step - loss: 4.9998 - accuracy: 0.3866
Epoch 5/40
179/179 [==============================] - 1s 6ms/step - loss: 4.8581 - accuracy: 0.4182
Epoch 6/40
179/179 [==============================] - 1s 6ms/step - loss: 4.7564 - accuracy: 0.4441
Epoch 7/40
179/179 [==============================] - 1s 6ms/step - loss: 4.6772 - accuracy: 0.4532
Epoch 8/40
179/179 [==============================] - 1s 6ms/step - loss: 4.6008 - accuracy: 0.4724
Epoch 9/40
179/179 [==============================] - 1s 6ms/step - loss: 4.5461 - accuracy: 0.4825
Epoch 10/40
179/179 [==============================] - 1s 6ms/step - loss: 4.5011 - accuracy: 0.4845
Epoch 11/40
179/179 [==============================] - 1s 6ms/step - loss: 4.4593 - accuracy: 0.4931
Epoch 12/40
179/179 [==============================] - 1s 6ms/step - loss: 4.4090 - accuracy: 0.5060
Epoch 13/40
179/179 [==============================] - 1s 6ms/step - loss: 4.3733 - accuracy: 0.5139
Epoch 14/40
179/179 [==============================] - 1s 6ms/step - loss: 4.3258 - accuracy: 0.5208
Epoch 15/40
179/179 [==============================] - 1s 8ms/step - loss: 4.2781 - accuracy: 0.5334
Epoch 16/40
179/179 [==============================] - 1s 6ms/step - loss: 4.2268 - accuracy: 0.5473
Epoch 17/40
179/179 [==============================] - 1s 6ms/step - loss: 4.1823 - accuracy: 0.5561
Epoch 18/40
179/179 [==============================] - 1s 6ms/step - loss: 4.1397 - accuracy: 0.5664
Epoch 19/40
179/179 [==============================] - 1s 6ms/step - loss: 4.1026 - accuracy: 0.5717
Epoch 20/40
179/179 [==============================] - 1s 6ms/step - loss: 4.0743 - accuracy: 0.5786
Epoch 21/40
179/179 [==============================] - 1s 6ms/step - loss: 4.0389 - accuracy: 0.5828
Epoch 22/40
179/179 [==============================] - 1s 6ms/step - loss: 4.0103 - accuracy: 0.5875
Epoch 23/40
179/179 [==============================] - 1s 6ms/step - loss: 3.9852 - accuracy: 0.5926
Epoch 24/40
179/179 [==============================] - 1s 6ms/step - loss: 3.9702 - accuracy: 0.5931
Epoch 25/40
179/179 [==============================] - 1s 6ms/step - loss: 3.9411 - accuracy: 0.5968
Epoch 26/40
179/179 [==============================] - 1s 6ms/step - loss: 3.9254 - accuracy: 0.5977
Epoch 27/40
179/179 [==============================] - 1s 6ms/step - loss: 3.9068 - accuracy: 0.6002
Epoch 28/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8918 - accuracy: 0.5958
Epoch 29/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8774 - accuracy: 0.5994
Epoch 30/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8632 - accuracy: 0.6010
Epoch 31/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8474 - accuracy: 0.5984
Epoch 32/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8372 - accuracy: 0.6012
Epoch 33/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8239 - accuracy: 0.6012
Epoch 34/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8112 - accuracy: 0.6000
Epoch 35/40
179/179 [==============================] - 1s 6ms/step - loss: 3.8058 - accuracy: 0.5984
Epoch 36/40
179/179 [==============================] - 1s 6ms/step - loss: 3.7896 - accuracy: 0.5990
Epoch 37/40
179/179 [==============================] - 1s 6ms/step - loss: 3.7791 - accuracy: 0.5955
Epoch 38/40
179/179 [==============================] - 1s 6ms/step - loss: 3.7689 - accuracy: 0.5999
Epoch 39/40
179/179 [==============================] - 1s 6ms/step - loss: 3.7642 - accuracy: 0.6003
Epoch 40/40
179/179 [==============================] - 1s 6ms/step - loss: 3.7573 - accuracy: 0.5999
45/45 [==============================] - 0s 2ms/step - loss: 0.9714 - accuracy: 0.6027


For 28: Test ACC=[0.9713916182518005, 0.6026895046234131]
Confusion Matrix
[[1923  489  176  103]
 [ 521  829  404  112]
 [ 141  204  594   32]
 [  21   48   24  105]]
Classification Report
              precision    recall  f1-score   support

           0       0.74      0.71      0.73      2691
           1       0.53      0.44      0.48      1866
           2       0.50      0.61      0.55       971
           3       0.30      0.53      0.38       198

    accuracy                           0.60      5726
   macro avg       0.52      0.58      0.53      5726
weighted avg       0.61      0.60      0.60      5726

trainingshape 29
(65069, 7)
(65069, 7, 1)
testingshape 29
(16268, 7)
(16268, 7, 1)
nb occurences
Counter({0: 35284, 1: 17194, 2: 11268, 3: 1103, 4: 220})
weights={0: 1.84415032309262, 1: 3.7844015354193323, 2: 5.774671636492723, 3: 58.99274705349048, 4: 295.7681818181818}
Model: "sequential_24"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_48 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_49 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_24 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_24 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
509/509 [==============================] - 3s 6ms/step - loss: 7.9469 - accuracy: 0.3158
Epoch 2/40
509/509 [==============================] - 3s 6ms/step - loss: 6.6481 - accuracy: 0.4804
Epoch 3/40
509/509 [==============================] - 3s 6ms/step - loss: 6.1624 - accuracy: 0.4534
Epoch 4/40
509/509 [==============================] - 3s 6ms/step - loss: 6.0170 - accuracy: 0.5041
Epoch 5/40
509/509 [==============================] - 3s 6ms/step - loss: 5.9143 - accuracy: 0.5176
Epoch 6/40
509/509 [==============================] - 3s 6ms/step - loss: 5.8436 - accuracy: 0.5158
Epoch 7/40
509/509 [==============================] - 3s 6ms/step - loss: 5.7850 - accuracy: 0.5242
Epoch 8/40
509/509 [==============================] - 3s 6ms/step - loss: 5.7228 - accuracy: 0.5441
Epoch 9/40
509/509 [==============================] - 3s 6ms/step - loss: 5.6767 - accuracy: 0.5439
Epoch 10/40
509/509 [==============================] - 3s 6ms/step - loss: 5.6533 - accuracy: 0.5481
Epoch 11/40
509/509 [==============================] - 3s 6ms/step - loss: 5.6276 - accuracy: 0.5476
Epoch 12/40
509/509 [==============================] - 3s 6ms/step - loss: 5.5624 - accuracy: 0.5617
Epoch 13/40
509/509 [==============================] - 3s 6ms/step - loss: 5.4925 - accuracy: 0.5666
Epoch 14/40
509/509 [==============================] - 3s 6ms/step - loss: 5.4798 - accuracy: 0.5614
Epoch 15/40
509/509 [==============================] - 3s 6ms/step - loss: 5.4256 - accuracy: 0.5717
Epoch 16/40
509/509 [==============================] - 3s 6ms/step - loss: 5.3906 - accuracy: 0.5731
Epoch 17/40
509/509 [==============================] - 3s 6ms/step - loss: 5.3406 - accuracy: 0.5778
Epoch 18/40
509/509 [==============================] - 3s 6ms/step - loss: 5.2917 - accuracy: 0.5763
Epoch 19/40
509/509 [==============================] - 3s 6ms/step - loss: 5.2431 - accuracy: 0.5829
Epoch 20/40
509/509 [==============================] - 3s 6ms/step - loss: 5.1906 - accuracy: 0.5955
Epoch 21/40
509/509 [==============================] - 3s 6ms/step - loss: 5.1438 - accuracy: 0.5901
Epoch 22/40
509/509 [==============================] - 3s 6ms/step - loss: 5.0719 - accuracy: 0.6037
Epoch 23/40
509/509 [==============================] - 3s 6ms/step - loss: 5.0290 - accuracy: 0.6084
Epoch 24/40
509/509 [==============================] - 3s 6ms/step - loss: 4.9790 - accuracy: 0.6073
Epoch 25/40
509/509 [==============================] - 3s 6ms/step - loss: 4.9370 - accuracy: 0.6060
Epoch 26/40
509/509 [==============================] - 3s 6ms/step - loss: 4.8917 - accuracy: 0.6083
Epoch 27/40
509/509 [==============================] - 3s 6ms/step - loss: 4.8636 - accuracy: 0.6081
Epoch 28/40
509/509 [==============================] - 3s 6ms/step - loss: 4.8225 - accuracy: 0.6075
Epoch 29/40
509/509 [==============================] - 3s 7ms/step - loss: 4.7984 - accuracy: 0.6147
Epoch 30/40
509/509 [==============================] - 3s 6ms/step - loss: 4.7752 - accuracy: 0.6031
Epoch 31/40
509/509 [==============================] - 3s 6ms/step - loss: 4.7382 - accuracy: 0.6150
Epoch 32/40
509/509 [==============================] - 3s 6ms/step - loss: 4.7076 - accuracy: 0.6120
Epoch 33/40
509/509 [==============================] - 3s 6ms/step - loss: 4.7033 - accuracy: 0.6177
Epoch 34/40
509/509 [==============================] - 3s 6ms/step - loss: 4.6883 - accuracy: 0.6115
Epoch 35/40
509/509 [==============================] - 3s 6ms/step - loss: 4.6379 - accuracy: 0.6188
Epoch 36/40
509/509 [==============================] - 3s 6ms/step - loss: 4.6301 - accuracy: 0.6216
Epoch 37/40
509/509 [==============================] - 3s 6ms/step - loss: 4.6295 - accuracy: 0.6204
Epoch 38/40
509/509 [==============================] - 3s 6ms/step - loss: 4.6167 - accuracy: 0.6244
Epoch 39/40
509/509 [==============================] - 3s 7ms/step - loss: 4.5759 - accuracy: 0.6235
Epoch 40/40
509/509 [==============================] - 3s 6ms/step - loss: 4.5532 - accuracy: 0.6276
128/128 [==============================] - 0s 2ms/step - loss: 1.0426 - accuracy: 0.5738


For 29: Test ACC=[1.0426294803619385, 0.573764443397522]
Confusion Matrix
[[5332 1309  284 1879   17]
 [ 456 1686  805 1336   16]
 [ 112  307 2086  299   13]
 [  15   27   44  181    9]
 [   0    2    0    4   49]]
Classification Report
              precision    recall  f1-score   support

           0       0.90      0.60      0.72      8821
           1       0.51      0.39      0.44      4299
           2       0.65      0.74      0.69      2817
           3       0.05      0.66      0.09       276
           4       0.47      0.89      0.62        55

    accuracy                           0.57     16268
   macro avg       0.52      0.66      0.51     16268
weighted avg       0.74      0.57      0.63     16268

trainingshape 30
(21093, 7)
(21093, 7, 1)
testingshape 30
(5275, 7)
(5275, 7, 1)
nb occurences
Counter({0: 12405, 1: 4860, 2: 3438, 3: 390})
weights={0: 1.7003627569528417, 1: 4.340123456790123, 2: 6.135253054101222, 3: 54.08461538461538}
Model: "sequential_25"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_50 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_51 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_25 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_25 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
165/165 [==============================] - 1s 6ms/step - loss: 5.4413 - accuracy: 0.5674
Epoch 2/40
165/165 [==============================] - 1s 6ms/step - loss: 4.8570 - accuracy: 0.6150
Epoch 3/40
165/165 [==============================] - 1s 6ms/step - loss: 4.6588 - accuracy: 0.5481
Epoch 4/40
165/165 [==============================] - 1s 6ms/step - loss: 4.5611 - accuracy: 0.5348
Epoch 5/40
165/165 [==============================] - 1s 6ms/step - loss: 4.5085 - accuracy: 0.5202
Epoch 6/40
165/165 [==============================] - 1s 6ms/step - loss: 4.4668 - accuracy: 0.6088
Epoch 7/40
165/165 [==============================] - 1s 6ms/step - loss: 4.4385 - accuracy: 0.6261
Epoch 8/40
165/165 [==============================] - 1s 6ms/step - loss: 4.4072 - accuracy: 0.6377
Epoch 9/40
165/165 [==============================] - 1s 6ms/step - loss: 4.3840 - accuracy: 0.6221
Epoch 10/40
165/165 [==============================] - 1s 6ms/step - loss: 4.3637 - accuracy: 0.6430
Epoch 11/40
165/165 [==============================] - 1s 6ms/step - loss: 4.3422 - accuracy: 0.6250
Epoch 12/40
165/165 [==============================] - 1s 6ms/step - loss: 4.3264 - accuracy: 0.6388
Epoch 13/40
165/165 [==============================] - 1s 6ms/step - loss: 4.3023 - accuracy: 0.6126
Epoch 14/40
165/165 [==============================] - 1s 6ms/step - loss: 4.2855 - accuracy: 0.6389
Epoch 15/40
165/165 [==============================] - 1s 6ms/step - loss: 4.2705 - accuracy: 0.6422
Epoch 16/40
165/165 [==============================] - 1s 6ms/step - loss: 4.2480 - accuracy: 0.6423
Epoch 17/40
165/165 [==============================] - 1s 6ms/step - loss: 4.2268 - accuracy: 0.6368
Epoch 18/40
165/165 [==============================] - 1s 6ms/step - loss: 4.2127 - accuracy: 0.6419
Epoch 19/40
165/165 [==============================] - 1s 6ms/step - loss: 4.1999 - accuracy: 0.5970
Epoch 20/40
165/165 [==============================] - 1s 6ms/step - loss: 4.1836 - accuracy: 0.6551
Epoch 21/40
165/165 [==============================] - 1s 6ms/step - loss: 4.1639 - accuracy: 0.6077
Epoch 22/40
165/165 [==============================] - 1s 6ms/step - loss: 4.1474 - accuracy: 0.6485
Epoch 23/40
165/165 [==============================] - 1s 7ms/step - loss: 4.1294 - accuracy: 0.6357
Epoch 24/40
165/165 [==============================] - 1s 7ms/step - loss: 4.1181 - accuracy: 0.6448
Epoch 25/40
165/165 [==============================] - 1s 6ms/step - loss: 4.1045 - accuracy: 0.6377
Epoch 26/40
165/165 [==============================] - 1s 6ms/step - loss: 4.0762 - accuracy: 0.6506
Epoch 27/40
165/165 [==============================] - 1s 6ms/step - loss: 4.0641 - accuracy: 0.6302
Epoch 28/40
165/165 [==============================] - 1s 6ms/step - loss: 4.0385 - accuracy: 0.6471
Epoch 29/40
165/165 [==============================] - 1s 6ms/step - loss: 4.0227 - accuracy: 0.6367
Epoch 30/40
165/165 [==============================] - 1s 6ms/step - loss: 4.0041 - accuracy: 0.6341
Epoch 31/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9805 - accuracy: 0.6488
Epoch 32/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9701 - accuracy: 0.6404
Epoch 33/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9590 - accuracy: 0.6413
Epoch 34/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9431 - accuracy: 0.6346
Epoch 35/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9305 - accuracy: 0.6384
Epoch 36/40
165/165 [==============================] - 1s 6ms/step - loss: 3.9028 - accuracy: 0.6378
Epoch 37/40
165/165 [==============================] - 1s 6ms/step - loss: 3.8940 - accuracy: 0.6369
Epoch 38/40
165/165 [==============================] - 1s 6ms/step - loss: 3.8445 - accuracy: 0.6322
Epoch 39/40
165/165 [==============================] - 1s 6ms/step - loss: 3.8439 - accuracy: 0.6328
Epoch 40/40
165/165 [==============================] - 1s 6ms/step - loss: 3.8434 - accuracy: 0.6366
42/42 [==============================] - 0s 2ms/step - loss: 0.9615 - accuracy: 0.5788


For 30: Test ACC=[0.9614741206169128, 0.5787677764892578]
Confusion Matrix
[[2142  250  182  528]
 [  78  309  327  501]
 [  15  106  541  198]
 [   2   27    8   61]]
Classification Report
              precision    recall  f1-score   support

           0       0.96      0.69      0.80      3102
           1       0.45      0.25      0.32      1215
           2       0.51      0.63      0.56       860
           3       0.05      0.62      0.09        98

    accuracy                           0.58      5275
   macro avg       0.49      0.55      0.44      5275
weighted avg       0.75      0.58      0.64      5275

trainingshape 31
(48768, 7)
(48768, 7, 1)
testingshape 31
(12195, 7)
(12195, 7, 1)
nb occurences
Counter({0: 27244, 1: 15837, 2: 5224, 3: 463})
weights={0: 1.790045514608721, 1: 3.0793710930100398, 2: 9.335375191424196, 3: 105.33045356371491}
Model: "sequential_26"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_52 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_53 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_26 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_26 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
381/381 [==============================] - 2s 4ms/step - loss: 5.4751 - accuracy: 0.1761
Epoch 2/40
381/381 [==============================] - 1s 4ms/step - loss: 5.2859 - accuracy: 0.3063
Epoch 3/40
381/381 [==============================] - 2s 4ms/step - loss: 5.1972 - accuracy: 0.3517
Epoch 4/40
381/381 [==============================] - 1s 4ms/step - loss: 5.1541 - accuracy: 0.3403
Epoch 5/40
381/381 [==============================] - 1s 4ms/step - loss: 5.1238 - accuracy: 0.3399
Epoch 6/40
381/381 [==============================] - 2s 4ms/step - loss: 5.0910 - accuracy: 0.3703
Epoch 7/40
381/381 [==============================] - 1s 4ms/step - loss: 5.0600 - accuracy: 0.3446
Epoch 8/40
381/381 [==============================] - 1s 4ms/step - loss: 5.0299 - accuracy: 0.3633
Epoch 9/40
381/381 [==============================] - 1s 4ms/step - loss: 4.9951 - accuracy: 0.3691
Epoch 10/40
381/381 [==============================] - 2s 4ms/step - loss: 4.9456 - accuracy: 0.3679
Epoch 11/40
381/381 [==============================] - 1s 4ms/step - loss: 4.9219 - accuracy: 0.3933
Epoch 12/40
381/381 [==============================] - 1s 4ms/step - loss: 4.8899 - accuracy: 0.3991
Epoch 13/40
381/381 [==============================] - 2s 4ms/step - loss: 4.8642 - accuracy: 0.4046
Epoch 14/40
381/381 [==============================] - 1s 4ms/step - loss: 4.8373 - accuracy: 0.4015
Epoch 15/40
381/381 [==============================] - 1s 4ms/step - loss: 4.7995 - accuracy: 0.4028
Epoch 16/40
381/381 [==============================] - 2s 4ms/step - loss: 4.7874 - accuracy: 0.3927
Epoch 17/40
381/381 [==============================] - 1s 4ms/step - loss: 4.7666 - accuracy: 0.3975
Epoch 18/40
381/381 [==============================] - 1s 4ms/step - loss: 4.7398 - accuracy: 0.4047
Epoch 19/40
381/381 [==============================] - 1s 4ms/step - loss: 4.7381 - accuracy: 0.3858
Epoch 20/40
381/381 [==============================] - 2s 4ms/step - loss: 4.7007 - accuracy: 0.4002
Epoch 21/40
381/381 [==============================] - 1s 4ms/step - loss: 4.6746 - accuracy: 0.3832
Epoch 22/40
381/381 [==============================] - 1s 4ms/step - loss: 4.6605 - accuracy: 0.4033
Epoch 23/40
381/381 [==============================] - 2s 4ms/step - loss: 4.6497 - accuracy: 0.3920
Epoch 24/40
381/381 [==============================] - 1s 4ms/step - loss: 4.6304 - accuracy: 0.3976
Epoch 25/40
381/381 [==============================] - 1s 4ms/step - loss: 4.6029 - accuracy: 0.4068
Epoch 26/40
381/381 [==============================] - 1s 4ms/step - loss: 4.5943 - accuracy: 0.4060
Epoch 27/40
381/381 [==============================] - 2s 4ms/step - loss: 4.5696 - accuracy: 0.4041
Epoch 28/40
381/381 [==============================] - 1s 4ms/step - loss: 4.5630 - accuracy: 0.4099
Epoch 29/40
381/381 [==============================] - 1s 4ms/step - loss: 4.5354 - accuracy: 0.4172
Epoch 30/40
381/381 [==============================] - 2s 4ms/step - loss: 4.5262 - accuracy: 0.4081
Epoch 31/40
381/381 [==============================] - 1s 4ms/step - loss: 4.5209 - accuracy: 0.4163
Epoch 32/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4950 - accuracy: 0.4113
Epoch 33/40
381/381 [==============================] - 2s 4ms/step - loss: 4.4990 - accuracy: 0.4184
Epoch 34/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4829 - accuracy: 0.4219
Epoch 35/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4868 - accuracy: 0.4161
Epoch 36/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4613 - accuracy: 0.4223
Epoch 37/40
381/381 [==============================] - 2s 4ms/step - loss: 4.4560 - accuracy: 0.4287
Epoch 38/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4493 - accuracy: 0.4206
Epoch 39/40
381/381 [==============================] - 1s 4ms/step - loss: 4.4512 - accuracy: 0.4215
Epoch 40/40
381/381 [==============================] - 2s 4ms/step - loss: 4.4325 - accuracy: 0.4342
96/96 [==============================] - 0s 2ms/step - loss: 1.1908 - accuracy: 0.3546


For 31: Test ACC=[1.1908047199249268, 0.35457155108451843]
Confusion Matrix
[[1792 1177 1911 1932]
 [ 617 1809  562  972]
 [ 187  162  643  315]
 [   7   13   16   80]]
Classification Report
              precision    recall  f1-score   support

           0       0.69      0.26      0.38      6812
           1       0.57      0.46      0.51      3960
           2       0.21      0.49      0.29      1307
           3       0.02      0.69      0.05       116

    accuracy                           0.35     12195
   macro avg       0.37      0.48      0.31     12195
weighted avg       0.59      0.35      0.41     12195

trainingshape 32
(36088, 7)
(36088, 7, 1)
testingshape 32
(9024, 7)
(9024, 7, 1)
nb occurences
Counter({0: 22150, 1: 10231, 2: 3491, 3: 216})
weights={0: 1.629255079006772, 1: 3.5273189326556547, 2: 10.337439129189343, 3: 167.07407407407408}
Model: "sequential_27"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_54 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_55 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_27 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_27 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
282/282 [==============================] - 2s 6ms/step - loss: 5.5179 - accuracy: 0.3696
Epoch 2/40
282/282 [==============================] - 2s 6ms/step - loss: 5.3176 - accuracy: 0.4100
Epoch 3/40
282/282 [==============================] - 2s 6ms/step - loss: 5.1638 - accuracy: 0.3825
Epoch 4/40
282/282 [==============================] - 2s 6ms/step - loss: 5.0469 - accuracy: 0.3927
Epoch 5/40
282/282 [==============================] - 2s 6ms/step - loss: 4.9538 - accuracy: 0.3952
Epoch 6/40
282/282 [==============================] - 2s 6ms/step - loss: 4.8940 - accuracy: 0.3815
Epoch 7/40
282/282 [==============================] - 2s 6ms/step - loss: 4.8441 - accuracy: 0.3997
Epoch 8/40
282/282 [==============================] - 2s 6ms/step - loss: 4.8072 - accuracy: 0.4034
Epoch 9/40
282/282 [==============================] - 2s 6ms/step - loss: 4.7640 - accuracy: 0.4278
Epoch 10/40
282/282 [==============================] - 2s 6ms/step - loss: 4.7300 - accuracy: 0.4367
Epoch 11/40
282/282 [==============================] - 2s 6ms/step - loss: 4.7053 - accuracy: 0.4364
Epoch 12/40
282/282 [==============================] - 2s 6ms/step - loss: 4.6844 - accuracy: 0.4436
Epoch 13/40
282/282 [==============================] - 2s 6ms/step - loss: 4.6538 - accuracy: 0.4614
Epoch 14/40
282/282 [==============================] - 2s 6ms/step - loss: 4.6418 - accuracy: 0.4425
Epoch 15/40
282/282 [==============================] - 2s 6ms/step - loss: 4.6260 - accuracy: 0.4591
Epoch 16/40
282/282 [==============================] - 2s 6ms/step - loss: 4.5973 - accuracy: 0.4595
Epoch 17/40
282/282 [==============================] - 2s 6ms/step - loss: 4.5747 - accuracy: 0.4746
Epoch 18/40
282/282 [==============================] - 2s 6ms/step - loss: 4.5607 - accuracy: 0.4711
Epoch 19/40
282/282 [==============================] - 2s 6ms/step - loss: 4.5393 - accuracy: 0.4700
Epoch 20/40
282/282 [==============================] - 2s 6ms/step - loss: 4.5134 - accuracy: 0.4773
Epoch 21/40
282/282 [==============================] - 2s 6ms/step - loss: 4.4976 - accuracy: 0.4825
Epoch 22/40
282/282 [==============================] - 2s 6ms/step - loss: 4.4547 - accuracy: 0.4893
Epoch 23/40
282/282 [==============================] - 2s 6ms/step - loss: 4.4342 - accuracy: 0.4985
Epoch 24/40
282/282 [==============================] - 2s 6ms/step - loss: 4.3950 - accuracy: 0.5168
Epoch 25/40
282/282 [==============================] - 2s 6ms/step - loss: 4.3662 - accuracy: 0.5171
Epoch 26/40
282/282 [==============================] - 2s 6ms/step - loss: 4.3284 - accuracy: 0.5260
Epoch 27/40
282/282 [==============================] - 2s 6ms/step - loss: 4.2810 - accuracy: 0.5368
Epoch 28/40
282/282 [==============================] - 2s 6ms/step - loss: 4.2505 - accuracy: 0.5377
Epoch 29/40
282/282 [==============================] - 2s 6ms/step - loss: 4.2107 - accuracy: 0.5461
Epoch 30/40
282/282 [==============================] - 2s 6ms/step - loss: 4.1686 - accuracy: 0.5535
Epoch 31/40
282/282 [==============================] - 2s 6ms/step - loss: 4.1580 - accuracy: 0.5459
Epoch 32/40
282/282 [==============================] - 2s 6ms/step - loss: 4.1131 - accuracy: 0.5576
Epoch 33/40
282/282 [==============================] - 2s 6ms/step - loss: 4.1092 - accuracy: 0.5538
Epoch 34/40
282/282 [==============================] - 2s 6ms/step - loss: 4.0790 - accuracy: 0.5588
Epoch 35/40
282/282 [==============================] - 2s 6ms/step - loss: 4.0507 - accuracy: 0.5633
Epoch 36/40
282/282 [==============================] - 2s 6ms/step - loss: 4.0254 - accuracy: 0.5666
Epoch 37/40
282/282 [==============================] - 2s 6ms/step - loss: 4.0259 - accuracy: 0.5665
Epoch 38/40
282/282 [==============================] - 2s 6ms/step - loss: 4.0022 - accuracy: 0.5676
Epoch 39/40
282/282 [==============================] - 2s 6ms/step - loss: 3.9925 - accuracy: 0.5679
Epoch 40/40
282/282 [==============================] - 2s 6ms/step - loss: 3.9722 - accuracy: 0.5670
71/71 [==============================] - 0s 2ms/step - loss: 1.0901 - accuracy: 0.5403


For 32: Test ACC=[1.0900518894195557, 0.5403369069099426]
Confusion Matrix
[[2864 1289 1045  340]
 [ 334 1519  609   96]
 [  74  300  457   42]
 [   1    4   14   36]]
Classification Report
              precision    recall  f1-score   support

           0       0.88      0.52      0.65      5538
           1       0.49      0.59      0.54      2558
           2       0.22      0.52      0.30       873
           3       0.07      0.65      0.13        55

    accuracy                           0.54      9024
   macro avg       0.41      0.57      0.40      9024
weighted avg       0.70      0.54      0.58      9024

trainingshape 33
(17950, 7)
(17950, 7, 1)
testingshape 33
(4489, 7)
(4489, 7, 1)
nb occurences
Counter({0: 11318, 1: 5432, 2: 1200})
weights={0: 1.5859692525181128, 1: 3.3044918998527244, 2: 14.958333333333334}
Model: "sequential_28"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_56 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_57 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_28 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_28 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
141/141 [==============================] - 1s 6ms/step - loss: 3.2656 - accuracy: 0.3670
Epoch 2/40
141/141 [==============================] - 1s 6ms/step - loss: 3.1062 - accuracy: 0.4587
Epoch 3/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9958 - accuracy: 0.4626
Epoch 4/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9657 - accuracy: 0.5018
Epoch 5/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9525 - accuracy: 0.4963
Epoch 6/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9347 - accuracy: 0.4943
Epoch 7/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9315 - accuracy: 0.4603
Epoch 8/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9205 - accuracy: 0.4731
Epoch 9/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9175 - accuracy: 0.4747
Epoch 10/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9117 - accuracy: 0.4869
Epoch 11/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9095 - accuracy: 0.4782
Epoch 12/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9040 - accuracy: 0.4874
Epoch 13/40
141/141 [==============================] - 1s 6ms/step - loss: 2.9021 - accuracy: 0.4755
Epoch 14/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8991 - accuracy: 0.4900
Epoch 15/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8955 - accuracy: 0.4938
Epoch 16/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8932 - accuracy: 0.4630
Epoch 17/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8902 - accuracy: 0.5110
Epoch 18/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8900 - accuracy: 0.4772
Epoch 19/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8889 - accuracy: 0.4770
Epoch 20/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8865 - accuracy: 0.4732
Epoch 21/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8815 - accuracy: 0.5052
Epoch 22/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8804 - accuracy: 0.4850
Epoch 23/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8737 - accuracy: 0.4939
Epoch 24/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8798 - accuracy: 0.4835
Epoch 25/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8719 - accuracy: 0.4904
Epoch 26/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8716 - accuracy: 0.4860
Epoch 27/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8691 - accuracy: 0.4987
Epoch 28/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8676 - accuracy: 0.4821
Epoch 29/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8745 - accuracy: 0.5009
Epoch 30/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8647 - accuracy: 0.4814
Epoch 31/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8610 - accuracy: 0.4836
Epoch 32/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8588 - accuracy: 0.4754
Epoch 33/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8611 - accuracy: 0.4935
Epoch 34/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8583 - accuracy: 0.4923
Epoch 35/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8542 - accuracy: 0.4856
Epoch 36/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8523 - accuracy: 0.5039
Epoch 37/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8467 - accuracy: 0.4825
Epoch 38/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8465 - accuracy: 0.4925
Epoch 39/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8482 - accuracy: 0.4945
Epoch 40/40
141/141 [==============================] - 1s 6ms/step - loss: 2.8420 - accuracy: 0.4642
36/36 [==============================] - 0s 2ms/step - loss: 0.9270 - accuracy: 0.5366


For 33: Test ACC=[0.9269681572914124, 0.5366451144218445]
Confusion Matrix
[[1456  771  603]
 [ 335  825  199]
 [  92   80  128]]
Classification Report
              precision    recall  f1-score   support

           0       0.77      0.51      0.62      2830
           1       0.49      0.61      0.54      1359
           2       0.14      0.43      0.21       300

    accuracy                           0.54      4489
   macro avg       0.47      0.52      0.46      4489
weighted avg       0.65      0.54      0.57      4489

trainingshape 34
(39836, 7)
(39836, 7, 1)
testingshape 34
(9960, 7)
(9960, 7, 1)
nb occurences
Counter({0: 24622, 1: 12820, 2: 2394})
weights={0: 1.6179026886524246, 1: 3.1073322932917318, 2: 16.639933166248955}
Model: "sequential_29"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_58 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_59 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_29 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_29 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
312/312 [==============================] - 2s 6ms/step - loss: 2.9587 - accuracy: 0.5569
Epoch 2/40
312/312 [==============================] - 2s 6ms/step - loss: 2.6380 - accuracy: 0.6388
Epoch 3/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5707 - accuracy: 0.6491
Epoch 4/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5530 - accuracy: 0.6505
Epoch 5/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5391 - accuracy: 0.6487
Epoch 6/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5282 - accuracy: 0.6473
Epoch 7/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5174 - accuracy: 0.6461
Epoch 8/40
312/312 [==============================] - 2s 6ms/step - loss: 2.5097 - accuracy: 0.6430
Epoch 9/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4994 - accuracy: 0.6438
Epoch 10/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4905 - accuracy: 0.6435
Epoch 11/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4799 - accuracy: 0.6396
Epoch 12/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4725 - accuracy: 0.6368
Epoch 13/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4578 - accuracy: 0.6420
Epoch 14/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4464 - accuracy: 0.6361
Epoch 15/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4329 - accuracy: 0.6334
Epoch 16/40
312/312 [==============================] - 2s 6ms/step - loss: 2.4124 - accuracy: 0.6375
Epoch 17/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3973 - accuracy: 0.6346
Epoch 18/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3836 - accuracy: 0.6399
Epoch 19/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3708 - accuracy: 0.6351
Epoch 20/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3582 - accuracy: 0.6394
Epoch 21/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3436 - accuracy: 0.6432
Epoch 22/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3322 - accuracy: 0.6446
Epoch 23/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3159 - accuracy: 0.6471
Epoch 24/40
312/312 [==============================] - 2s 6ms/step - loss: 2.3201 - accuracy: 0.6483
Epoch 25/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2957 - accuracy: 0.6505
Epoch 26/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2915 - accuracy: 0.6537
Epoch 27/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2788 - accuracy: 0.6555
Epoch 28/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2728 - accuracy: 0.6613
Epoch 29/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2609 - accuracy: 0.6643
Epoch 30/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2544 - accuracy: 0.6689
Epoch 31/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2429 - accuracy: 0.6721
Epoch 32/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2365 - accuracy: 0.6738
Epoch 33/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2221 - accuracy: 0.6762
Epoch 34/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2219 - accuracy: 0.6798
Epoch 35/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2200 - accuracy: 0.6801
Epoch 36/40
312/312 [==============================] - 2s 6ms/step - loss: 2.2019 - accuracy: 0.6875
Epoch 37/40
312/312 [==============================] - 2s 6ms/step - loss: 2.1965 - accuracy: 0.6874
Epoch 38/40
312/312 [==============================] - 2s 6ms/step - loss: 2.1910 - accuracy: 0.6908
Epoch 39/40
312/312 [==============================] - 2s 6ms/step - loss: 2.1804 - accuracy: 0.6928
Epoch 40/40
312/312 [==============================] - 2s 6ms/step - loss: 2.1821 - accuracy: 0.6925
78/78 [==============================] - 0s 2ms/step - loss: 0.6920 - accuracy: 0.7117


For 34: Test ACC=[0.6919869184494019, 0.7117469906806946]
Confusion Matrix
[[4624  148 1384]
 [ 571 2016  618]
 [ 124   26  449]]
Classification Report
              precision    recall  f1-score   support

           0       0.87      0.75      0.81      6156
           1       0.92      0.63      0.75      3205
           2       0.18      0.75      0.29       599

    accuracy                           0.71      9960
   macro avg       0.66      0.71      0.62      9960
weighted avg       0.84      0.71      0.76      9960

trainingshape 35
(11204, 7)
(11204, 7, 1)
testingshape 35
(2802, 7)
(2802, 7, 1)
nb occurences
Counter({0: 8019, 1: 2636, 2: 549})
weights={0: 1.39718169347799, 1: 4.250379362670714, 2: 20.408014571949}
Model: "sequential_30"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_60 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_61 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_30 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_30 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
88/88 [==============================] - 1s 7ms/step - loss: 3.3096 - accuracy: 0.4198
Epoch 2/40
88/88 [==============================] - 1s 6ms/step - loss: 3.2506 - accuracy: 0.5487
Epoch 3/40
88/88 [==============================] - 1s 6ms/step - loss: 3.1908 - accuracy: 0.4406
Epoch 4/40
88/88 [==============================] - 0s 6ms/step - loss: 3.1157 - accuracy: 0.5468
Epoch 5/40
88/88 [==============================] - 0s 6ms/step - loss: 3.0496 - accuracy: 0.4106
Epoch 6/40
88/88 [==============================] - 0s 5ms/step - loss: 3.0137 - accuracy: 0.3545
Epoch 7/40
88/88 [==============================] - 0s 5ms/step - loss: 2.9941 - accuracy: 0.3387
Epoch 8/40
88/88 [==============================] - 0s 6ms/step - loss: 2.9794 - accuracy: 0.3576
Epoch 9/40
88/88 [==============================] - 0s 6ms/step - loss: 2.9575 - accuracy: 0.3358
Epoch 10/40
88/88 [==============================] - 0s 5ms/step - loss: 2.9474 - accuracy: 0.3476
Epoch 11/40
88/88 [==============================] - 1s 7ms/step - loss: 2.9377 - accuracy: 0.3499
Epoch 12/40
88/88 [==============================] - 1s 6ms/step - loss: 2.9252 - accuracy: 0.3428
Epoch 13/40
88/88 [==============================] - 1s 6ms/step - loss: 2.9173 - accuracy: 0.3365
Epoch 14/40
88/88 [==============================] - 0s 5ms/step - loss: 2.9102 - accuracy: 0.3866
Epoch 15/40
88/88 [==============================] - 1s 6ms/step - loss: 2.9009 - accuracy: 0.4001
Epoch 16/40
88/88 [==============================] - 1s 9ms/step - loss: 2.8958 - accuracy: 0.3451
Epoch 17/40
88/88 [==============================] - 1s 7ms/step - loss: 2.8880 - accuracy: 0.3982
Epoch 18/40
88/88 [==============================] - 1s 6ms/step - loss: 2.8778 - accuracy: 0.3476
Epoch 19/40
88/88 [==============================] - 0s 6ms/step - loss: 2.8694 - accuracy: 0.4277
Epoch 20/40
88/88 [==============================] - 1s 7ms/step - loss: 2.8606 - accuracy: 0.3921
Epoch 21/40
88/88 [==============================] - 0s 6ms/step - loss: 2.8492 - accuracy: 0.4560
Epoch 22/40
88/88 [==============================] - 1s 6ms/step - loss: 2.8439 - accuracy: 0.4853
Epoch 23/40
88/88 [==============================] - 0s 5ms/step - loss: 2.8262 - accuracy: 0.4582
Epoch 24/40
88/88 [==============================] - 1s 6ms/step - loss: 2.8064 - accuracy: 0.5365
Epoch 25/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7966 - accuracy: 0.5463
Epoch 26/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7777 - accuracy: 0.5632
Epoch 27/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7750 - accuracy: 0.5611
Epoch 28/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7604 - accuracy: 0.5718
Epoch 29/40
88/88 [==============================] - 0s 5ms/step - loss: 2.7545 - accuracy: 0.5717
Epoch 30/40
88/88 [==============================] - 1s 7ms/step - loss: 2.7435 - accuracy: 0.5798
Epoch 31/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7325 - accuracy: 0.5793
Epoch 32/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7299 - accuracy: 0.5819
Epoch 33/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7173 - accuracy: 0.5842
Epoch 34/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7199 - accuracy: 0.5840
Epoch 35/40
88/88 [==============================] - 0s 6ms/step - loss: 2.7029 - accuracy: 0.5895
Epoch 36/40
88/88 [==============================] - 0s 5ms/step - loss: 2.7026 - accuracy: 0.5849
Epoch 37/40
88/88 [==============================] - 0s 5ms/step - loss: 2.6981 - accuracy: 0.5893
Epoch 38/40
88/88 [==============================] - 0s 6ms/step - loss: 2.6785 - accuracy: 0.5979
Epoch 39/40
88/88 [==============================] - 0s 6ms/step - loss: 2.6834 - accuracy: 0.5838
Epoch 40/40
88/88 [==============================] - 1s 7ms/step - loss: 2.6725 - accuracy: 0.5901
22/22 [==============================] - 0s 2ms/step - loss: 0.7637 - accuracy: 0.7120


For 35: Test ACC=[0.7636809945106506, 0.7119914293289185]
Confusion Matrix
[[1598  204  203]
 [ 219  360   80]
 [  71   30   37]]
Classification Report
              precision    recall  f1-score   support

           0       0.85      0.80      0.82      2005
           1       0.61      0.55      0.57       659
           2       0.12      0.27      0.16       138

    accuracy                           0.71      2802
   macro avg       0.52      0.54      0.52      2802
weighted avg       0.75      0.71      0.73      2802

trainingshape 36
(32911, 7)
(32911, 7, 1)
testingshape 36
(8229, 7)
(8229, 7, 1)
nb occurences
Counter({0: 24052, 1: 7912, 2: 947})
weights={0: 1.3683269582571096, 1: 4.1596309403437814, 2: 34.75290390707497}
Model: "sequential_31"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_62 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_63 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_31 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_31 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
258/258 [==============================] - 2s 6ms/step - loss: 3.1861 - accuracy: 0.3868
Epoch 2/40
258/258 [==============================] - 1s 6ms/step - loss: 2.8575 - accuracy: 0.4882
Epoch 3/40
258/258 [==============================] - 1s 5ms/step - loss: 2.7159 - accuracy: 0.5406
Epoch 4/40
258/258 [==============================] - 2s 6ms/step - loss: 2.6788 - accuracy: 0.5449
Epoch 5/40
258/258 [==============================] - 1s 6ms/step - loss: 2.6511 - accuracy: 0.5450
Epoch 6/40
258/258 [==============================] - 2s 6ms/step - loss: 2.6299 - accuracy: 0.5553
Epoch 7/40
258/258 [==============================] - 1s 6ms/step - loss: 2.6135 - accuracy: 0.5479
Epoch 8/40
258/258 [==============================] - 1s 6ms/step - loss: 2.5992 - accuracy: 0.5499
Epoch 9/40
258/258 [==============================] - 1s 5ms/step - loss: 2.5908 - accuracy: 0.5504
Epoch 10/40
258/258 [==============================] - 1s 5ms/step - loss: 2.5750 - accuracy: 0.5567
Epoch 11/40
258/258 [==============================] - 2s 6ms/step - loss: 2.5655 - accuracy: 0.5605
Epoch 12/40
258/258 [==============================] - 1s 6ms/step - loss: 2.5534 - accuracy: 0.5621
Epoch 13/40
258/258 [==============================] - 2s 6ms/step - loss: 2.5397 - accuracy: 0.5648
Epoch 14/40
258/258 [==============================] - 2s 6ms/step - loss: 2.5317 - accuracy: 0.5766
Epoch 15/40
258/258 [==============================] - 1s 5ms/step - loss: 2.5045 - accuracy: 0.5763
Epoch 16/40
258/258 [==============================] - 1s 5ms/step - loss: 2.4259 - accuracy: 0.6056
Epoch 17/40
258/258 [==============================] - 2s 6ms/step - loss: 2.3192 - accuracy: 0.6404
Epoch 18/40
258/258 [==============================] - 1s 6ms/step - loss: 2.2733 - accuracy: 0.6481
Epoch 19/40
258/258 [==============================] - 1s 6ms/step - loss: 2.2240 - accuracy: 0.6607
Epoch 20/40
258/258 [==============================] - 1s 5ms/step - loss: 2.1941 - accuracy: 0.6629
Epoch 21/40
258/258 [==============================] - 2s 6ms/step - loss: 2.1697 - accuracy: 0.6659
Epoch 22/40
258/258 [==============================] - 1s 5ms/step - loss: 2.1553 - accuracy: 0.6668
Epoch 23/40
258/258 [==============================] - 1s 5ms/step - loss: 2.1456 - accuracy: 0.6659
Epoch 24/40
258/258 [==============================] - 2s 6ms/step - loss: 2.1214 - accuracy: 0.6710
Epoch 25/40
258/258 [==============================] - 1s 6ms/step - loss: 2.1314 - accuracy: 0.6657
Epoch 26/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0914 - accuracy: 0.6735
Epoch 27/40
258/258 [==============================] - 1s 5ms/step - loss: 2.1057 - accuracy: 0.6712
Epoch 28/40
258/258 [==============================] - 2s 6ms/step - loss: 2.0915 - accuracy: 0.6734
Epoch 29/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0750 - accuracy: 0.6752
Epoch 30/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0736 - accuracy: 0.6742
Epoch 31/40
258/258 [==============================] - 2s 6ms/step - loss: 2.0643 - accuracy: 0.6777
Epoch 32/40
258/258 [==============================] - 1s 5ms/step - loss: 2.0475 - accuracy: 0.6781
Epoch 33/40
258/258 [==============================] - 1s 5ms/step - loss: 2.0467 - accuracy: 0.6771
Epoch 34/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0404 - accuracy: 0.6806
Epoch 35/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0266 - accuracy: 0.6811
Epoch 36/40
258/258 [==============================] - 1s 5ms/step - loss: 2.0279 - accuracy: 0.6829
Epoch 37/40
258/258 [==============================] - 1s 5ms/step - loss: 2.0144 - accuracy: 0.6841
Epoch 38/40
258/258 [==============================] - 2s 6ms/step - loss: 2.0202 - accuracy: 0.6808
Epoch 39/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0385 - accuracy: 0.6826
Epoch 40/40
258/258 [==============================] - 1s 6ms/step - loss: 2.0082 - accuracy: 0.6848
65/65 [==============================] - 0s 2ms/step - loss: 0.6286 - accuracy: 0.6966


For 36: Test ACC=[0.628571629524231, 0.6965609192848206]
Confusion Matrix
[[3989 1906  119]
 [ 248 1603  127]
 [  19   78  140]]
Classification Report
              precision    recall  f1-score   support

           0       0.94      0.66      0.78      6014
           1       0.45      0.81      0.58      1978
           2       0.36      0.59      0.45       237

    accuracy                           0.70      8229
   macro avg       0.58      0.69      0.60      8229
weighted avg       0.80      0.70      0.72      8229

trainingshape 37
(13030, 7)
(13030, 7, 1)
testingshape 37
(3259, 7)
(3259, 7, 1)
nb occurences
Counter({0: 10200, 1: 2629, 2: 201})
weights={0: 1.2774509803921568, 1: 4.95625713198935, 2: 64.82587064676616}
Model: "sequential_32"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_64 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_65 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_32 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_32 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
102/102 [==============================] - 1s 7ms/step - loss: 3.2814 - accuracy: 0.2332
Epoch 2/40
102/102 [==============================] - 1s 6ms/step - loss: 3.2618 - accuracy: 0.3850
Epoch 3/40
102/102 [==============================] - 1s 6ms/step - loss: 3.2469 - accuracy: 0.3602
Epoch 4/40
102/102 [==============================] - 1s 6ms/step - loss: 3.2284 - accuracy: 0.2917
Epoch 5/40
102/102 [==============================] - 1s 6ms/step - loss: 3.2093 - accuracy: 0.1937
Epoch 6/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1996 - accuracy: 0.3070
Epoch 7/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1878 - accuracy: 0.2396
Epoch 8/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1788 - accuracy: 0.2787
Epoch 9/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1579 - accuracy: 0.2666
Epoch 10/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1389 - accuracy: 0.3444
Epoch 11/40
102/102 [==============================] - 1s 6ms/step - loss: 3.1079 - accuracy: 0.3973
Epoch 12/40
102/102 [==============================] - 1s 6ms/step - loss: 3.0632 - accuracy: 0.2777
Epoch 13/40
102/102 [==============================] - 1s 6ms/step - loss: 2.9758 - accuracy: 0.3786
Epoch 14/40
102/102 [==============================] - 1s 6ms/step - loss: 2.9061 - accuracy: 0.3684
Epoch 15/40
102/102 [==============================] - 1s 6ms/step - loss: 2.8784 - accuracy: 0.3646
Epoch 16/40
102/102 [==============================] - 1s 6ms/step - loss: 2.8708 - accuracy: 0.3824
Epoch 17/40
102/102 [==============================] - 1s 6ms/step - loss: 2.8587 - accuracy: 0.3886
Epoch 18/40
102/102 [==============================] - 1s 7ms/step - loss: 2.8107 - accuracy: 0.3570
Epoch 19/40
102/102 [==============================] - 1s 6ms/step - loss: 2.8089 - accuracy: 0.3790
Epoch 20/40
102/102 [==============================] - 1s 6ms/step - loss: 2.8149 - accuracy: 0.3903
Epoch 21/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7757 - accuracy: 0.3589
Epoch 22/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7604 - accuracy: 0.4045
Epoch 23/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7475 - accuracy: 0.3976
Epoch 24/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7405 - accuracy: 0.3595
Epoch 25/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7620 - accuracy: 0.4069
Epoch 26/40
102/102 [==============================] - 1s 7ms/step - loss: 2.7500 - accuracy: 0.4064
Epoch 27/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7197 - accuracy: 0.3837
Epoch 28/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7067 - accuracy: 0.3586
Epoch 29/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7192 - accuracy: 0.3959
Epoch 30/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7056 - accuracy: 0.4278
Epoch 31/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7135 - accuracy: 0.3586
Epoch 32/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7065 - accuracy: 0.4245
Epoch 33/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6887 - accuracy: 0.4123
Epoch 34/40
102/102 [==============================] - 1s 6ms/step - loss: 2.7155 - accuracy: 0.3664
Epoch 35/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6804 - accuracy: 0.4501
Epoch 36/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6674 - accuracy: 0.4037
Epoch 37/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6748 - accuracy: 0.3970
Epoch 38/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6608 - accuracy: 0.3996
Epoch 39/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6584 - accuracy: 0.4101
Epoch 40/40
102/102 [==============================] - 1s 6ms/step - loss: 2.6627 - accuracy: 0.4467
26/26 [==============================] - 0s 2ms/step - loss: 0.9394 - accuracy: 0.3808


For 37: Test ACC=[0.9394041895866394, 0.38079166412353516]
Confusion Matrix
[[ 787  467 1296]
 [  88  423  147]
 [   7   13   31]]
Classification Report
              precision    recall  f1-score   support

           0       0.89      0.31      0.46      2550
           1       0.47      0.64      0.54       658
           2       0.02      0.61      0.04        51

    accuracy                           0.38      3259
   macro avg       0.46      0.52      0.35      3259
weighted avg       0.79      0.38      0.47      3259

trainingshape 38
(14172, 7)
(14172, 7, 1)
testingshape 38
(3545, 7)
(3545, 7, 1)
nb occurences
Counter({0: 11651, 1: 2344, 2: 177})
weights={0: 1.216376276714445, 1: 6.046075085324232, 2: 80.0677966101695}
Model: "sequential_33"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_66 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_67 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_33 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_33 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
111/111 [==============================] - 1s 6ms/step - loss: 3.3178 - accuracy: 0.4994
Epoch 2/40
111/111 [==============================] - 1s 6ms/step - loss: 3.2728 - accuracy: 0.2050
Epoch 3/40
111/111 [==============================] - 1s 6ms/step - loss: 3.1728 - accuracy: 0.3042
Epoch 4/40
111/111 [==============================] - 1s 6ms/step - loss: 3.0259 - accuracy: 0.5852
Epoch 5/40
111/111 [==============================] - 1s 6ms/step - loss: 2.9520 - accuracy: 0.5634
Epoch 6/40
111/111 [==============================] - 1s 6ms/step - loss: 2.9428 - accuracy: 0.5029
Epoch 7/40
111/111 [==============================] - 1s 7ms/step - loss: 2.9122 - accuracy: 0.4437
Epoch 8/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8966 - accuracy: 0.5234
Epoch 9/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8820 - accuracy: 0.5449
Epoch 10/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8692 - accuracy: 0.4995
Epoch 11/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8626 - accuracy: 0.5399
Epoch 12/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8387 - accuracy: 0.5212
Epoch 13/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8204 - accuracy: 0.5246
Epoch 14/40
111/111 [==============================] - 1s 6ms/step - loss: 2.8013 - accuracy: 0.5193
Epoch 15/40
111/111 [==============================] - 1s 6ms/step - loss: 2.7964 - accuracy: 0.5465
Epoch 16/40
111/111 [==============================] - 1s 6ms/step - loss: 2.7641 - accuracy: 0.5417
Epoch 17/40
111/111 [==============================] - 1s 6ms/step - loss: 2.7052 - accuracy: 0.5075
Epoch 18/40
111/111 [==============================] - 1s 6ms/step - loss: 2.6699 - accuracy: 0.5294
Epoch 19/40
111/111 [==============================] - 1s 6ms/step - loss: 2.6263 - accuracy: 0.5386
Epoch 20/40
111/111 [==============================] - 1s 6ms/step - loss: 2.5910 - accuracy: 0.5456
Epoch 21/40
111/111 [==============================] - 1s 6ms/step - loss: 2.5686 - accuracy: 0.5435
Epoch 22/40
111/111 [==============================] - 1s 7ms/step - loss: 2.5169 - accuracy: 0.5514
Epoch 23/40
111/111 [==============================] - 1s 6ms/step - loss: 2.5073 - accuracy: 0.5642
Epoch 24/40
111/111 [==============================] - 1s 6ms/step - loss: 2.4947 - accuracy: 0.5616
Epoch 25/40
111/111 [==============================] - 1s 6ms/step - loss: 2.4420 - accuracy: 0.5809
Epoch 26/40
111/111 [==============================] - 1s 6ms/step - loss: 2.4246 - accuracy: 0.5953
Epoch 27/40
111/111 [==============================] - 1s 6ms/step - loss: 2.4114 - accuracy: 0.6081
Epoch 28/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3877 - accuracy: 0.5999
Epoch 29/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3952 - accuracy: 0.6015
Epoch 30/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3770 - accuracy: 0.6192
Epoch 31/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3615 - accuracy: 0.6068
Epoch 32/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3256 - accuracy: 0.6372
Epoch 33/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3302 - accuracy: 0.6245
Epoch 34/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3137 - accuracy: 0.6207
Epoch 35/40
111/111 [==============================] - 1s 6ms/step - loss: 2.3111 - accuracy: 0.6349
Epoch 36/40
111/111 [==============================] - 1s 6ms/step - loss: 2.2750 - accuracy: 0.6355
Epoch 37/40
111/111 [==============================] - 1s 7ms/step - loss: 2.2781 - accuracy: 0.6407
Epoch 38/40
111/111 [==============================] - 1s 6ms/step - loss: 2.2829 - accuracy: 0.6420
Epoch 39/40
111/111 [==============================] - 1s 6ms/step - loss: 2.2509 - accuracy: 0.6505
Epoch 40/40
111/111 [==============================] - 1s 6ms/step - loss: 2.2476 - accuracy: 0.6621
28/28 [==============================] - 0s 2ms/step - loss: 0.8141 - accuracy: 0.5989


For 38: Test ACC=[0.8140676021575928, 0.598871648311615]
Confusion Matrix
[[1719  614  580]
 [  65  370  152]
 [   2    9   34]]
Classification Report
              precision    recall  f1-score   support

           0       0.96      0.59      0.73      2913
           1       0.37      0.63      0.47       587
           2       0.04      0.76      0.08        45

    accuracy                           0.60      3545
   macro avg       0.46      0.66      0.43      3545
weighted avg       0.85      0.60      0.68      3545

trainingshape 39
(19534, 7)
(19534, 7, 1)
testingshape 39
(4885, 7)
(4885, 7, 1)
nb occurences
Counter({0: 17090, 1: 2444})
weights={0: 1.1430076067875952, 1: 7.9926350245499185}
Model: "sequential_34"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_68 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_69 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_34 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_34 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
153/153 [==============================] - 1s 6ms/step - loss: 1.3501 - accuracy: 0.5551
Epoch 2/40
153/153 [==============================] - 1s 6ms/step - loss: 1.2915 - accuracy: 0.6036
Epoch 3/40
153/153 [==============================] - 1s 6ms/step - loss: 1.2517 - accuracy: 0.5867
Epoch 4/40
153/153 [==============================] - 1s 6ms/step - loss: 1.2246 - accuracy: 0.5837
Epoch 5/40
153/153 [==============================] - 1s 6ms/step - loss: 1.2053 - accuracy: 0.5832
Epoch 6/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1973 - accuracy: 0.5858
Epoch 7/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1841 - accuracy: 0.5842
Epoch 8/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1804 - accuracy: 0.5833
Epoch 9/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1751 - accuracy: 0.5873
Epoch 10/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1711 - accuracy: 0.5750
Epoch 11/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1657 - accuracy: 0.5770
Epoch 12/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1655 - accuracy: 0.5897
Epoch 13/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1628 - accuracy: 0.5826
Epoch 14/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1590 - accuracy: 0.5852
Epoch 15/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1632 - accuracy: 0.5929
Epoch 16/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1601 - accuracy: 0.5808
Epoch 17/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1559 - accuracy: 0.5865
Epoch 18/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1582 - accuracy: 0.5910
Epoch 19/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1580 - accuracy: 0.5860
Epoch 20/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1564 - accuracy: 0.5877
Epoch 21/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1539 - accuracy: 0.5873
Epoch 22/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1504 - accuracy: 0.5925
Epoch 23/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1452 - accuracy: 0.5913
Epoch 24/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1449 - accuracy: 0.5891
Epoch 25/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1426 - accuracy: 0.6053
Epoch 26/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1396 - accuracy: 0.5898
Epoch 27/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1417 - accuracy: 0.6016
Epoch 28/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1344 - accuracy: 0.6038
Epoch 29/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1332 - accuracy: 0.6103
Epoch 30/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1247 - accuracy: 0.6206
Epoch 31/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1248 - accuracy: 0.6398
Epoch 32/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1184 - accuracy: 0.6419
Epoch 33/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1108 - accuracy: 0.6630
Epoch 34/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1139 - accuracy: 0.6539
Epoch 35/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1082 - accuracy: 0.6672
Epoch 36/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1012 - accuracy: 0.6719
Epoch 37/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1040 - accuracy: 0.6724
Epoch 38/40
153/153 [==============================] - 1s 6ms/step - loss: 1.1001 - accuracy: 0.6703
Epoch 39/40
153/153 [==============================] - 1s 6ms/step - loss: 1.0937 - accuracy: 0.6764
Epoch 40/40
153/153 [==============================] - 1s 6ms/step - loss: 1.0906 - accuracy: 0.6769
39/39 [==============================] - 0s 2ms/step - loss: 0.5923 - accuracy: 0.6354


For 39: Test ACC=[0.5923143625259399, 0.6354145407676697]
Confusion Matrix
[[2587 1686]
 [  95  517]]
Classification Report
              precision    recall  f1-score   support

           0       0.96      0.61      0.74      4273
           1       0.23      0.84      0.37       612

    accuracy                           0.64      4885
   macro avg       0.60      0.73      0.56      4885
weighted avg       0.87      0.64      0.70      4885

trainingshape 40
(5403, 7)
(5403, 7, 1)
testingshape 40
(1352, 7)
(1352, 7, 1)
nb occurences
Counter({0: 4740, 1: 663})
weights={0: 1.139873417721519, 1: 8.149321266968325}
Model: "sequential_35"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_70 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_71 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_35 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_35 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
43/43 [==============================] - 0s 7ms/step - loss: 1.4487 - accuracy: 0.8756
Epoch 2/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3859 - accuracy: 0.6274
Epoch 3/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3862 - accuracy: 0.5060
Epoch 4/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3854 - accuracy: 0.1853
Epoch 5/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3835 - accuracy: 0.2458
Epoch 6/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3820 - accuracy: 0.8579
Epoch 7/40
43/43 [==============================] - 0s 7ms/step - loss: 1.3817 - accuracy: 0.3141
Epoch 8/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3796 - accuracy: 0.3776
Epoch 9/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3786 - accuracy: 0.6280
Epoch 10/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3771 - accuracy: 0.4170
Epoch 11/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3767 - accuracy: 0.4688
Epoch 12/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3742 - accuracy: 0.4414
Epoch 13/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3724 - accuracy: 0.4340
Epoch 14/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3707 - accuracy: 0.4342
Epoch 15/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3696 - accuracy: 0.4351
Epoch 16/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3678 - accuracy: 0.4379
Epoch 17/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3680 - accuracy: 0.4758
Epoch 18/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3662 - accuracy: 0.4388
Epoch 19/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3676 - accuracy: 0.4087
Epoch 20/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3649 - accuracy: 0.4547
Epoch 21/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3645 - accuracy: 0.4153
Epoch 22/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3614 - accuracy: 0.4777
Epoch 23/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3655 - accuracy: 0.4860
Epoch 24/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3626 - accuracy: 0.3902
Epoch 25/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3608 - accuracy: 0.4338
Epoch 26/40
43/43 [==============================] - 0s 7ms/step - loss: 1.3580 - accuracy: 0.4399
Epoch 27/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3583 - accuracy: 0.4481
Epoch 28/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3552 - accuracy: 0.4187
Epoch 29/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3550 - accuracy: 0.4399
Epoch 30/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3567 - accuracy: 0.4201
Epoch 31/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3525 - accuracy: 0.4446
Epoch 32/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3568 - accuracy: 0.3881
Epoch 33/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3555 - accuracy: 0.4762
Epoch 34/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3489 - accuracy: 0.4235
Epoch 35/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3484 - accuracy: 0.4340
Epoch 36/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3492 - accuracy: 0.4246
Epoch 37/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3448 - accuracy: 0.4318
Epoch 38/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3398 - accuracy: 0.4092
Epoch 39/40
43/43 [==============================] - 0s 6ms/step - loss: 1.3245 - accuracy: 0.5043
Epoch 40/40
43/43 [==============================] - 0s 5ms/step - loss: 1.3293 - accuracy: 0.5216
11/11 [==============================] - 0s 2ms/step - loss: 0.6622 - accuracy: 0.5784


For 40: Test ACC=[0.6622006893157959, 0.5784023404121399]
Confusion Matrix
[[670 516]
 [ 54 112]]
Classification Report
              precision    recall  f1-score   support

           0       0.93      0.56      0.70      1186
           1       0.18      0.67      0.28       166

    accuracy                           0.58      1352
   macro avg       0.55      0.62      0.49      1352
weighted avg       0.83      0.58      0.65      1352

trainingshape 41
(12937, 7)
(12937, 7, 1)
testingshape 41
(3236, 7)
(3236, 7, 1)
nb occurences
Counter({0: 11960, 1: 977})
weights={0: 1.0816889632107023, 1: 13.241555783009213}
Model: "sequential_36"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_72 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_73 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_36 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_36 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3731 - accuracy: 0.4559
Epoch 2/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3517 - accuracy: 0.4163
Epoch 3/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3488 - accuracy: 0.4047
Epoch 4/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3478 - accuracy: 0.4253
Epoch 5/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3445 - accuracy: 0.4285
Epoch 6/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3406 - accuracy: 0.4231
Epoch 7/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3387 - accuracy: 0.4439
Epoch 8/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3360 - accuracy: 0.4486
Epoch 9/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3332 - accuracy: 0.4518
Epoch 10/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3328 - accuracy: 0.4465
Epoch 11/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3261 - accuracy: 0.4671
Epoch 12/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3232 - accuracy: 0.4854
Epoch 13/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3191 - accuracy: 0.4895
Epoch 14/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3171 - accuracy: 0.4685
Epoch 15/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3143 - accuracy: 0.4851
Epoch 16/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3140 - accuracy: 0.4738
Epoch 17/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3091 - accuracy: 0.4796
Epoch 18/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3061 - accuracy: 0.4832
Epoch 19/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3052 - accuracy: 0.4860
Epoch 20/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3027 - accuracy: 0.4835
Epoch 21/40
102/102 [==============================] - 1s 6ms/step - loss: 1.3009 - accuracy: 0.4847
Epoch 22/40
102/102 [==============================] - 1s 7ms/step - loss: 1.3035 - accuracy: 0.4815
Epoch 23/40
102/102 [==============================] - 1s 7ms/step - loss: 1.3006 - accuracy: 0.4836
Epoch 24/40
102/102 [==============================] - 1s 7ms/step - loss: 1.2970 - accuracy: 0.4856
Epoch 25/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2961 - accuracy: 0.4861
Epoch 26/40
102/102 [==============================] - 1s 11ms/step - loss: 1.2990 - accuracy: 0.4871
Epoch 27/40
102/102 [==============================] - 1s 10ms/step - loss: 1.2951 - accuracy: 0.4816
Epoch 28/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2953 - accuracy: 0.4837
Epoch 29/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2950 - accuracy: 0.4819
Epoch 30/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2940 - accuracy: 0.4924
Epoch 31/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2924 - accuracy: 0.4830
Epoch 32/40
102/102 [==============================] - 1s 6ms/step - loss: 1.2932 - accuracy: 0.4895
Epoch 33/40
102/102 [==============================] - 1s 6ms/step - loss: 1.2941 - accuracy: 0.4932
Epoch 34/40
102/102 [==============================] - 1s 6ms/step - loss: 1.2918 - accuracy: 0.4796
Epoch 35/40
102/102 [==============================] - 1s 6ms/step - loss: 1.2916 - accuracy: 0.4835
Epoch 36/40
102/102 [==============================] - 1s 6ms/step - loss: 1.2911 - accuracy: 0.4843
Epoch 37/40
102/102 [==============================] - 1s 7ms/step - loss: 1.2890 - accuracy: 0.4888
Epoch 38/40
102/102 [==============================] - 1s 8ms/step - loss: 1.2893 - accuracy: 0.4799
Epoch 39/40
102/102 [==============================] - 1s 7ms/step - loss: 1.2926 - accuracy: 0.4835
Epoch 40/40
102/102 [==============================] - 1s 7ms/step - loss: 1.2887 - accuracy: 0.4841
26/26 [==============================] - 0s 2ms/step - loss: 0.6425 - accuracy: 0.4864


For 41: Test ACC=[0.6425343751907349, 0.4864029586315155]
Confusion Matrix
[[1382 1609]
 [  53  192]]
Classification Report
              precision    recall  f1-score   support

           0       0.96      0.46      0.62      2991
           1       0.11      0.78      0.19       245

    accuracy                           0.49      3236
   macro avg       0.53      0.62      0.41      3236
weighted avg       0.90      0.49      0.59      3236