Dummy note
trainingshape 5
(93762, 7)
(93762, 7, 1)
testingshape 5
(23442, 7)
(23442, 7, 1)
nb occurences
Counter({0: 59057, 1: 34705})
weights={0: 1.5876526068035963, 1: 2.7016856360754935}
2021-01-13 00:25:43.915849: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-01-13 00:25:43.917244: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2021-01-13 00:25:43.918359: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (LAPTOP-2L5S26NL): /proc/driver/nvidia/version does not exist
2021-01-13 00:25:43.925367: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-01-13 00:25:43.972360: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2100000000 Hz
2021-01-13 00:25:43.977446: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5eeb3c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-01-13 00:25:43.978227: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru (GRU)                    (None, 7, 8)              264
_________________________________________________________________
gru_1 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense (Dense)                (None, 2)                 18
_________________________________________________________________
activation (Activation)      (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
367/367 [==============================] - 5s 14ms/step - loss: 0.9769 - accuracy: 0.7950
Epoch 2/20
367/367 [==============================] - 5s 14ms/step - loss: 0.8947 - accuracy: 0.8145
Epoch 3/20
367/367 [==============================] - 5s 13ms/step - loss: 0.8483 - accuracy: 0.8364
Epoch 4/20
367/367 [==============================] - 5s 14ms/step - loss: 0.8233 - accuracy: 0.8467
Epoch 5/20
367/367 [==============================] - 5s 14ms/step - loss: 0.8120 - accuracy: 0.8518
Epoch 6/20
367/367 [==============================] - 5s 14ms/step - loss: 0.7728 - accuracy: 0.8575
Epoch 7/20
367/367 [==============================] - 5s 14ms/step - loss: 0.7509 - accuracy: 0.8582
Epoch 8/20
367/367 [==============================] - 5s 15ms/step - loss: 0.7447 - accuracy: 0.8603
Epoch 9/20
367/367 [==============================] - 5s 14ms/step - loss: 0.7405 - accuracy: 0.8621
Epoch 10/20
367/367 [==============================] - 5s 14ms/step - loss: 0.7214 - accuracy: 0.8643
Epoch 11/20
367/367 [==============================] - 5s 14ms/step - loss: 0.6802 - accuracy: 0.8631
Epoch 12/20
367/367 [==============================] - 5s 14ms/step - loss: 0.6692 - accuracy: 0.8615
Epoch 13/20
367/367 [==============================] - 5s 14ms/step - loss: 0.6597 - accuracy: 0.8614
Epoch 14/20
367/367 [==============================] - 5s 14ms/step - loss: 0.6528 - accuracy: 0.8614
Epoch 15/20
367/367 [==============================] - 5s 14ms/step - loss: 0.6476 - accuracy: 0.8614
Epoch 16/20
367/367 [==============================] - 5s 15ms/step - loss: 0.6436 - accuracy: 0.8631
Epoch 17/20
367/367 [==============================] - 4s 11ms/step - loss: 0.6395 - accuracy: 0.8635
Epoch 18/20
367/367 [==============================] - 2s 6ms/step - loss: 0.6345 - accuracy: 0.8639
Epoch 19/20
367/367 [==============================] - 2s 6ms/step - loss: 0.6324 - accuracy: 0.8654
Epoch 20/20
367/367 [==============================] - 2s 7ms/step - loss: 0.6301 - accuracy: 0.8644
92/92 [==============================] - 0s 2ms/step - loss: 0.2956 - accuracy: 0.8745


For 5: Test ACC=[0.2955711781978607, 0.8744987845420837]
Confusion Matrix
[[13803   962]
 [ 1980  6697]]
Classification Report
              precision    recall  f1-score   support

           0       0.87      0.93      0.90     14765
           1       0.87      0.77      0.82      8677

    accuracy                           0.87     23442
   macro avg       0.87      0.85      0.86     23442
weighted avg       0.87      0.87      0.87     23442

WARNING:tensorflow:From /home/delairra/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Model.state_updates (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
2021-01-13 00:27:29.050323: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/delairra/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/tracking.py:111: Layer.updates (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
This property should not be used in TensorFlow 2.0, as updates are applied automatically.
trainingshape 6
(24055, 7)
(24055, 7, 1)
testingshape 6
(6015, 7)
(6015, 7, 1)
nb occurences
Counter({0: 14460, 1: 9595})
weights={0: 1.6635546334716458, 1: 2.5070349140177175}
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_2 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_3 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_1 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_1 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
94/94 [==============================] - 1s 8ms/step - loss: 1.3613 - accuracy: 0.5615
Epoch 2/20
94/94 [==============================] - 1s 8ms/step - loss: 1.2462 - accuracy: 0.6624
Epoch 3/20
94/94 [==============================] - 1s 7ms/step - loss: 1.1760 - accuracy: 0.6989
Epoch 4/20
94/94 [==============================] - 1s 7ms/step - loss: 1.1510 - accuracy: 0.7062
Epoch 5/20
94/94 [==============================] - 1s 7ms/step - loss: 1.1330 - accuracy: 0.7095
Epoch 6/20
94/94 [==============================] - 1s 8ms/step - loss: 1.1188 - accuracy: 0.7137
Epoch 7/20
94/94 [==============================] - 1s 7ms/step - loss: 1.1094 - accuracy: 0.7164
Epoch 8/20
94/94 [==============================] - 1s 7ms/step - loss: 1.1026 - accuracy: 0.7187
Epoch 9/20
94/94 [==============================] - 1s 8ms/step - loss: 1.0948 - accuracy: 0.7222
Epoch 10/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0878 - accuracy: 0.7269
Epoch 11/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0831 - accuracy: 0.7295
Epoch 12/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0771 - accuracy: 0.7300
Epoch 13/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0738 - accuracy: 0.7321
Epoch 14/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0698 - accuracy: 0.7313
Epoch 15/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0656 - accuracy: 0.7341
Epoch 16/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0625 - accuracy: 0.7360
Epoch 17/20
94/94 [==============================] - 1s 8ms/step - loss: 1.0599 - accuracy: 0.7374
Epoch 18/20
94/94 [==============================] - 1s 7ms/step - loss: 1.0590 - accuracy: 0.7364
Epoch 19/20
94/94 [==============================] - 1s 6ms/step - loss: 1.0562 - accuracy: 0.7391
Epoch 20/20
94/94 [==============================] - 1s 6ms/step - loss: 1.0554 - accuracy: 0.7387
24/24 [==============================] - 0s 2ms/step - loss: 0.5511 - accuracy: 0.7277


For 6: Test ACC=[0.5510901808738708, 0.7276808023452759]
Confusion Matrix
[[2370 1246]
 [ 392 2007]]
Classification Report
              precision    recall  f1-score   support

           0       0.86      0.66      0.74      3616
           1       0.62      0.84      0.71      2399

    accuracy                           0.73      6015
   macro avg       0.74      0.75      0.73      6015
weighted avg       0.76      0.73      0.73      6015

trainingshape 7
(58380, 7)
(58380, 7, 1)
testingshape 7
(14597, 7)
(14597, 7, 1)
nb occurences
Counter({0: 39524, 1: 18856})
weights={0: 1.4770772189049692, 1: 3.0960967331353415}
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_4 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_5 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_2 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
229/229 [==============================] - 2s 7ms/step - loss: 1.1496 - accuracy: 0.7229
Epoch 2/20
229/229 [==============================] - 2s 8ms/step - loss: 0.8927 - accuracy: 0.8214
Epoch 3/20
229/229 [==============================] - 2s 8ms/step - loss: 0.8128 - accuracy: 0.8558
Epoch 4/20
229/229 [==============================] - 2s 8ms/step - loss: 0.7885 - accuracy: 0.8615
Epoch 5/20
229/229 [==============================] - 2s 8ms/step - loss: 0.7732 - accuracy: 0.8629
Epoch 6/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7687 - accuracy: 0.8633
Epoch 7/20
229/229 [==============================] - 1s 7ms/step - loss: 0.7588 - accuracy: 0.8657
Epoch 8/20
229/229 [==============================] - 2s 7ms/step - loss: 0.7524 - accuracy: 0.8660
Epoch 9/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7500 - accuracy: 0.8674
Epoch 10/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7447 - accuracy: 0.8683
Epoch 11/20
229/229 [==============================] - 2s 7ms/step - loss: 0.7445 - accuracy: 0.8673
Epoch 12/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7387 - accuracy: 0.8692
Epoch 13/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7366 - accuracy: 0.8685
Epoch 14/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7320 - accuracy: 0.8696
Epoch 15/20
229/229 [==============================] - 2s 7ms/step - loss: 0.7324 - accuracy: 0.8697
Epoch 16/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7277 - accuracy: 0.8705
Epoch 17/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7262 - accuracy: 0.8701
Epoch 18/20
229/229 [==============================] - 2s 7ms/step - loss: 0.7241 - accuracy: 0.8708
Epoch 19/20
229/229 [==============================] - 1s 6ms/step - loss: 0.7214 - accuracy: 0.8718
Epoch 20/20
229/229 [==============================] - 1s 7ms/step - loss: 0.7193 - accuracy: 0.8709
58/58 [==============================] - 0s 2ms/step - loss: 0.3507 - accuracy: 0.8717


For 7: Test ACC=[0.35065528750419617, 0.8716859817504883]
Confusion Matrix
[[8919  963]
 [ 910 3805]]
Classification Report
              precision    recall  f1-score   support

           0       0.91      0.90      0.90      9882
           1       0.80      0.81      0.80      4715

    accuracy                           0.87     14597
   macro avg       0.85      0.85      0.85     14597
weighted avg       0.87      0.87      0.87     14597

trainingshape 8
(56838, 7)
(56838, 7, 1)
testingshape 8
(14210, 7)
(14210, 7, 1)
nb occurences
Counter({0: 44931, 1: 11907})
weights={0: 1.2650063430593577, 1: 4.773494583018392}
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_6 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_7 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_3 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_3 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
223/223 [==============================] - 2s 7ms/step - loss: 1.2627 - accuracy: 0.5724
Epoch 2/20
223/223 [==============================] - 1s 6ms/step - loss: 1.0412 - accuracy: 0.6678
Epoch 3/20
223/223 [==============================] - 1s 6ms/step - loss: 0.9393 - accuracy: 0.6835
Epoch 4/20
223/223 [==============================] - 2s 7ms/step - loss: 0.8903 - accuracy: 0.6915
Epoch 5/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8626 - accuracy: 0.6994
Epoch 6/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8466 - accuracy: 0.7080
Epoch 7/20
223/223 [==============================] - 2s 7ms/step - loss: 0.8363 - accuracy: 0.7144
Epoch 8/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8286 - accuracy: 0.7182
Epoch 9/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8221 - accuracy: 0.7198
Epoch 10/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8173 - accuracy: 0.7211
Epoch 11/20
223/223 [==============================] - 1s 7ms/step - loss: 0.8121 - accuracy: 0.7208
Epoch 12/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8093 - accuracy: 0.7214
Epoch 13/20
223/223 [==============================] - 1s 6ms/step - loss: 0.8040 - accuracy: 0.7231
Epoch 14/20
223/223 [==============================] - 2s 7ms/step - loss: 0.8004 - accuracy: 0.7239
Epoch 15/20
223/223 [==============================] - 1s 6ms/step - loss: 0.7973 - accuracy: 0.7248
Epoch 16/20
223/223 [==============================] - 1s 7ms/step - loss: 0.7941 - accuracy: 0.7248
Epoch 17/20
223/223 [==============================] - 2s 8ms/step - loss: 0.7939 - accuracy: 0.7256
Epoch 18/20
223/223 [==============================] - 1s 6ms/step - loss: 0.7921 - accuracy: 0.7262
Epoch 19/20
223/223 [==============================] - 1s 7ms/step - loss: 0.7901 - accuracy: 0.7265
Epoch 20/20
223/223 [==============================] - 1s 6ms/step - loss: 0.7864 - accuracy: 0.7268
56/56 [==============================] - 0s 2ms/step - loss: 0.3839 - accuracy: 0.7284


For 8: Test ACC=[0.383860319852829, 0.7283602952957153]
Confusion Matrix
[[7508 3725]
 [ 135 2842]]
Classification Report
              precision    recall  f1-score   support

           0       0.98      0.67      0.80     11233
           1       0.43      0.95      0.60      2977

    accuracy                           0.73     14210
   macro avg       0.71      0.81      0.70     14210
weighted avg       0.87      0.73      0.75     14210

trainingshape 9
(21930, 7)
(21930, 7, 1)
testingshape 9
(5484, 7)
(5484, 7, 1)
nb occurences
Counter({0: 17133, 1: 4797})
weights={0: 1.2799859919453687, 1: 4.571607254534084}
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_8 (GRU)                  (None, 7, 8)              264
_________________________________________________________________
gru_9 (GRU)                  (None, 8)                 432
_________________________________________________________________
dense_4 (Dense)              (None, 2)                 18
_________________________________________________________________
activation_4 (Activation)    (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
86/86 [==============================] - 1s 8ms/step - loss: 1.3415 - accuracy: 0.4040
Epoch 2/20
86/86 [==============================] - 1s 7ms/step - loss: 1.0126 - accuracy: 0.7900
Epoch 3/20
86/86 [==============================] - 1s 7ms/step - loss: 0.8454 - accuracy: 0.8300
Epoch 4/20
86/86 [==============================] - 1s 7ms/step - loss: 0.8159 - accuracy: 0.8386
Epoch 5/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7998 - accuracy: 0.8407
Epoch 6/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7888 - accuracy: 0.8451
Epoch 7/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7801 - accuracy: 0.8511
Epoch 8/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7659 - accuracy: 0.8553
Epoch 9/20
86/86 [==============================] - 1s 8ms/step - loss: 0.7520 - accuracy: 0.8622
Epoch 10/20
86/86 [==============================] - 1s 8ms/step - loss: 0.7420 - accuracy: 0.8655
Epoch 11/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7314 - accuracy: 0.8710
Epoch 12/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7252 - accuracy: 0.8711
Epoch 13/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7197 - accuracy: 0.8728
Epoch 14/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7137 - accuracy: 0.8745
Epoch 15/20
86/86 [==============================] - 1s 6ms/step - loss: 0.7106 - accuracy: 0.8733
Epoch 16/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7115 - accuracy: 0.8734
Epoch 17/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7060 - accuracy: 0.8738
Epoch 18/20
86/86 [==============================] - 1s 8ms/step - loss: 0.7053 - accuracy: 0.8741
Epoch 19/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7018 - accuracy: 0.8734
Epoch 20/20
86/86 [==============================] - 1s 7ms/step - loss: 0.7005 - accuracy: 0.8760
22/22 [==============================] - 0s 2ms/step - loss: 0.3591 - accuracy: 0.8612


For 9: Test ACC=[0.3590608835220337, 0.8612326979637146]
Confusion Matrix
[[3728  556]
 [ 205  995]]
Classification Report
              precision    recall  f1-score   support

           0       0.95      0.87      0.91      4284
           1       0.64      0.83      0.72      1200

    accuracy                           0.86      5484
   macro avg       0.79      0.85      0.82      5484
weighted avg       0.88      0.86      0.87      5484

trainingshape 10
(89730, 7)
(89730, 7, 1)
testingshape 10
(22434, 7)
(22434, 7, 1)
nb occurences
Counter({0: 43413, 1: 41373, 2: 4944})
weights={0: 2.0668924055006563, 1: 2.1688057428757883, 2: 18.149271844660195}
Model: "sequential_5"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_10 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_11 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_5 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_5 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
351/351 [==============================] - 2s 7ms/step - loss: 3.2084 - accuracy: 0.3592
Epoch 2/20
351/351 [==============================] - 2s 7ms/step - loss: 3.0620 - accuracy: 0.4421
Epoch 3/20
351/351 [==============================] - 2s 7ms/step - loss: 2.8958 - accuracy: 0.5325
Epoch 4/20
351/351 [==============================] - 2s 7ms/step - loss: 2.7850 - accuracy: 0.5642
Epoch 5/20
351/351 [==============================] - 2s 7ms/step - loss: 2.7232 - accuracy: 0.5896
Epoch 6/20
351/351 [==============================] - 2s 7ms/step - loss: 2.6812 - accuracy: 0.6088
Epoch 7/20
351/351 [==============================] - 2s 7ms/step - loss: 2.6367 - accuracy: 0.6258
Epoch 8/20
351/351 [==============================] - 2s 7ms/step - loss: 2.5987 - accuracy: 0.6372
Epoch 9/20
351/351 [==============================] - 2s 7ms/step - loss: 2.5680 - accuracy: 0.6453
Epoch 10/20
351/351 [==============================] - 2s 7ms/step - loss: 2.5496 - accuracy: 0.6518
Epoch 11/20
351/351 [==============================] - 2s 7ms/step - loss: 2.5238 - accuracy: 0.6593
Epoch 12/20
351/351 [==============================] - 2s 7ms/step - loss: 2.5100 - accuracy: 0.6595
Epoch 13/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4999 - accuracy: 0.6637
Epoch 14/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4843 - accuracy: 0.6681
Epoch 15/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4793 - accuracy: 0.6695
Epoch 16/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4675 - accuracy: 0.6724
Epoch 17/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4583 - accuracy: 0.6710
Epoch 18/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4514 - accuracy: 0.6741
Epoch 19/20
351/351 [==============================] - 3s 7ms/step - loss: 2.4373 - accuracy: 0.6737
Epoch 20/20
351/351 [==============================] - 2s 7ms/step - loss: 2.4414 - accuracy: 0.6715
88/88 [==============================] - 0s 2ms/step - loss: 0.7573 - accuracy: 0.6906


For 10: Test ACC=[0.7572663426399231, 0.6906035542488098]
Confusion Matrix
[[7025 2702 1127]
 [1554 7910  880]
 [ 419  259  558]]
Classification Report
              precision    recall  f1-score   support

           0       0.78      0.65      0.71     10854
           1       0.73      0.76      0.75     10344
           2       0.22      0.45      0.29      1236

    accuracy                           0.69     22434
   macro avg       0.58      0.62      0.58     22434
weighted avg       0.73      0.69      0.70     22434

trainingshape 11
(22051, 7)
(22051, 7, 1)
testingshape 11
(5514, 7)
(5514, 7, 1)
nb occurences
Counter({1: 11258, 0: 8959, 2: 1834})
weights={0: 2.4613238084607656, 1: 1.9586960383727126, 2: 12.023446019629226}
Model: "sequential_6"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_12 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_13 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_6 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_6 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
87/87 [==============================] - 1s 7ms/step - loss: 3.3681 - accuracy: 0.2820
Epoch 2/20
87/87 [==============================] - 1s 7ms/step - loss: 3.2371 - accuracy: 0.3746
Epoch 3/20
87/87 [==============================] - 1s 7ms/step - loss: 3.2104 - accuracy: 0.3635
Epoch 4/20
87/87 [==============================] - 1s 7ms/step - loss: 3.1814 - accuracy: 0.3837
Epoch 5/20
87/87 [==============================] - 1s 7ms/step - loss: 3.1457 - accuracy: 0.4073
Epoch 6/20
87/87 [==============================] - 1s 6ms/step - loss: 3.1043 - accuracy: 0.4334
Epoch 7/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0811 - accuracy: 0.4237
Epoch 8/20
87/87 [==============================] - 1s 8ms/step - loss: 3.0636 - accuracy: 0.4428
Epoch 9/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0616 - accuracy: 0.4429
Epoch 10/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0533 - accuracy: 0.4385
Epoch 11/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0442 - accuracy: 0.4498
Epoch 12/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0380 - accuracy: 0.4505
Epoch 13/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0337 - accuracy: 0.4447
Epoch 14/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0281 - accuracy: 0.4496
Epoch 15/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0231 - accuracy: 0.4534
Epoch 16/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0197 - accuracy: 0.4550
Epoch 17/20
87/87 [==============================] - 1s 7ms/step - loss: 3.0179 - accuracy: 0.4546
Epoch 18/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0097 - accuracy: 0.4640
Epoch 19/20
87/87 [==============================] - 1s 6ms/step - loss: 3.0133 - accuracy: 0.4519
Epoch 20/20
87/87 [==============================] - 1s 6ms/step - loss: 2.9992 - accuracy: 0.4527
22/22 [==============================] - 0s 2ms/step - loss: 0.9432 - accuracy: 0.5036


For 11: Test ACC=[0.9431681036949158, 0.5036271214485168]
Confusion Matrix
[[ 429 1021  790]
 [ 346 2141  328]
 [  83  169  207]]
Classification Report
              precision    recall  f1-score   support

           0       0.50      0.19      0.28      2240
           1       0.64      0.76      0.70      2815
           2       0.16      0.45      0.23       459

    accuracy                           0.50      5514
   macro avg       0.43      0.47      0.40      5514
weighted avg       0.54      0.50      0.49      5514

trainingshape 12
(83854, 7)
(83854, 7, 1)
testingshape 12
(20965, 7)
(20965, 7, 1)
nb occurences
Counter({0: 47352, 1: 32371, 2: 4131})
weights={0: 1.7708650109815849, 1: 2.590404992122579, 2: 20.298717017671265}
Model: "sequential_7"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_14 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_15 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_7 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_7 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
328/328 [==============================] - 2s 7ms/step - loss: 3.2796 - accuracy: 0.2629
Epoch 2/20
328/328 [==============================] - 2s 7ms/step - loss: 3.1823 - accuracy: 0.3790
Epoch 3/20
328/328 [==============================] - 2s 7ms/step - loss: 3.0916 - accuracy: 0.4762
Epoch 4/20
328/328 [==============================] - 2s 7ms/step - loss: 3.0312 - accuracy: 0.4963
Epoch 5/20
328/328 [==============================] - 2s 7ms/step - loss: 2.9920 - accuracy: 0.4871
Epoch 6/20
328/328 [==============================] - 2s 8ms/step - loss: 2.9663 - accuracy: 0.4835
Epoch 7/20
328/328 [==============================] - 2s 7ms/step - loss: 2.9480 - accuracy: 0.4874
Epoch 8/20
328/328 [==============================] - 2s 7ms/step - loss: 2.9251 - accuracy: 0.4888
Epoch 9/20
328/328 [==============================] - 2s 7ms/step - loss: 2.9022 - accuracy: 0.4965
Epoch 10/20
328/328 [==============================] - 2s 7ms/step - loss: 2.8800 - accuracy: 0.5035
Epoch 11/20
328/328 [==============================] - 2s 7ms/step - loss: 2.8571 - accuracy: 0.5108
Epoch 12/20
328/328 [==============================] - 2s 7ms/step - loss: 2.8354 - accuracy: 0.5184
Epoch 13/20
328/328 [==============================] - 2s 7ms/step - loss: 2.8147 - accuracy: 0.5241
Epoch 14/20
328/328 [==============================] - 2s 7ms/step - loss: 2.7906 - accuracy: 0.5344
Epoch 15/20
328/328 [==============================] - 2s 7ms/step - loss: 2.7707 - accuracy: 0.5419
Epoch 16/20
328/328 [==============================] - 2s 7ms/step - loss: 2.7556 - accuracy: 0.5444
Epoch 17/20
328/328 [==============================] - 2s 7ms/step - loss: 2.7375 - accuracy: 0.5473
Epoch 18/20
328/328 [==============================] - 2s 7ms/step - loss: 2.7160 - accuracy: 0.5554
Epoch 19/20
328/328 [==============================] - 2s 7ms/step - loss: 2.6833 - accuracy: 0.5618
Epoch 20/20
328/328 [==============================] - 2s 7ms/step - loss: 2.6597 - accuracy: 0.5680
82/82 [==============================] - 0s 2ms/step - loss: 0.9075 - accuracy: 0.5451


For 12: Test ACC=[0.9075210690498352, 0.545146644115448]
Confusion Matrix
[[5222 3373 3244]
 [1418 5608 1067]
 [ 169  265  599]]
Classification Report
              precision    recall  f1-score   support

           0       0.77      0.44      0.56     11839
           1       0.61      0.69      0.65      8093
           2       0.12      0.58      0.20      1033

    accuracy                           0.55     20965
   macro avg       0.50      0.57      0.47     20965
weighted avg       0.67      0.55      0.58     20965

trainingshape 13
(34177, 7)
(34177, 7, 1)
testingshape 13
(8546, 7)
(8546, 7, 1)
nb occurences
Counter({0: 23961, 1: 8910, 2: 1306})
weights={0: 1.426359500855557, 1: 3.8358024691358024, 2: 26.169218989280246}
Model: "sequential_8"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_16 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_17 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_8 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_8 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
134/134 [==============================] - 1s 9ms/step - loss: 3.2778 - accuracy: 0.2522
Epoch 2/20
134/134 [==============================] - 1s 7ms/step - loss: 3.0810 - accuracy: 0.2741
Epoch 3/20
134/134 [==============================] - 1s 7ms/step - loss: 2.9365 - accuracy: 0.3832
Epoch 4/20
134/134 [==============================] - 1s 7ms/step - loss: 2.8354 - accuracy: 0.5615
Epoch 5/20
134/134 [==============================] - 1s 7ms/step - loss: 2.7897 - accuracy: 0.6459
Epoch 6/20
134/134 [==============================] - 1s 7ms/step - loss: 2.7534 - accuracy: 0.6367
Epoch 7/20
134/134 [==============================] - 1s 7ms/step - loss: 2.7240 - accuracy: 0.6562
Epoch 8/20
134/134 [==============================] - 1s 7ms/step - loss: 2.6950 - accuracy: 0.6682
Epoch 9/20
134/134 [==============================] - 1s 7ms/step - loss: 2.6704 - accuracy: 0.6867
Epoch 10/20
134/134 [==============================] - 1s 7ms/step - loss: 2.6480 - accuracy: 0.6830
Epoch 11/20
134/134 [==============================] - 1s 6ms/step - loss: 2.6248 - accuracy: 0.6936
Epoch 12/20
134/134 [==============================] - 1s 7ms/step - loss: 2.6026 - accuracy: 0.6553
Epoch 13/20
134/134 [==============================] - 1s 6ms/step - loss: 2.5823 - accuracy: 0.6663
Epoch 14/20
134/134 [==============================] - 1s 6ms/step - loss: 2.5686 - accuracy: 0.6360
Epoch 15/20
134/134 [==============================] - 1s 8ms/step - loss: 2.5442 - accuracy: 0.6527
Epoch 16/20
134/134 [==============================] - 1s 6ms/step - loss: 2.5249 - accuracy: 0.6461
Epoch 17/20
134/134 [==============================] - 1s 7ms/step - loss: 2.5096 - accuracy: 0.6590
Epoch 18/20
134/134 [==============================] - 1s 7ms/step - loss: 2.4933 - accuracy: 0.6562
Epoch 19/20
134/134 [==============================] - 1s 6ms/step - loss: 2.4778 - accuracy: 0.6703
Epoch 20/20
134/134 [==============================] - 1s 6ms/step - loss: 2.4648 - accuracy: 0.6712
34/34 [==============================] - 0s 2ms/step - loss: 0.8078 - accuracy: 0.6549


For 13: Test ACC=[0.8077678680419922, 0.6549263000488281]
Confusion Matrix
[[3805  524 1662]
 [ 420 1593  215]
 [  77   51  199]]
Classification Report
              precision    recall  f1-score   support

           0       0.88      0.64      0.74      5991
           1       0.73      0.71      0.72      2228
           2       0.10      0.61      0.17       327

    accuracy                           0.65      8546
   macro avg       0.57      0.65      0.54      8546
weighted avg       0.82      0.65      0.71      8546

trainingshape 14
(38497, 7)
(38497, 7, 1)
testingshape 14
(9626, 7)
(9626, 7, 1)
nb occurences
Counter({0: 25740, 1: 11588, 2: 1169})
weights={0: 1.4956099456099456, 1: 3.3221435968243007, 2: 32.93156544054747}
Model: "sequential_9"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_18 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_19 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_9 (Dense)              (None, 3)                 27
_________________________________________________________________
activation_9 (Activation)    (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
151/151 [==============================] - 1s 7ms/step - loss: 3.2249 - accuracy: 0.3672
Epoch 2/20
151/151 [==============================] - 1s 6ms/step - loss: 3.0306 - accuracy: 0.3989
Epoch 3/20
151/151 [==============================] - 1s 7ms/step - loss: 2.9212 - accuracy: 0.4494
Epoch 4/20
151/151 [==============================] - 1s 6ms/step - loss: 2.8931 - accuracy: 0.4678
Epoch 5/20
151/151 [==============================] - 1s 6ms/step - loss: 2.8466 - accuracy: 0.4770
Epoch 6/20
151/151 [==============================] - 1s 7ms/step - loss: 2.7930 - accuracy: 0.4899
Epoch 7/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7707 - accuracy: 0.5079
Epoch 8/20
151/151 [==============================] - 1s 7ms/step - loss: 2.7695 - accuracy: 0.5161
Epoch 9/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7446 - accuracy: 0.5286
Epoch 10/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7380 - accuracy: 0.5308
Epoch 11/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7431 - accuracy: 0.5345
Epoch 12/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7315 - accuracy: 0.5322
Epoch 13/20
151/151 [==============================] - 1s 7ms/step - loss: 2.7258 - accuracy: 0.5378
Epoch 14/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7373 - accuracy: 0.5424
Epoch 15/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7147 - accuracy: 0.5433
Epoch 16/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7173 - accuracy: 0.5448
Epoch 17/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7093 - accuracy: 0.5452
Epoch 18/20
151/151 [==============================] - 1s 7ms/step - loss: 2.7073 - accuracy: 0.5459
Epoch 19/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7083 - accuracy: 0.5470
Epoch 20/20
151/151 [==============================] - 1s 6ms/step - loss: 2.7050 - accuracy: 0.5496
38/38 [==============================] - 0s 2ms/step - loss: 0.9057 - accuracy: 0.5793


For 14: Test ACC=[0.9057244658470154, 0.5792645215988159]
Confusion Matrix
[[3381 1576 1478]
 [ 567 2042  289]
 [  79   61  153]]
Classification Report
              precision    recall  f1-score   support

           0       0.84      0.53      0.65      6435
           1       0.56      0.70      0.62      2898
           2       0.08      0.52      0.14       293

    accuracy                           0.58      9626
   macro avg       0.49      0.58      0.47      9626
weighted avg       0.73      0.58      0.62      9626

trainingshape 15
(85353, 7)
(85353, 7, 1)
testingshape 15
(21341, 7)
(21341, 7, 1)
nb occurences
Counter({0: 42768, 1: 32909, 2: 8120, 3: 1556})
weights={0: 1.9957210998877664, 1: 2.593606612172962, 2: 10.511453201970443, 3: 54.85411311053984}
Model: "sequential_10"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_20 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_21 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_10 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_10 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
334/334 [==============================] - 2s 7ms/step - loss: 5.1985 - accuracy: 0.3271
Epoch 2/20
334/334 [==============================] - 2s 6ms/step - loss: 4.8125 - accuracy: 0.3849
Epoch 3/20
334/334 [==============================] - 2s 6ms/step - loss: 4.7376 - accuracy: 0.4070
Epoch 4/20
334/334 [==============================] - 2s 7ms/step - loss: 4.6837 - accuracy: 0.4108
Epoch 5/20
334/334 [==============================] - 2s 6ms/step - loss: 4.6319 - accuracy: 0.4319
Epoch 6/20
334/334 [==============================] - 2s 7ms/step - loss: 4.5745 - accuracy: 0.4666
Epoch 7/20
334/334 [==============================] - 2s 6ms/step - loss: 4.5160 - accuracy: 0.4979
Epoch 8/20
334/334 [==============================] - 2s 7ms/step - loss: 4.4534 - accuracy: 0.5216
Epoch 9/20
334/334 [==============================] - 2s 6ms/step - loss: 4.3893 - accuracy: 0.5492
Epoch 10/20
334/334 [==============================] - 2s 7ms/step - loss: 4.3342 - accuracy: 0.5511
Epoch 11/20
334/334 [==============================] - 2s 6ms/step - loss: 4.2841 - accuracy: 0.5634
Epoch 12/20
334/334 [==============================] - 2s 6ms/step - loss: 4.2501 - accuracy: 0.5629
Epoch 13/20
334/334 [==============================] - 2s 7ms/step - loss: 4.2382 - accuracy: 0.5720
Epoch 14/20
334/334 [==============================] - 2s 6ms/step - loss: 4.2043 - accuracy: 0.5687
Epoch 15/20
334/334 [==============================] - 2s 7ms/step - loss: 4.1896 - accuracy: 0.5797
Epoch 16/20
334/334 [==============================] - 2s 6ms/step - loss: 4.1390 - accuracy: 0.5854
Epoch 17/20
334/334 [==============================] - 2s 7ms/step - loss: 4.1317 - accuracy: 0.5853
Epoch 18/20
334/334 [==============================] - 2s 6ms/step - loss: 4.1185 - accuracy: 0.5896
Epoch 19/20
334/334 [==============================] - 2s 7ms/step - loss: 4.0933 - accuracy: 0.5953
Epoch 20/20
334/334 [==============================] - 2s 6ms/step - loss: 4.0920 - accuracy: 0.5931
84/84 [==============================] - 0s 2ms/step - loss: 0.9943 - accuracy: 0.6016


For 15: Test ACC=[0.9942736029624939, 0.6016119122505188]
Confusion Matrix
[[7409 1219 1552  513]
 [1056 4042 1334 1796]
 [ 325  346 1176  183]
 [  28  107   43  212]]
Classification Report
              precision    recall  f1-score   support

           0       0.84      0.69      0.76     10693
           1       0.71      0.49      0.58      8228
           2       0.29      0.58      0.38      2030
           3       0.08      0.54      0.14       390

    accuracy                           0.60     21341
   macro avg       0.48      0.58      0.46     21341
weighted avg       0.72      0.60      0.64     21341

trainingshape 16
(23927, 7)
(23927, 7, 1)
testingshape 16
(5984, 7)
(5984, 7, 1)
nb occurences
Counter({1: 11101, 0: 9954, 2: 2453, 3: 419})
weights={0: 2.403757283504119, 1: 2.155391406179623, 2: 9.75417855686914, 3: 57.105011933174225}
Model: "sequential_11"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_22 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_23 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_11 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_11 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
94/94 [==============================] - 1s 6ms/step - loss: 5.5513 - accuracy: 0.1974
Epoch 2/20
94/94 [==============================] - 1s 6ms/step - loss: 5.5313 - accuracy: 0.1740
Epoch 3/20
94/94 [==============================] - 1s 7ms/step - loss: 5.5033 - accuracy: 0.2783
Epoch 4/20
94/94 [==============================] - 1s 6ms/step - loss: 5.4646 - accuracy: 0.3309
Epoch 5/20
94/94 [==============================] - 1s 7ms/step - loss: 5.4240 - accuracy: 0.3514
Epoch 6/20
94/94 [==============================] - 1s 6ms/step - loss: 5.3916 - accuracy: 0.3690
Epoch 7/20
94/94 [==============================] - 1s 7ms/step - loss: 5.3496 - accuracy: 0.3749
Epoch 8/20
94/94 [==============================] - 1s 6ms/step - loss: 5.3177 - accuracy: 0.3824
Epoch 9/20
94/94 [==============================] - 1s 6ms/step - loss: 5.2936 - accuracy: 0.3843
Epoch 10/20
94/94 [==============================] - 1s 6ms/step - loss: 5.2693 - accuracy: 0.3895
Epoch 11/20
94/94 [==============================] - 1s 7ms/step - loss: 5.2583 - accuracy: 0.3863
Epoch 12/20
94/94 [==============================] - 1s 7ms/step - loss: 5.2485 - accuracy: 0.3848
Epoch 13/20
94/94 [==============================] - 1s 6ms/step - loss: 5.2302 - accuracy: 0.3833
Epoch 14/20
94/94 [==============================] - 1s 6ms/step - loss: 5.2243 - accuracy: 0.3866
Epoch 15/20
94/94 [==============================] - 1s 6ms/step - loss: 5.2095 - accuracy: 0.3673
Epoch 16/20
94/94 [==============================] - 1s 6ms/step - loss: 5.1997 - accuracy: 0.3749
Epoch 17/20
94/94 [==============================] - 1s 8ms/step - loss: 5.1869 - accuracy: 0.3746
Epoch 18/20
94/94 [==============================] - 1s 8ms/step - loss: 5.1745 - accuracy: 0.3744
Epoch 19/20
94/94 [==============================] - 1s 9ms/step - loss: 5.1616 - accuracy: 0.3697
Epoch 20/20
94/94 [==============================] - 1s 6ms/step - loss: 5.1520 - accuracy: 0.3654
24/24 [==============================] - 0s 2ms/step - loss: 1.2910 - accuracy: 0.3720


For 16: Test ACC=[1.2910432815551758, 0.37199199199676514]
Confusion Matrix
[[1548  256  431  254]
 [1360  384  714  318]
 [ 198   54  255  107]
 [  30    8   28   39]]
Classification Report
              precision    recall  f1-score   support

           0       0.49      0.62      0.55      2489
           1       0.55      0.14      0.22      2776
           2       0.18      0.42      0.25       614
           3       0.05      0.37      0.09       105

    accuracy                           0.37      5984
   macro avg       0.32      0.39      0.28      5984
weighted avg       0.48      0.37      0.36      5984

trainingshape 17
(84061, 7)
(84061, 7, 1)
testingshape 17
(21017, 7)
(21017, 7, 1)
nb occurences
Counter({0: 48159, 1: 29846, 2: 5446, 3: 610})
weights={0: 1.7454889013476194, 1: 2.8164913221202172, 2: 15.435365405802424, 3: 137.80491803278687}
Model: "sequential_12"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_24 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_25 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_12 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_12 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
329/329 [==============================] - 2s 7ms/step - loss: 5.4121 - accuracy: 0.1617
Epoch 2/20
329/329 [==============================] - 2s 7ms/step - loss: 5.1410 - accuracy: 0.2090
Epoch 3/20
329/329 [==============================] - 2s 7ms/step - loss: 4.8322 - accuracy: 0.4712
Epoch 4/20
329/329 [==============================] - 2s 7ms/step - loss: 4.6995 - accuracy: 0.5227
Epoch 5/20
329/329 [==============================] - 2s 7ms/step - loss: 4.6233 - accuracy: 0.5150
Epoch 6/20
329/329 [==============================] - 2s 6ms/step - loss: 4.5443 - accuracy: 0.5227
Epoch 7/20
329/329 [==============================] - 2s 7ms/step - loss: 4.4704 - accuracy: 0.5282
Epoch 8/20
329/329 [==============================] - 2s 7ms/step - loss: 4.4047 - accuracy: 0.5238
Epoch 9/20
329/329 [==============================] - 2s 7ms/step - loss: 4.3342 - accuracy: 0.5305
Epoch 10/20
329/329 [==============================] - 2s 6ms/step - loss: 4.2591 - accuracy: 0.5323
Epoch 11/20
329/329 [==============================] - 2s 6ms/step - loss: 4.2237 - accuracy: 0.5272
Epoch 12/20
329/329 [==============================] - 2s 7ms/step - loss: 4.1953 - accuracy: 0.5226
Epoch 13/20
329/329 [==============================] - 2s 6ms/step - loss: 4.1796 - accuracy: 0.5150
Epoch 14/20
329/329 [==============================] - 2s 7ms/step - loss: 4.1511 - accuracy: 0.5089
Epoch 15/20
329/329 [==============================] - 2s 6ms/step - loss: 4.1264 - accuracy: 0.5149
Epoch 16/20
329/329 [==============================] - 2s 7ms/step - loss: 4.1208 - accuracy: 0.5119
Epoch 17/20
329/329 [==============================] - 2s 6ms/step - loss: 4.1061 - accuracy: 0.5111
Epoch 18/20
329/329 [==============================] - 2s 6ms/step - loss: 4.0898 - accuracy: 0.5175
Epoch 19/20
329/329 [==============================] - 2s 7ms/step - loss: 4.0776 - accuracy: 0.5106
Epoch 20/20
329/329 [==============================] - 2s 7ms/step - loss: 4.0786 - accuracy: 0.5118
83/83 [==============================] - 0s 2ms/step - loss: 1.0423 - accuracy: 0.5198


For 17: Test ACC=[1.042326807975769, 0.5198172926902771]
Confusion Matrix
[[5874 1752 4289  125]
 [ 991 4263 2021  187]
 [ 300  309  689   64]
 [   8   14   32   99]]
Classification Report
              precision    recall  f1-score   support

           0       0.82      0.49      0.61     12040
           1       0.67      0.57      0.62      7462
           2       0.10      0.51      0.16      1362
           3       0.21      0.65      0.32       153

    accuracy                           0.52     21017
   macro avg       0.45      0.55      0.43     21017
weighted avg       0.72      0.52      0.58     21017

trainingshape 18
(25957, 7)
(25957, 7, 1)
testingshape 18
(6490, 7)
(6490, 7, 1)
nb occurences
Counter({0: 15976, 1: 7923, 2: 1476, 3: 582})
weights={0: 1.6247496244366548, 1: 3.27615802095166, 2: 17.586043360433603, 3: 44.59965635738831}
Model: "sequential_13"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_26 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_27 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_13 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_13 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
102/102 [==============================] - 1s 7ms/step - loss: 5.5123 - accuracy: 0.2602
Epoch 2/20
102/102 [==============================] - 1s 7ms/step - loss: 5.3772 - accuracy: 0.2068
Epoch 3/20
102/102 [==============================] - 1s 6ms/step - loss: 5.1034 - accuracy: 0.2969
Epoch 4/20
102/102 [==============================] - 1s 7ms/step - loss: 4.7112 - accuracy: 0.4881
Epoch 5/20
102/102 [==============================] - 1s 6ms/step - loss: 4.5396 - accuracy: 0.4966
Epoch 6/20
102/102 [==============================] - 1s 6ms/step - loss: 4.4963 - accuracy: 0.4600
Epoch 7/20
102/102 [==============================] - 1s 6ms/step - loss: 4.4673 - accuracy: 0.4453
Epoch 8/20
102/102 [==============================] - 1s 7ms/step - loss: 4.4540 - accuracy: 0.4627
Epoch 9/20
102/102 [==============================] - 1s 6ms/step - loss: 4.4333 - accuracy: 0.5202
Epoch 10/20
102/102 [==============================] - 1s 6ms/step - loss: 4.4098 - accuracy: 0.5489
Epoch 11/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3897 - accuracy: 0.4850
Epoch 12/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3785 - accuracy: 0.5184
Epoch 13/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3650 - accuracy: 0.5525
Epoch 14/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3540 - accuracy: 0.5174
Epoch 15/20
102/102 [==============================] - 1s 7ms/step - loss: 4.3372 - accuracy: 0.5412
Epoch 16/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3283 - accuracy: 0.5249
Epoch 17/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3150 - accuracy: 0.5301
Epoch 18/20
102/102 [==============================] - 1s 6ms/step - loss: 4.3055 - accuracy: 0.5206
Epoch 19/20
102/102 [==============================] - 1s 6ms/step - loss: 4.2917 - accuracy: 0.5367
Epoch 20/20
102/102 [==============================] - 1s 6ms/step - loss: 4.2827 - accuracy: 0.5337
26/26 [==============================] - 0s 2ms/step - loss: 1.1607 - accuracy: 0.5331


For 18: Test ACC=[1.1607242822647095, 0.5331279039382935]
Confusion Matrix
[[2173  497  656  668]
 [ 353 1099  329  200]
 [ 161   43   88   77]
 [   7   10   29  100]]
Classification Report
              precision    recall  f1-score   support

           0       0.81      0.54      0.65      3994
           1       0.67      0.55      0.61      1981
           2       0.08      0.24      0.12       369
           3       0.10      0.68      0.17       146

    accuracy                           0.53      6490
   macro avg       0.41      0.51      0.39      6490
weighted avg       0.71      0.53      0.60      6490

trainingshape 19
(87853, 7)
(87853, 7, 1)
testingshape 19
(21967, 7)
(21967, 7, 1)
nb occurences
Counter({0: 38736, 1: 26893, 2: 18609, 3: 3147, 4: 468})
weights={0: 2.2679935976869063, 1: 3.266760867140148, 2: 4.72099521736794, 3: 27.91642834445504, 4: 187.72008547008548}
Model: "sequential_14"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_28 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_29 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_14 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_14 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
344/344 [==============================] - 2s 7ms/step - loss: 7.6245 - accuracy: 0.3969
Epoch 2/20
344/344 [==============================] - 2s 6ms/step - loss: 6.8949 - accuracy: 0.4691
Epoch 3/20
344/344 [==============================] - 2s 7ms/step - loss: 6.6722 - accuracy: 0.4712
Epoch 4/20
344/344 [==============================] - 2s 6ms/step - loss: 6.5613 - accuracy: 0.5051
Epoch 5/20
344/344 [==============================] - 2s 7ms/step - loss: 6.4400 - accuracy: 0.5121
Epoch 6/20
344/344 [==============================] - 2s 6ms/step - loss: 6.3035 - accuracy: 0.5178
Epoch 7/20
344/344 [==============================] - 2s 6ms/step - loss: 6.1857 - accuracy: 0.5149
Epoch 8/20
344/344 [==============================] - 2s 7ms/step - loss: 6.0803 - accuracy: 0.5181
Epoch 9/20
344/344 [==============================] - 2s 6ms/step - loss: 6.0173 - accuracy: 0.5199
Epoch 10/20
344/344 [==============================] - 2s 7ms/step - loss: 5.9300 - accuracy: 0.5218
Epoch 11/20
344/344 [==============================] - 2s 6ms/step - loss: 5.8691 - accuracy: 0.5308
Epoch 12/20
344/344 [==============================] - 2s 7ms/step - loss: 5.8425 - accuracy: 0.5235
Epoch 13/20
344/344 [==============================] - 2s 6ms/step - loss: 5.8024 - accuracy: 0.5315
Epoch 14/20
344/344 [==============================] - 2s 6ms/step - loss: 5.7604 - accuracy: 0.5317
Epoch 15/20
344/344 [==============================] - 2s 6ms/step - loss: 5.7287 - accuracy: 0.5352
Epoch 16/20
344/344 [==============================] - 2s 6ms/step - loss: 5.7276 - accuracy: 0.5381
Epoch 17/20
344/344 [==============================] - 2s 6ms/step - loss: 5.6959 - accuracy: 0.5425
Epoch 18/20
344/344 [==============================] - 2s 6ms/step - loss: 5.6673 - accuracy: 0.5431
Epoch 19/20
344/344 [==============================] - 2s 6ms/step - loss: 5.6599 - accuracy: 0.5480
Epoch 20/20
344/344 [==============================] - 2s 6ms/step - loss: 5.6384 - accuracy: 0.5486
86/86 [==============================] - 0s 2ms/step - loss: 1.0845 - accuracy: 0.5699


For 19: Test ACC=[1.0845177173614502, 0.5699003338813782]
Confusion Matrix
[[6670 1299  689  803  224]
 [ 710 2595 1003 2124  292]
 [ 264  700 2881  586  222]
 [  16  274   59  302  136]
 [   5    4    5   33   71]]
Classification Report
              precision    recall  f1-score   support

           0       0.87      0.69      0.77      9685
           1       0.53      0.39      0.45      6724
           2       0.62      0.62      0.62      4653
           3       0.08      0.38      0.13       787
           4       0.08      0.60      0.13       118

    accuracy                           0.57     21967
   macro avg       0.44      0.54      0.42     21967
weighted avg       0.68      0.57      0.61     21967

trainingshape 20
(65779, 7)
(65779, 7, 1)
testingshape 20
(16445, 7)
(16445, 7, 1)
nb occurences
Counter({0: 28160, 1: 25152, 2: 10127, 3: 2340})
weights={0: 2.3359019886363637, 1: 2.6152592239185752, 2: 6.4954083144070305, 3: 28.11068376068376}
Model: "sequential_15"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_30 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_31 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_15 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_15 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
257/257 [==============================] - 2s 7ms/step - loss: 5.5004 - accuracy: 0.2999
Epoch 2/20
257/257 [==============================] - 2s 6ms/step - loss: 5.3551 - accuracy: 0.3781
Epoch 3/20
257/257 [==============================] - 2s 6ms/step - loss: 5.2077 - accuracy: 0.4271
Epoch 4/20
257/257 [==============================] - 2s 7ms/step - loss: 5.1492 - accuracy: 0.4383
Epoch 5/20
257/257 [==============================] - 2s 6ms/step - loss: 5.1051 - accuracy: 0.4269
Epoch 6/20
257/257 [==============================] - 2s 6ms/step - loss: 5.0661 - accuracy: 0.3894
Epoch 7/20
257/257 [==============================] - 2s 7ms/step - loss: 5.0348 - accuracy: 0.3735
Epoch 8/20
257/257 [==============================] - 2s 6ms/step - loss: 5.0048 - accuracy: 0.3628
Epoch 9/20
257/257 [==============================] - 2s 6ms/step - loss: 4.9850 - accuracy: 0.3688
Epoch 10/20
257/257 [==============================] - 2s 7ms/step - loss: 4.9667 - accuracy: 0.3640
Epoch 11/20
257/257 [==============================] - 2s 7ms/step - loss: 4.9561 - accuracy: 0.3566
Epoch 12/20
257/257 [==============================] - 2s 6ms/step - loss: 4.9454 - accuracy: 0.3616
Epoch 13/20
257/257 [==============================] - 2s 7ms/step - loss: 4.9348 - accuracy: 0.3515
Epoch 14/20
257/257 [==============================] - 2s 6ms/step - loss: 4.9288 - accuracy: 0.3776
Epoch 15/20
257/257 [==============================] - 2s 6ms/step - loss: 4.9244 - accuracy: 0.3563
Epoch 16/20
257/257 [==============================] - 2s 7ms/step - loss: 4.9141 - accuracy: 0.3666
Epoch 17/20
257/257 [==============================] - 2s 6ms/step - loss: 4.9067 - accuracy: 0.3671
Epoch 18/20
257/257 [==============================] - 2s 6ms/step - loss: 4.8991 - accuracy: 0.3813
Epoch 19/20
257/257 [==============================] - 2s 7ms/step - loss: 4.8959 - accuracy: 0.3684
Epoch 20/20
257/257 [==============================] - 2s 6ms/step - loss: 4.8914 - accuracy: 0.3654
65/65 [==============================] - 0s 2ms/step - loss: 1.2526 - accuracy: 0.2480


For 20: Test ACC=[1.2525527477264404, 0.24803891777992249]
Confusion Matrix
[[2459   31  691 3859]
 [ 920   93 1192 4083]
 [  95   37 1023 1377]
 [  18   16   47  504]]
Classification Report
              precision    recall  f1-score   support

           0       0.70      0.35      0.47      7040
           1       0.53      0.01      0.03      6288
           2       0.35      0.40      0.37      2532
           3       0.05      0.86      0.10       585

    accuracy                           0.25     16445
   macro avg       0.41      0.41      0.24     16445
weighted avg       0.56      0.25      0.27     16445

trainingshape 21
(32979, 7)
(32979, 7, 1)
testingshape 21
(8246, 7)
(8246, 7, 1)
nb occurences
Counter({0: 15448, 1: 12264, 2: 4012, 3: 1255})
weights={0: 2.1348394614189536, 1: 2.6890900195694716, 2: 8.220089730807576, 3: 26.27808764940239}
Model: "sequential_16"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_32 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_33 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_16 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_16 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
129/129 [==============================] - 1s 7ms/step - loss: 5.3777 - accuracy: 0.3894
Epoch 2/20
129/129 [==============================] - 1s 7ms/step - loss: 4.7477 - accuracy: 0.4047
Epoch 3/20
129/129 [==============================] - 1s 6ms/step - loss: 4.5915 - accuracy: 0.3929
Epoch 4/20
129/129 [==============================] - 1s 7ms/step - loss: 4.5651 - accuracy: 0.4020
Epoch 5/20
129/129 [==============================] - 1s 6ms/step - loss: 4.5405 - accuracy: 0.4013
Epoch 6/20
129/129 [==============================] - 1s 6ms/step - loss: 4.5206 - accuracy: 0.4183
Epoch 7/20
129/129 [==============================] - 1s 7ms/step - loss: 4.5087 - accuracy: 0.4184
Epoch 8/20
129/129 [==============================] - 1s 7ms/step - loss: 4.4995 - accuracy: 0.4285
Epoch 9/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4956 - accuracy: 0.4198
Epoch 10/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4756 - accuracy: 0.4325
Epoch 11/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4705 - accuracy: 0.4431
Epoch 12/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4601 - accuracy: 0.4385
Epoch 13/20
129/129 [==============================] - 1s 7ms/step - loss: 4.4506 - accuracy: 0.4452
Epoch 14/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4403 - accuracy: 0.4466
Epoch 15/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4317 - accuracy: 0.4520
Epoch 16/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4325 - accuracy: 0.4532
Epoch 17/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4214 - accuracy: 0.4622
Epoch 18/20
129/129 [==============================] - 1s 6ms/step - loss: 4.4129 - accuracy: 0.4584
Epoch 19/20
129/129 [==============================] - 1s 7ms/step - loss: 4.4040 - accuracy: 0.4812
Epoch 20/20
129/129 [==============================] - 1s 6ms/step - loss: 4.3957 - accuracy: 0.4678
33/33 [==============================] - 0s 2ms/step - loss: 1.0965 - accuracy: 0.4732


For 21: Test ACC=[1.09648597240448, 0.47319912910461426]
Confusion Matrix
[[2263  521  777  301]
 [ 346  881  501 1338]
 [ 172  149  582  101]
 [  21   58   59  176]]
Classification Report
              precision    recall  f1-score   support

           0       0.81      0.59      0.68      3862
           1       0.55      0.29      0.38      3066
           2       0.30      0.58      0.40      1004
           3       0.09      0.56      0.16       314

    accuracy                           0.47      8246
   macro avg       0.44      0.50      0.40      8246
weighted avg       0.62      0.47      0.51      8246

trainingshape 22
(83176, 7)
(83176, 7, 1)
testingshape 22
(20797, 7)
(20797, 7, 1)
nb occurences
Counter({0: 43650, 1: 29432, 2: 8406, 3: 1427, 4: 261})
weights={0: 1.905521191294387, 1: 2.8260396846969282, 2: 9.894837021175352, 3: 58.28731604765242, 4: 318.68199233716473}
Model: "sequential_17"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_34 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_35 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_17 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_17 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
325/325 [==============================] - 2s 7ms/step - loss: 7.9322 - accuracy: 0.2100
Epoch 2/20
325/325 [==============================] - 2s 7ms/step - loss: 7.7520 - accuracy: 0.1835
Epoch 3/20
325/325 [==============================] - 2s 7ms/step - loss: 7.6396 - accuracy: 0.2340
Epoch 4/20
325/325 [==============================] - 2s 7ms/step - loss: 7.5021 - accuracy: 0.2455
Epoch 5/20
325/325 [==============================] - 2s 6ms/step - loss: 7.3434 - accuracy: 0.3179
Epoch 6/20
325/325 [==============================] - 2s 7ms/step - loss: 7.2898 - accuracy: 0.3347
Epoch 7/20
325/325 [==============================] - 2s 7ms/step - loss: 7.2385 - accuracy: 0.3511
Epoch 8/20
325/325 [==============================] - 2s 7ms/step - loss: 7.1853 - accuracy: 0.3799
Epoch 9/20
325/325 [==============================] - 3s 8ms/step - loss: 7.1453 - accuracy: 0.3875
Epoch 10/20
325/325 [==============================] - 2s 8ms/step - loss: 7.0915 - accuracy: 0.3947
Epoch 11/20
325/325 [==============================] - 2s 7ms/step - loss: 7.0068 - accuracy: 0.4064
Epoch 12/20
325/325 [==============================] - 2s 7ms/step - loss: 6.8393 - accuracy: 0.4213
Epoch 13/20
325/325 [==============================] - 2s 7ms/step - loss: 6.6091 - accuracy: 0.4415
Epoch 14/20
325/325 [==============================] - 2s 7ms/step - loss: 6.5089 - accuracy: 0.4366
Epoch 15/20
325/325 [==============================] - 2s 7ms/step - loss: 6.4129 - accuracy: 0.4298
Epoch 16/20
325/325 [==============================] - 2s 7ms/step - loss: 6.3391 - accuracy: 0.4321
Epoch 17/20
325/325 [==============================] - 2s 7ms/step - loss: 6.2915 - accuracy: 0.4295
Epoch 18/20
325/325 [==============================] - 2s 7ms/step - loss: 6.2513 - accuracy: 0.4238
Epoch 19/20
325/325 [==============================] - 2s 7ms/step - loss: 6.1878 - accuracy: 0.4266
Epoch 20/20
325/325 [==============================] - 2s 7ms/step - loss: 6.1479 - accuracy: 0.4239
82/82 [==============================] - 0s 2ms/step - loss: 1.4180 - accuracy: 0.3673


For 22: Test ACC=[1.4179526567459106, 0.36731258034706116]
Confusion Matrix
[[4380 1084 2045 2749  655]
 [ 963 2452 1813 1600  531]
 [ 221  471  535  709  166]
 [  16   46   53  223   19]
 [   0    1    2   14   49]]
Classification Report
              precision    recall  f1-score   support

           0       0.78      0.40      0.53     10913
           1       0.60      0.33      0.43      7359
           2       0.12      0.25      0.16      2102
           3       0.04      0.62      0.08       357
           4       0.03      0.74      0.07        66

    accuracy                           0.37     20797
   macro avg       0.32      0.47      0.25     20797
weighted avg       0.64      0.37      0.45     20797

trainingshape 23
(25894, 7)
(25894, 7, 1)
testingshape 23
(6476, 7)
(6476, 7, 1)
nb occurences
Counter({0: 13320, 1: 9676, 2: 2437, 3: 461})
weights={0: 1.9439939939939939, 1: 2.6761058288548987, 2: 10.625359048009848, 3: 56.16919739696313}
Model: "sequential_18"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_36 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_37 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_18 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_18 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
102/102 [==============================] - 1s 7ms/step - loss: 5.4976 - accuracy: 0.2527
Epoch 2/20
102/102 [==============================] - 1s 6ms/step - loss: 5.4446 - accuracy: 0.3319
Epoch 3/20
102/102 [==============================] - 1s 7ms/step - loss: 5.4157 - accuracy: 0.3729
Epoch 4/20
102/102 [==============================] - 1s 6ms/step - loss: 5.3877 - accuracy: 0.3934
Epoch 5/20
102/102 [==============================] - 1s 7ms/step - loss: 5.3630 - accuracy: 0.3832
Epoch 6/20
102/102 [==============================] - 1s 6ms/step - loss: 5.3405 - accuracy: 0.4042
Epoch 7/20
102/102 [==============================] - 1s 6ms/step - loss: 5.3197 - accuracy: 0.4064
Epoch 8/20
102/102 [==============================] - 1s 6ms/step - loss: 5.3040 - accuracy: 0.4270
Epoch 9/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2822 - accuracy: 0.4003
Epoch 10/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2634 - accuracy: 0.4272
Epoch 11/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2450 - accuracy: 0.4261
Epoch 12/20
102/102 [==============================] - 1s 7ms/step - loss: 5.2370 - accuracy: 0.4264
Epoch 13/20
102/102 [==============================] - 1s 7ms/step - loss: 5.2279 - accuracy: 0.4311
Epoch 14/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2310 - accuracy: 0.4212
Epoch 15/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2176 - accuracy: 0.4326
Epoch 16/20
102/102 [==============================] - 1s 6ms/step - loss: 5.2053 - accuracy: 0.4345
Epoch 17/20
102/102 [==============================] - 1s 6ms/step - loss: 5.1980 - accuracy: 0.4416
Epoch 18/20
102/102 [==============================] - 1s 6ms/step - loss: 5.1916 - accuracy: 0.4357
Epoch 19/20
102/102 [==============================] - 1s 7ms/step - loss: 5.2017 - accuracy: 0.4324
Epoch 20/20
102/102 [==============================] - 1s 7ms/step - loss: 5.1828 - accuracy: 0.4410
26/26 [==============================] - 0s 2ms/step - loss: 1.3276 - accuracy: 0.3947


For 23: Test ACC=[1.3275837898254395, 0.39468806982040405]
Confusion Matrix
[[ 978  658 1567  128]
 [ 274 1146  898  101]
 [  36  139  415   20]
 [  20   26   53   17]]
Classification Report
              precision    recall  f1-score   support

           0       0.75      0.29      0.42      3331
           1       0.58      0.47      0.52      2419
           2       0.14      0.68      0.23       610
           3       0.06      0.15      0.09       116

    accuracy                           0.39      6476
   macro avg       0.38      0.40      0.32      6476
weighted avg       0.62      0.39      0.44      6476

trainingshape 24
(101424, 7)
(101424, 7, 1)
testingshape 24
(25359, 7)
(25359, 7, 1)
nb occurences
Counter({0: 42648, 1: 28168, 2: 23370, 3: 6354, 4: 884})
weights={0: 2.37816544738323, 1: 3.6006816245384834, 2: 4.33992297817715, 3: 15.96222851746931, 4: 114.73303167420815}
Model: "sequential_19"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_38 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_39 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_19 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_19 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
397/397 [==============================] - 3s 7ms/step - loss: 7.9722 - accuracy: 0.2456
Epoch 2/20
397/397 [==============================] - 3s 7ms/step - loss: 7.7366 - accuracy: 0.3310
Epoch 3/20
397/397 [==============================] - 3s 6ms/step - loss: 7.4590 - accuracy: 0.3090
Epoch 4/20
397/397 [==============================] - 3s 7ms/step - loss: 7.2749 - accuracy: 0.3147
Epoch 5/20
397/397 [==============================] - 3s 6ms/step - loss: 7.2020 - accuracy: 0.3119
Epoch 6/20
397/397 [==============================] - 3s 7ms/step - loss: 7.1412 - accuracy: 0.3310
Epoch 7/20
397/397 [==============================] - 3s 6ms/step - loss: 7.0801 - accuracy: 0.3359
Epoch 8/20
397/397 [==============================] - 3s 7ms/step - loss: 6.9997 - accuracy: 0.3340
Epoch 9/20
397/397 [==============================] - 3s 7ms/step - loss: 6.9056 - accuracy: 0.3614
Epoch 10/20
397/397 [==============================] - 3s 6ms/step - loss: 6.8305 - accuracy: 0.3567
Epoch 11/20
397/397 [==============================] - 3s 7ms/step - loss: 6.7732 - accuracy: 0.3668
Epoch 12/20
397/397 [==============================] - 3s 6ms/step - loss: 6.7187 - accuracy: 0.3859
Epoch 13/20
397/397 [==============================] - 3s 7ms/step - loss: 6.6670 - accuracy: 0.3846
Epoch 14/20
397/397 [==============================] - 3s 6ms/step - loss: 6.6211 - accuracy: 0.4005
Epoch 15/20
397/397 [==============================] - 3s 7ms/step - loss: 6.5725 - accuracy: 0.4098
Epoch 16/20
397/397 [==============================] - 3s 6ms/step - loss: 6.5341 - accuracy: 0.4075
Epoch 17/20
397/397 [==============================] - 3s 7ms/step - loss: 6.4827 - accuracy: 0.4197
Epoch 18/20
397/397 [==============================] - 3s 6ms/step - loss: 6.4454 - accuracy: 0.4163
Epoch 19/20
397/397 [==============================] - 3s 7ms/step - loss: 6.3899 - accuracy: 0.4258
Epoch 20/20
397/397 [==============================] - 3s 6ms/step - loss: 6.3700 - accuracy: 0.4261
100/100 [==============================] - 0s 2ms/step - loss: 1.2716 - accuracy: 0.4852


For 24: Test ACC=[1.2716138362884521, 0.48523205518722534]
Confusion Matrix
[[5322  610 1982 2341  408]
 [1386 3772  776  814  295]
 [1828  533 2156 1003  323]
 [ 185   96  267  948   93]
 [  31   18   34   31  107]]
Classification Report
              precision    recall  f1-score   support

           0       0.61      0.50      0.55     10663
           1       0.75      0.54      0.62      7043
           2       0.41      0.37      0.39      5843
           3       0.18      0.60      0.28      1589
           4       0.09      0.48      0.15       221

    accuracy                           0.49     25359
   macro avg       0.41      0.50      0.40     25359
weighted avg       0.57      0.49      0.51     25359

trainingshape 25
(40952, 7)
(40952, 7, 1)
testingshape 25
(10239, 7)
(10239, 7, 1)
nb occurences
Counter({0: 15332, 1: 13630, 2: 9243, 3: 2747})
weights={0: 2.671014870858335, 1: 3.0045487894350695, 2: 4.430596126798658, 3: 14.907899526756461}
Model: "sequential_20"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_40 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_41 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_20 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_20 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
160/160 [==============================] - 1s 8ms/step - loss: 5.7728 - accuracy: 0.1879
Epoch 2/20
160/160 [==============================] - 1s 8ms/step - loss: 5.4784 - accuracy: 0.2763
Epoch 3/20
160/160 [==============================] - 1s 7ms/step - loss: 5.3841 - accuracy: 0.2842
Epoch 4/20
160/160 [==============================] - 1s 7ms/step - loss: 5.3238 - accuracy: 0.2912
Epoch 5/20
160/160 [==============================] - 1s 7ms/step - loss: 5.2795 - accuracy: 0.2983
Epoch 6/20
160/160 [==============================] - 1s 7ms/step - loss: 5.2419 - accuracy: 0.3115
Epoch 7/20
160/160 [==============================] - 1s 7ms/step - loss: 5.2167 - accuracy: 0.3144
Epoch 8/20
160/160 [==============================] - 1s 6ms/step - loss: 5.1986 - accuracy: 0.3183
Epoch 9/20
160/160 [==============================] - 1s 7ms/step - loss: 5.1930 - accuracy: 0.3237
Epoch 10/20
160/160 [==============================] - 2s 11ms/step - loss: 5.1795 - accuracy: 0.3218
Epoch 11/20
160/160 [==============================] - 1s 8ms/step - loss: 5.1672 - accuracy: 0.3304
Epoch 12/20
160/160 [==============================] - 1s 8ms/step - loss: 5.1512 - accuracy: 0.3371
Epoch 13/20
160/160 [==============================] - 1s 7ms/step - loss: 5.1428 - accuracy: 0.3288
Epoch 14/20
160/160 [==============================] - 1s 7ms/step - loss: 5.1311 - accuracy: 0.3339
Epoch 15/20
160/160 [==============================] - 1s 7ms/step - loss: 5.1235 - accuracy: 0.3349
Epoch 16/20
160/160 [==============================] - 1s 7ms/step - loss: 5.1074 - accuracy: 0.3309
Epoch 17/20
160/160 [==============================] - 1s 7ms/step - loss: 5.0995 - accuracy: 0.3344
Epoch 18/20
160/160 [==============================] - 1s 8ms/step - loss: 5.0868 - accuracy: 0.3420
Epoch 19/20
160/160 [==============================] - 1s 7ms/step - loss: 5.0711 - accuracy: 0.3347
Epoch 20/20
160/160 [==============================] - 1s 7ms/step - loss: 5.0531 - accuracy: 0.3565
40/40 [==============================] - 0s 2ms/step - loss: 1.2968 - accuracy: 0.3336


For 25: Test ACC=[1.296799898147583, 0.33362632989883423]
Confusion Matrix
[[1005  161 2159  508]
 [ 596  519 1760  533]
 [ 124  231 1595  361]
 [  19   69  302  297]]
Classification Report
              precision    recall  f1-score   support

           0       0.58      0.26      0.36      3833
           1       0.53      0.15      0.24      3408
           2       0.27      0.69      0.39      2311
           3       0.17      0.43      0.25       687

    accuracy                           0.33     10239
   macro avg       0.39      0.38      0.31     10239
weighted avg       0.47      0.33      0.32     10239

trainingshape 26
(50087, 7)
(50087, 7, 1)
testingshape 26
(12524, 7)
(12524, 7, 1)
nb occurences
Counter({0: 21706, 1: 17573, 2: 8352, 3: 2079, 4: 377})
weights={0: 2.307518658435456, 1: 2.850224776645991, 2: 5.997006704980842, 3: 24.09187109187109, 4: 132.85676392572944}
Model: "sequential_21"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_42 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_43 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_21 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_21 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
196/196 [==============================] - 1s 7ms/step - loss: 8.1046 - accuracy: 0.1547
Epoch 2/20
196/196 [==============================] - 1s 7ms/step - loss: 7.9337 - accuracy: 0.2449
Epoch 3/20
196/196 [==============================] - 1s 7ms/step - loss: 7.7519 - accuracy: 0.3296
Epoch 4/20
196/196 [==============================] - 1s 7ms/step - loss: 7.6351 - accuracy: 0.3066
Epoch 5/20
196/196 [==============================] - 1s 7ms/step - loss: 7.5200 - accuracy: 0.2971
Epoch 6/20
196/196 [==============================] - 1s 7ms/step - loss: 7.3604 - accuracy: 0.2968
Epoch 7/20
196/196 [==============================] - 1s 7ms/step - loss: 7.2440 - accuracy: 0.2969
Epoch 8/20
196/196 [==============================] - 1s 7ms/step - loss: 7.1400 - accuracy: 0.3084
Epoch 9/20
196/196 [==============================] - 1s 7ms/step - loss: 7.1055 - accuracy: 0.3089
Epoch 10/20
196/196 [==============================] - 1s 7ms/step - loss: 7.0141 - accuracy: 0.3214
Epoch 11/20
196/196 [==============================] - 1s 7ms/step - loss: 6.9992 - accuracy: 0.3267
Epoch 12/20
196/196 [==============================] - 1s 7ms/step - loss: 6.9375 - accuracy: 0.3421
Epoch 13/20
196/196 [==============================] - 1s 7ms/step - loss: 6.8821 - accuracy: 0.3482
Epoch 14/20
196/196 [==============================] - 1s 7ms/step - loss: 6.8466 - accuracy: 0.3645
Epoch 15/20
196/196 [==============================] - 1s 7ms/step - loss: 6.8286 - accuracy: 0.3623
Epoch 16/20
196/196 [==============================] - 1s 7ms/step - loss: 6.7543 - accuracy: 0.3800
Epoch 17/20
196/196 [==============================] - 1s 7ms/step - loss: 6.7564 - accuracy: 0.3892
Epoch 18/20
196/196 [==============================] - 1s 7ms/step - loss: 6.6929 - accuracy: 0.3942
Epoch 19/20
196/196 [==============================] - 1s 7ms/step - loss: 6.6679 - accuracy: 0.3979
Epoch 20/20
196/196 [==============================] - 1s 7ms/step - loss: 6.6814 - accuracy: 0.4021
49/49 [==============================] - 0s 2ms/step - loss: 1.3696 - accuracy: 0.4222


For 26: Test ACC=[1.3696476221084595, 0.4222293198108673]
Confusion Matrix
[[2443 1010  459 1073  442]
 [ 916 2079  215  673  511]
 [ 451  363  389  471  414]
 [  55   74   40  319   32]
 [   6   23    4    4   58]]
Classification Report
              precision    recall  f1-score   support

           0       0.63      0.45      0.53      5427
           1       0.59      0.47      0.52      4394
           2       0.35      0.19      0.24      2088
           3       0.13      0.61      0.21       520
           4       0.04      0.61      0.07        95

    accuracy                           0.42     12524
   macro avg       0.35      0.47      0.32     12524
weighted avg       0.54      0.42      0.46     12524

trainingshape 27
(68049, 7)
(68049, 7, 1)
testingshape 27
(17015, 7)
(17015, 7, 1)
nb occurences
Counter({0: 29756, 1: 21742, 2: 13276, 3: 3101, 4: 174})
weights={0: 2.2869001209840034, 1: 3.1298408610063473, 2: 5.125715576981018, 3: 21.94421154466301, 4: 391.08620689655174}
Model: "sequential_22"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_44 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_45 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_22 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_22 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
266/266 [==============================] - 2s 7ms/step - loss: 8.0549 - accuracy: 0.1447
Epoch 2/20
266/266 [==============================] - 2s 7ms/step - loss: 7.8547 - accuracy: 0.3034
Epoch 3/20
266/266 [==============================] - 2s 7ms/step - loss: 7.6255 - accuracy: 0.3053
Epoch 4/20
266/266 [==============================] - 2s 7ms/step - loss: 7.4930 - accuracy: 0.3167
Epoch 5/20
266/266 [==============================] - 2s 7ms/step - loss: 7.4013 - accuracy: 0.3063
Epoch 6/20
266/266 [==============================] - 2s 7ms/step - loss: 7.2752 - accuracy: 0.3117
Epoch 7/20
266/266 [==============================] - 2s 7ms/step - loss: 7.1704 - accuracy: 0.3243
Epoch 8/20
266/266 [==============================] - 2s 7ms/step - loss: 7.0623 - accuracy: 0.3309
Epoch 9/20
266/266 [==============================] - 2s 7ms/step - loss: 6.9486 - accuracy: 0.3425
Epoch 10/20
266/266 [==============================] - 3s 10ms/step - loss: 6.8240 - accuracy: 0.3586
Epoch 11/20
266/266 [==============================] - 2s 7ms/step - loss: 6.7172 - accuracy: 0.3688
Epoch 12/20
266/266 [==============================] - 2s 7ms/step - loss: 6.6253 - accuracy: 0.3745
Epoch 13/20
266/266 [==============================] - 2s 7ms/step - loss: 6.5311 - accuracy: 0.3911
Epoch 14/20
266/266 [==============================] - 2s 7ms/step - loss: 6.4627 - accuracy: 0.3989
Epoch 15/20
266/266 [==============================] - 2s 7ms/step - loss: 6.4029 - accuracy: 0.4224
Epoch 16/20
266/266 [==============================] - 2s 7ms/step - loss: 6.3277 - accuracy: 0.4445
Epoch 17/20
266/266 [==============================] - 2s 7ms/step - loss: 6.2706 - accuracy: 0.4686
Epoch 18/20
266/266 [==============================] - 2s 7ms/step - loss: 6.1706 - accuracy: 0.5000
Epoch 19/20
266/266 [==============================] - 2s 7ms/step - loss: 6.0518 - accuracy: 0.5223
Epoch 20/20
266/266 [==============================] - 2s 7ms/step - loss: 5.9465 - accuracy: 0.5294
67/67 [==============================] - 0s 2ms/step - loss: 1.2097 - accuracy: 0.5262


For 27: Test ACC=[1.2096786499023438, 0.5262415409088135]
Confusion Matrix
[[3977 2013  161  871  418]
 [ 708 3100  446  885  297]
 [ 262  695 1516  711  135]
 [  22  208  155  335   56]
 [   2   11    1    4   26]]
Classification Report
              precision    recall  f1-score   support

           0       0.80      0.53      0.64      7440
           1       0.51      0.57      0.54      5436
           2       0.67      0.46      0.54      3319
           3       0.12      0.43      0.19       776
           4       0.03      0.59      0.05        44

    accuracy                           0.53     17015
   macro avg       0.43      0.52      0.39     17015
weighted avg       0.65      0.53      0.57     17015

trainingshape 28
(22896, 7)
(22896, 7, 1)
testingshape 28
(5726, 7)
(5726, 7, 1)
nb occurences
Counter({0: 10764, 1: 7462, 2: 3882, 3: 788})
weights={0: 2.1270903010033444, 1: 3.068346287858483, 2: 5.897990726429676, 3: 29.055837563451774}
Model: "sequential_23"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_46 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_47 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_23 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_23 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
90/90 [==============================] - 1s 7ms/step - loss: 5.4928 - accuracy: 0.2352
Epoch 2/20
90/90 [==============================] - 1s 7ms/step - loss: 5.3021 - accuracy: 0.2801
Epoch 3/20
90/90 [==============================] - 1s 7ms/step - loss: 5.1912 - accuracy: 0.2693
Epoch 4/20
90/90 [==============================] - 1s 7ms/step - loss: 5.0911 - accuracy: 0.3313
Epoch 5/20
90/90 [==============================] - 1s 7ms/step - loss: 4.9620 - accuracy: 0.3537
Epoch 6/20
90/90 [==============================] - 1s 7ms/step - loss: 4.8839 - accuracy: 0.3821
Epoch 7/20
90/90 [==============================] - 1s 8ms/step - loss: 4.8322 - accuracy: 0.4058
Epoch 8/20
90/90 [==============================] - 1s 9ms/step - loss: 4.7795 - accuracy: 0.4284
Epoch 9/20
90/90 [==============================] - 1s 8ms/step - loss: 4.7379 - accuracy: 0.4316
Epoch 10/20
90/90 [==============================] - 1s 8ms/step - loss: 4.6919 - accuracy: 0.4384
Epoch 11/20
90/90 [==============================] - 1s 7ms/step - loss: 4.6495 - accuracy: 0.4438
Epoch 12/20
90/90 [==============================] - 1s 7ms/step - loss: 4.6045 - accuracy: 0.4510
Epoch 13/20
90/90 [==============================] - 1s 7ms/step - loss: 4.5645 - accuracy: 0.4579
Epoch 14/20
90/90 [==============================] - 1s 8ms/step - loss: 4.5231 - accuracy: 0.4608
Epoch 15/20
90/90 [==============================] - 1s 8ms/step - loss: 4.4782 - accuracy: 0.4721
Epoch 16/20
90/90 [==============================] - 1s 7ms/step - loss: 4.4459 - accuracy: 0.4757
Epoch 17/20
90/90 [==============================] - 1s 7ms/step - loss: 4.4096 - accuracy: 0.4843
Epoch 18/20
90/90 [==============================] - 1s 7ms/step - loss: 4.3756 - accuracy: 0.4934
Epoch 19/20
90/90 [==============================] - 1s 7ms/step - loss: 4.3488 - accuracy: 0.5055
Epoch 20/20
90/90 [==============================] - 1s 7ms/step - loss: 4.3017 - accuracy: 0.5214
23/23 [==============================] - 0s 2ms/step - loss: 1.1268 - accuracy: 0.5164


For 28: Test ACC=[1.1268353462219238, 0.5164163708686829]
Confusion Matrix
[[1364  511  662  154]
 [ 337  865  545  119]
 [ 132  182  624   33]
 [   8   43   43  104]]
Classification Report
              precision    recall  f1-score   support

           0       0.74      0.51      0.60      2691
           1       0.54      0.46      0.50      1866
           2       0.33      0.64      0.44       971
           3       0.25      0.53      0.34       198

    accuracy                           0.52      5726
   macro avg       0.47      0.53      0.47      5726
weighted avg       0.59      0.52      0.53      5726

trainingshape 29
(65069, 7)
(65069, 7, 1)
testingshape 29
(16268, 7)
(16268, 7, 1)
nb occurences
Counter({0: 35284, 1: 17194, 2: 11268, 3: 1103, 4: 220})
weights={0: 1.84415032309262, 1: 3.7844015354193323, 2: 5.774671636492723, 3: 58.99274705349048, 4: 295.7681818181818}
Model: "sequential_24"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_48 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_49 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_24 (Dense)             (None, 5)                 45
_________________________________________________________________
activation_24 (Activation)   (None, 5)                 0
=================================================================
Total params: 741
Trainable params: 741
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
255/255 [==============================] - 2s 7ms/step - loss: 7.7248 - accuracy: 0.0763
Epoch 2/20
255/255 [==============================] - 2s 7ms/step - loss: 6.9207 - accuracy: 0.2563
Epoch 3/20
255/255 [==============================] - 2s 7ms/step - loss: 6.7279 - accuracy: 0.2928
Epoch 4/20
255/255 [==============================] - 2s 7ms/step - loss: 6.6544 - accuracy: 0.2924
Epoch 5/20
255/255 [==============================] - 2s 7ms/step - loss: 6.6121 - accuracy: 0.2887
Epoch 6/20
255/255 [==============================] - 2s 7ms/step - loss: 6.5547 - accuracy: 0.3158
Epoch 7/20
255/255 [==============================] - 2s 7ms/step - loss: 6.4840 - accuracy: 0.3485
Epoch 8/20
255/255 [==============================] - 2s 7ms/step - loss: 6.4170 - accuracy: 0.3178
Epoch 9/20
255/255 [==============================] - 2s 7ms/step - loss: 6.3438 - accuracy: 0.3749
Epoch 10/20
255/255 [==============================] - 2s 7ms/step - loss: 6.2728 - accuracy: 0.4247
Epoch 11/20
255/255 [==============================] - 2s 7ms/step - loss: 6.1994 - accuracy: 0.4286
Epoch 12/20
255/255 [==============================] - 2s 7ms/step - loss: 6.1113 - accuracy: 0.4532
Epoch 13/20
255/255 [==============================] - 2s 7ms/step - loss: 6.0246 - accuracy: 0.4498
Epoch 14/20
255/255 [==============================] - 2s 7ms/step - loss: 5.9242 - accuracy: 0.4642
Epoch 15/20
255/255 [==============================] - 2s 7ms/step - loss: 5.8603 - accuracy: 0.4679
Epoch 16/20
255/255 [==============================] - 2s 7ms/step - loss: 5.7688 - accuracy: 0.4731
Epoch 17/20
255/255 [==============================] - 2s 7ms/step - loss: 5.6853 - accuracy: 0.4754
Epoch 18/20
255/255 [==============================] - 2s 7ms/step - loss: 5.5997 - accuracy: 0.4884
Epoch 19/20
255/255 [==============================] - 2s 7ms/step - loss: 5.5319 - accuracy: 0.4817
Epoch 20/20
255/255 [==============================] - 2s 7ms/step - loss: 5.4928 - accuracy: 0.4876
64/64 [==============================] - 0s 2ms/step - loss: 1.2248 - accuracy: 0.5125


For 29: Test ACC=[1.224769949913025, 0.5124784708023071]
Confusion Matrix
[[4264 2123  858 1416  160]
 [ 746 2458  390  616   89]
 [ 695  419 1452  219   32]
 [  29   94   26  112   15]
 [   0    2    0    2   51]]
Classification Report
              precision    recall  f1-score   support

           0       0.74      0.48      0.59      8821
           1       0.48      0.57      0.52      4299
           2       0.53      0.52      0.52      2817
           3       0.05      0.41      0.08       276
           4       0.15      0.93      0.25        55

    accuracy                           0.51     16268
   macro avg       0.39      0.58      0.39     16268
weighted avg       0.62      0.51      0.55     16268

trainingshape 30
(21093, 7)
(21093, 7, 1)
testingshape 30
(5275, 7)
(5275, 7, 1)
nb occurences
Counter({0: 12405, 1: 4860, 2: 3438, 3: 390})
weights={0: 1.7003627569528417, 1: 4.340123456790123, 2: 6.135253054101222, 3: 54.08461538461538}
Model: "sequential_25"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_50 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_51 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_25 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_25 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
83/83 [==============================] - 1s 8ms/step - loss: 5.3759 - accuracy: 0.4115
Epoch 2/20
83/83 [==============================] - 1s 7ms/step - loss: 5.0066 - accuracy: 0.5187
Epoch 3/20
83/83 [==============================] - 1s 7ms/step - loss: 4.7817 - accuracy: 0.6426
Epoch 4/20
83/83 [==============================] - 1s 7ms/step - loss: 4.6475 - accuracy: 0.6394
Epoch 5/20
83/83 [==============================] - 1s 7ms/step - loss: 4.5410 - accuracy: 0.6468
Epoch 6/20
83/83 [==============================] - 1s 7ms/step - loss: 4.4871 - accuracy: 0.6373
Epoch 7/20
83/83 [==============================] - 1s 7ms/step - loss: 4.4531 - accuracy: 0.6538
Epoch 8/20
83/83 [==============================] - 1s 7ms/step - loss: 4.4262 - accuracy: 0.6295
Epoch 9/20
83/83 [==============================] - 1s 8ms/step - loss: 4.3972 - accuracy: 0.6551
Epoch 10/20
83/83 [==============================] - 1s 7ms/step - loss: 4.3723 - accuracy: 0.6579
Epoch 11/20
83/83 [==============================] - 1s 7ms/step - loss: 4.3519 - accuracy: 0.6417
Epoch 12/20
83/83 [==============================] - 1s 7ms/step - loss: 4.3253 - accuracy: 0.6515
Epoch 13/20
83/83 [==============================] - 1s 7ms/step - loss: 4.3060 - accuracy: 0.6526
Epoch 14/20
83/83 [==============================] - 1s 7ms/step - loss: 4.2849 - accuracy: 0.6420
Epoch 15/20
83/83 [==============================] - 1s 7ms/step - loss: 4.2665 - accuracy: 0.6418
Epoch 16/20
83/83 [==============================] - 1s 7ms/step - loss: 4.2477 - accuracy: 0.6443
Epoch 17/20
83/83 [==============================] - 1s 7ms/step - loss: 4.2308 - accuracy: 0.6455
Epoch 18/20
83/83 [==============================] - 1s 8ms/step - loss: 4.2120 - accuracy: 0.6283
Epoch 19/20
83/83 [==============================] - 1s 7ms/step - loss: 4.1938 - accuracy: 0.6414
Epoch 20/20
83/83 [==============================] - 1s 7ms/step - loss: 4.1753 - accuracy: 0.6479
21/21 [==============================] - 0s 2ms/step - loss: 0.9673 - accuracy: 0.6317


For 30: Test ACC=[0.9672988653182983, 0.6316587924957275]
Confusion Matrix
[[2180  488  197  237]
 [  93  544  389  189]
 [  20  181  561   98]
 [   3   31   17   47]]
Classification Report
              precision    recall  f1-score   support

           0       0.95      0.70      0.81      3102
           1       0.44      0.45      0.44      1215
           2       0.48      0.65      0.55       860
           3       0.08      0.48      0.14        98

    accuracy                           0.63      5275
   macro avg       0.49      0.57      0.49      5275
weighted avg       0.74      0.63      0.67      5275

trainingshape 31
(48768, 7)
(48768, 7, 1)
testingshape 31
(12195, 7)
(12195, 7, 1)
nb occurences
Counter({0: 27244, 1: 15837, 2: 5224, 3: 463})
weights={0: 1.790045514608721, 1: 3.0793710930100398, 2: 9.335375191424196, 3: 105.33045356371491}
Model: "sequential_26"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_52 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_53 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_26 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_26 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
191/191 [==============================] - 1s 7ms/step - loss: 5.4932 - accuracy: 0.3406
Epoch 2/20
191/191 [==============================] - 1s 7ms/step - loss: 5.3491 - accuracy: 0.4271
Epoch 3/20
191/191 [==============================] - 1s 7ms/step - loss: 5.1879 - accuracy: 0.4413
Epoch 4/20
191/191 [==============================] - 1s 7ms/step - loss: 5.0865 - accuracy: 0.4148
Epoch 5/20
191/191 [==============================] - 1s 7ms/step - loss: 5.0335 - accuracy: 0.4486
Epoch 6/20
191/191 [==============================] - 1s 7ms/step - loss: 5.0008 - accuracy: 0.4260
Epoch 7/20
191/191 [==============================] - 1s 7ms/step - loss: 4.9603 - accuracy: 0.4265
Epoch 8/20
191/191 [==============================] - 1s 7ms/step - loss: 4.9203 - accuracy: 0.4223
Epoch 9/20
191/191 [==============================] - 1s 7ms/step - loss: 4.8778 - accuracy: 0.4390
Epoch 10/20
191/191 [==============================] - 1s 7ms/step - loss: 4.8500 - accuracy: 0.4128
Epoch 11/20
191/191 [==============================] - 1s 7ms/step - loss: 4.8123 - accuracy: 0.4326
Epoch 12/20
191/191 [==============================] - 1s 7ms/step - loss: 4.7840 - accuracy: 0.4371
Epoch 13/20
191/191 [==============================] - 1s 8ms/step - loss: 4.7549 - accuracy: 0.4284
Epoch 14/20
191/191 [==============================] - 1s 7ms/step - loss: 4.7381 - accuracy: 0.4350
Epoch 15/20
191/191 [==============================] - 1s 7ms/step - loss: 4.7257 - accuracy: 0.4413
Epoch 16/20
191/191 [==============================] - 1s 7ms/step - loss: 4.6927 - accuracy: 0.4437
Epoch 17/20
191/191 [==============================] - 1s 7ms/step - loss: 4.6793 - accuracy: 0.4489
Epoch 18/20
191/191 [==============================] - 1s 7ms/step - loss: 4.6643 - accuracy: 0.4373
Epoch 19/20
191/191 [==============================] - 1s 7ms/step - loss: 4.6517 - accuracy: 0.4549
Epoch 20/20
191/191 [==============================] - 1s 7ms/step - loss: 4.6339 - accuracy: 0.4527
48/48 [==============================] - 0s 2ms/step - loss: 1.2654 - accuracy: 0.3430


For 31: Test ACC=[1.2654131650924683, 0.34300944209098816]
Confusion Matrix
[[2126  750 1814 2122]
 [ 514 1276  659 1511]
 [ 223  113  713  258]
 [  23   14   11   68]]
Classification Report
              precision    recall  f1-score   support

           0       0.74      0.31      0.44      6812
           1       0.59      0.32      0.42      3960
           2       0.22      0.55      0.32      1307
           3       0.02      0.59      0.03       116

    accuracy                           0.34     12195
   macro avg       0.39      0.44      0.30     12195
weighted avg       0.63      0.34      0.41     12195

trainingshape 32
(36088, 7)
(36088, 7, 1)
testingshape 32
(9024, 7)
(9024, 7, 1)
nb occurences
Counter({0: 22150, 1: 10231, 2: 3491, 3: 216})
weights={0: 1.629255079006772, 1: 3.5273189326556547, 2: 10.337439129189343, 3: 167.07407407407408}
Model: "sequential_27"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_54 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_55 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_27 (Dense)             (None, 4)                 36
_________________________________________________________________
activation_27 (Activation)   (None, 4)                 0
=================================================================
Total params: 732
Trainable params: 732
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
141/141 [==============================] - 1s 8ms/step - loss: 5.5148 - accuracy: 0.3556
Epoch 2/20
141/141 [==============================] - 1s 8ms/step - loss: 5.4230 - accuracy: 0.4608
Epoch 3/20
141/141 [==============================] - 1s 7ms/step - loss: 5.3193 - accuracy: 0.3496
Epoch 4/20
141/141 [==============================] - 1s 8ms/step - loss: 5.2199 - accuracy: 0.3985
Epoch 5/20
141/141 [==============================] - 1s 7ms/step - loss: 5.1396 - accuracy: 0.2575
Epoch 6/20
141/141 [==============================] - 1s 7ms/step - loss: 5.0690 - accuracy: 0.2455
Epoch 7/20
141/141 [==============================] - 1s 7ms/step - loss: 5.0196 - accuracy: 0.2493
Epoch 8/20
141/141 [==============================] - 1s 7ms/step - loss: 4.9802 - accuracy: 0.2554
Epoch 9/20
141/141 [==============================] - 1s 7ms/step - loss: 4.9422 - accuracy: 0.2596
Epoch 10/20
141/141 [==============================] - 1s 7ms/step - loss: 4.9157 - accuracy: 0.2751
Epoch 11/20
141/141 [==============================] - 1s 7ms/step - loss: 4.8810 - accuracy: 0.2654
Epoch 12/20
141/141 [==============================] - 1s 7ms/step - loss: 4.8617 - accuracy: 0.2439
Epoch 13/20
141/141 [==============================] - 1s 7ms/step - loss: 4.8383 - accuracy: 0.2792
Epoch 14/20
141/141 [==============================] - 1s 7ms/step - loss: 4.8071 - accuracy: 0.2309
Epoch 15/20
141/141 [==============================] - 1s 7ms/step - loss: 4.7765 - accuracy: 0.3250
Epoch 16/20
141/141 [==============================] - 1s 7ms/step - loss: 4.7434 - accuracy: 0.2980
Epoch 17/20
141/141 [==============================] - 1s 7ms/step - loss: 4.6982 - accuracy: 0.3754
Epoch 18/20
141/141 [==============================] - 1s 7ms/step - loss: 4.6480 - accuracy: 0.3622
Epoch 19/20
141/141 [==============================] - 1s 7ms/step - loss: 4.6039 - accuracy: 0.4327
Epoch 20/20
141/141 [==============================] - 1s 7ms/step - loss: 4.5606 - accuracy: 0.4800
36/36 [==============================] - 0s 2ms/step - loss: 1.1329 - accuracy: 0.6482


For 32: Test ACC=[1.1329398155212402, 0.648160457611084]
Confusion Matrix
[[5091  185   11  251]
 [1729  705   49   75]
 [ 691  144   21   17]
 [  20    3    0   32]]
Classification Report
              precision    recall  f1-score   support

           0       0.68      0.92      0.78      5538
           1       0.68      0.28      0.39      2558
           2       0.26      0.02      0.04       873
           3       0.09      0.58      0.15        55

    accuracy                           0.65      9024
   macro avg       0.43      0.45      0.34      9024
weighted avg       0.63      0.65      0.59      9024

trainingshape 33
(17950, 7)
(17950, 7, 1)
testingshape 33
(4489, 7)
(4489, 7, 1)
nb occurences
Counter({0: 11318, 1: 5432, 2: 1200})
weights={0: 1.5859692525181128, 1: 3.3044918998527244, 2: 14.958333333333334}
Model: "sequential_28"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_56 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_57 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_28 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_28 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
71/71 [==============================] - 0s 7ms/step - loss: 3.2663 - accuracy: 0.4417
Epoch 2/20
71/71 [==============================] - 0s 7ms/step - loss: 3.2181 - accuracy: 0.3559
Epoch 3/20
71/71 [==============================] - 0s 6ms/step - loss: 3.1723 - accuracy: 0.4211
Epoch 4/20
71/71 [==============================] - 0s 7ms/step - loss: 3.1239 - accuracy: 0.4345
Epoch 5/20
71/71 [==============================] - 0s 7ms/step - loss: 3.0600 - accuracy: 0.4920
Epoch 6/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9865 - accuracy: 0.4856
Epoch 7/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9604 - accuracy: 0.5064
Epoch 8/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9486 - accuracy: 0.4894
Epoch 9/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9425 - accuracy: 0.5084
Epoch 10/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9340 - accuracy: 0.4739
Epoch 11/20
71/71 [==============================] - 1s 8ms/step - loss: 2.9238 - accuracy: 0.4684
Epoch 12/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9221 - accuracy: 0.4744
Epoch 13/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9200 - accuracy: 0.4731
Epoch 14/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9167 - accuracy: 0.4753
Epoch 15/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9094 - accuracy: 0.5087
Epoch 16/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9070 - accuracy: 0.4671
Epoch 17/20
71/71 [==============================] - 0s 7ms/step - loss: 2.9040 - accuracy: 0.4724
Epoch 18/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9007 - accuracy: 0.4761
Epoch 19/20
71/71 [==============================] - 0s 6ms/step - loss: 2.9007 - accuracy: 0.4842
Epoch 20/20
71/71 [==============================] - 0s 6ms/step - loss: 2.8965 - accuracy: 0.4621
18/18 [==============================] - 0s 2ms/step - loss: 0.9322 - accuracy: 0.5021


For 33: Test ACC=[0.9321912527084351, 0.5021162629127502]
Confusion Matrix
[[1359  655  816]
 [ 316  760  283]
 [  84   81  135]]
Classification Report
              precision    recall  f1-score   support

           0       0.77      0.48      0.59      2830
           1       0.51      0.56      0.53      1359
           2       0.11      0.45      0.18       300

    accuracy                           0.50      4489
   macro avg       0.46      0.50      0.43      4489
weighted avg       0.65      0.50      0.55      4489

trainingshape 34
(39836, 7)
(39836, 7, 1)
testingshape 34
(9960, 7)
(9960, 7, 1)
nb occurences
Counter({0: 24622, 1: 12820, 2: 2394})
weights={0: 1.6179026886524246, 1: 3.1073322932917318, 2: 16.639933166248955}
Model: "sequential_29"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_58 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_59 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_29 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_29 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
156/156 [==============================] - 1s 7ms/step - loss: 2.8990 - accuracy: 0.4719
Epoch 2/20
156/156 [==============================] - 1s 7ms/step - loss: 2.6717 - accuracy: 0.5846
Epoch 3/20
156/156 [==============================] - 1s 7ms/step - loss: 2.5711 - accuracy: 0.6286
Epoch 4/20
156/156 [==============================] - 1s 7ms/step - loss: 2.5204 - accuracy: 0.6374
Epoch 5/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4956 - accuracy: 0.6391
Epoch 6/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4788 - accuracy: 0.6371
Epoch 7/20
156/156 [==============================] - 1s 8ms/step - loss: 2.4661 - accuracy: 0.6416
Epoch 8/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4552 - accuracy: 0.6393
Epoch 9/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4442 - accuracy: 0.6421
Epoch 10/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4352 - accuracy: 0.6426
Epoch 11/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4214 - accuracy: 0.6458
Epoch 12/20
156/156 [==============================] - 1s 7ms/step - loss: 2.4085 - accuracy: 0.6516
Epoch 13/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3953 - accuracy: 0.6549
Epoch 14/20
156/156 [==============================] - 1s 6ms/step - loss: 2.3870 - accuracy: 0.6527
Epoch 15/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3764 - accuracy: 0.6561
Epoch 16/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3651 - accuracy: 0.6562
Epoch 17/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3511 - accuracy: 0.6586
Epoch 18/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3402 - accuracy: 0.6623
Epoch 19/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3314 - accuracy: 0.6619
Epoch 20/20
156/156 [==============================] - 1s 7ms/step - loss: 2.3181 - accuracy: 0.6652
39/39 [==============================] - 0s 2ms/step - loss: 0.7927 - accuracy: 0.6366


For 34: Test ACC=[0.7927393913269043, 0.636646568775177]
Confusion Matrix
[[3895  183 2078]
 [ 428 1967  810]
 [  75   45  479]]
Classification Report
              precision    recall  f1-score   support

           0       0.89      0.63      0.74      6156
           1       0.90      0.61      0.73      3205
           2       0.14      0.80      0.24       599

    accuracy                           0.64      9960
   macro avg       0.64      0.68      0.57      9960
weighted avg       0.84      0.64      0.71      9960

trainingshape 35
(11204, 7)
(11204, 7, 1)
testingshape 35
(2802, 7)
(2802, 7, 1)
nb occurences
Counter({0: 8019, 1: 2636, 2: 549})
weights={0: 1.39718169347799, 1: 4.250379362670714, 2: 20.408014571949}
Model: "sequential_30"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_60 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_61 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_30 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_30 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
44/44 [==============================] - 0s 7ms/step - loss: 3.3165 - accuracy: 0.4644
Epoch 2/20
44/44 [==============================] - 0s 6ms/step - loss: 3.2922 - accuracy: 0.3984
Epoch 3/20
44/44 [==============================] - 0s 7ms/step - loss: 3.2698 - accuracy: 0.5510
Epoch 4/20
44/44 [==============================] - 0s 6ms/step - loss: 3.2363 - accuracy: 0.5504
Epoch 5/20
44/44 [==============================] - 0s 6ms/step - loss: 3.1854 - accuracy: 0.4112
Epoch 6/20
44/44 [==============================] - 0s 6ms/step - loss: 3.1190 - accuracy: 0.3884
Epoch 7/20
44/44 [==============================] - 0s 6ms/step - loss: 3.0646 - accuracy: 0.3204
Epoch 8/20
44/44 [==============================] - 0s 6ms/step - loss: 3.0358 - accuracy: 0.3311
Epoch 9/20
44/44 [==============================] - 0s 7ms/step - loss: 3.0153 - accuracy: 0.3259
Epoch 10/20
44/44 [==============================] - 0s 7ms/step - loss: 3.0011 - accuracy: 0.3189
Epoch 11/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9885 - accuracy: 0.3559
Epoch 12/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9761 - accuracy: 0.3594
Epoch 13/20
44/44 [==============================] - 0s 7ms/step - loss: 2.9625 - accuracy: 0.3285
Epoch 14/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9538 - accuracy: 0.4680
Epoch 15/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9438 - accuracy: 0.3768
Epoch 16/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9281 - accuracy: 0.4239
Epoch 17/20
44/44 [==============================] - 0s 6ms/step - loss: 2.9149 - accuracy: 0.4820
Epoch 18/20
44/44 [==============================] - 0s 7ms/step - loss: 2.9058 - accuracy: 0.4737
Epoch 19/20
44/44 [==============================] - 0s 6ms/step - loss: 2.8883 - accuracy: 0.5373
Epoch 20/20
44/44 [==============================] - 0s 6ms/step - loss: 2.8830 - accuracy: 0.5252
11/11 [==============================] - 0s 2ms/step - loss: 0.9647 - accuracy: 0.5214


For 35: Test ACC=[0.9646701812744141, 0.521413266658783]
Confusion Matrix
[[990 353 662]
 [ 80 393 186]
 [ 23  37  78]]
Classification Report
              precision    recall  f1-score   support

           0       0.91      0.49      0.64      2005
           1       0.50      0.60      0.55       659
           2       0.08      0.57      0.15       138

    accuracy                           0.52      2802
   macro avg       0.50      0.55      0.44      2802
weighted avg       0.77      0.52      0.59      2802

trainingshape 36
(32911, 7)
(32911, 7, 1)
testingshape 36
(8229, 7)
(8229, 7, 1)
nb occurences
Counter({0: 24052, 1: 7912, 2: 947})
weights={0: 1.3683269582571096, 1: 4.1596309403437814, 2: 34.75290390707497}
Model: "sequential_31"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_62 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_63 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_31 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_31 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
129/129 [==============================] - 1s 7ms/step - loss: 3.3017 - accuracy: 0.3556
Epoch 2/20
129/129 [==============================] - 1s 6ms/step - loss: 3.1503 - accuracy: 0.5119
Epoch 3/20
129/129 [==============================] - 1s 7ms/step - loss: 2.9181 - accuracy: 0.5242
Epoch 4/20
129/129 [==============================] - 1s 6ms/step - loss: 2.7641 - accuracy: 0.5526
Epoch 5/20
129/129 [==============================] - 1s 6ms/step - loss: 2.6862 - accuracy: 0.5733
Epoch 6/20
129/129 [==============================] - 1s 7ms/step - loss: 2.5832 - accuracy: 0.6090
Epoch 7/20
129/129 [==============================] - 1s 6ms/step - loss: 2.5227 - accuracy: 0.6247
Epoch 8/20
129/129 [==============================] - 1s 7ms/step - loss: 2.4969 - accuracy: 0.6325
Epoch 9/20
129/129 [==============================] - 1s 7ms/step - loss: 2.4667 - accuracy: 0.6345
Epoch 10/20
129/129 [==============================] - 1s 7ms/step - loss: 2.4381 - accuracy: 0.6422
Epoch 11/20
129/129 [==============================] - 1s 6ms/step - loss: 2.4141 - accuracy: 0.6449
Epoch 12/20
129/129 [==============================] - 1s 6ms/step - loss: 2.3902 - accuracy: 0.6463
Epoch 13/20
129/129 [==============================] - 1s 6ms/step - loss: 2.3721 - accuracy: 0.6501
Epoch 14/20
129/129 [==============================] - 1s 6ms/step - loss: 2.3524 - accuracy: 0.6520
Epoch 15/20
129/129 [==============================] - 1s 7ms/step - loss: 2.3451 - accuracy: 0.6568
Epoch 16/20
129/129 [==============================] - 1s 6ms/step - loss: 2.3183 - accuracy: 0.6611
Epoch 17/20
129/129 [==============================] - 1s 6ms/step - loss: 2.3110 - accuracy: 0.6642
Epoch 18/20
129/129 [==============================] - 1s 6ms/step - loss: 2.2922 - accuracy: 0.6680
Epoch 19/20
129/129 [==============================] - 1s 6ms/step - loss: 2.2801 - accuracy: 0.6727
Epoch 20/20
129/129 [==============================] - 1s 7ms/step - loss: 2.2592 - accuracy: 0.6765
33/33 [==============================] - 0s 2ms/step - loss: 0.7744 - accuracy: 0.6752


For 36: Test ACC=[0.7743616104125977, 0.6751731634140015]
Confusion Matrix
[[3956 1715  343]
 [ 270 1453  255]
 [  21   69  147]]
Classification Report
              precision    recall  f1-score   support

           0       0.93      0.66      0.77      6014
           1       0.45      0.73      0.56      1978
           2       0.20      0.62      0.30       237

    accuracy                           0.68      8229
   macro avg       0.53      0.67      0.54      8229
weighted avg       0.79      0.68      0.71      8229

trainingshape 37
(13030, 7)
(13030, 7, 1)
testingshape 37
(3259, 7)
(3259, 7, 1)
nb occurences
Counter({0: 10200, 1: 2629, 2: 201})
weights={0: 1.2774509803921568, 1: 4.95625713198935, 2: 64.82587064676616}
Model: "sequential_32"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_64 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_65 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_32 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_32 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
51/51 [==============================] - 0s 7ms/step - loss: 3.2765 - accuracy: 0.2173
Epoch 2/20
51/51 [==============================] - 0s 6ms/step - loss: 3.2575 - accuracy: 0.2312
Epoch 3/20
51/51 [==============================] - 0s 6ms/step - loss: 3.2301 - accuracy: 0.3335
Epoch 4/20
51/51 [==============================] - 0s 6ms/step - loss: 3.2000 - accuracy: 0.3664
Epoch 5/20
51/51 [==============================] - 0s 6ms/step - loss: 3.1523 - accuracy: 0.3425
Epoch 6/20
51/51 [==============================] - 0s 6ms/step - loss: 3.1225 - accuracy: 0.4108
Epoch 7/20
51/51 [==============================] - 0s 6ms/step - loss: 3.0524 - accuracy: 0.4444
Epoch 8/20
51/51 [==============================] - 0s 6ms/step - loss: 2.9763 - accuracy: 0.4859
Epoch 9/20
51/51 [==============================] - 0s 6ms/step - loss: 2.9158 - accuracy: 0.3516
Epoch 10/20
51/51 [==============================] - 0s 6ms/step - loss: 2.8778 - accuracy: 0.4570
Epoch 11/20
51/51 [==============================] - 0s 6ms/step - loss: 2.8499 - accuracy: 0.4464
Epoch 12/20
51/51 [==============================] - 0s 6ms/step - loss: 2.8335 - accuracy: 0.4669
Epoch 13/20
51/51 [==============================] - 0s 6ms/step - loss: 2.8114 - accuracy: 0.4362
Epoch 14/20
51/51 [==============================] - 0s 8ms/step - loss: 2.7845 - accuracy: 0.5546
Epoch 15/20
51/51 [==============================] - 0s 7ms/step - loss: 2.7729 - accuracy: 0.4654
Epoch 16/20
51/51 [==============================] - 0s 6ms/step - loss: 2.7503 - accuracy: 0.5632
Epoch 17/20
51/51 [==============================] - 0s 6ms/step - loss: 2.7439 - accuracy: 0.5110
Epoch 18/20
51/51 [==============================] - 0s 6ms/step - loss: 2.7335 - accuracy: 0.5524
Epoch 19/20
51/51 [==============================] - 0s 6ms/step - loss: 2.7128 - accuracy: 0.5689
Epoch 20/20
51/51 [==============================] - 0s 6ms/step - loss: 2.7050 - accuracy: 0.5481
13/13 [==============================] - 0s 2ms/step - loss: 0.8932 - accuracy: 0.5839


For 37: Test ACC=[0.8932210206985474, 0.5839214324951172]
Confusion Matrix
[[1452  374  724]
 [  81  433  144]
 [  21   12   18]]
Classification Report
              precision    recall  f1-score   support

           0       0.93      0.57      0.71      2550
           1       0.53      0.66      0.59       658
           2       0.02      0.35      0.04        51

    accuracy                           0.58      3259
   macro avg       0.49      0.53      0.44      3259
weighted avg       0.84      0.58      0.67      3259

trainingshape 38
(14172, 7)
(14172, 7, 1)
testingshape 38
(3545, 7)
(3545, 7, 1)
nb occurences
Counter({0: 11651, 1: 2344, 2: 177})
weights={0: 1.216376276714445, 1: 6.046075085324232, 2: 80.0677966101695}
Model: "sequential_33"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_66 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_67 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_33 (Dense)             (None, 3)                 27
_________________________________________________________________
activation_33 (Activation)   (None, 3)                 0
=================================================================
Total params: 723
Trainable params: 723
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
56/56 [==============================] - 0s 7ms/step - loss: 3.3944 - accuracy: 0.2133
Epoch 2/20
56/56 [==============================] - 0s 7ms/step - loss: 3.2235 - accuracy: 0.4359
Epoch 3/20
56/56 [==============================] - 0s 6ms/step - loss: 3.1154 - accuracy: 0.6150
Epoch 4/20
56/56 [==============================] - 0s 7ms/step - loss: 2.9808 - accuracy: 0.6331
Epoch 5/20
56/56 [==============================] - 0s 8ms/step - loss: 2.8847 - accuracy: 0.6160
Epoch 6/20
56/56 [==============================] - 0s 6ms/step - loss: 2.8387 - accuracy: 0.5529
Epoch 7/20
56/56 [==============================] - 0s 6ms/step - loss: 2.7942 - accuracy: 0.5912
Epoch 8/20
56/56 [==============================] - 0s 6ms/step - loss: 2.7679 - accuracy: 0.5098
Epoch 9/20
56/56 [==============================] - 0s 6ms/step - loss: 2.7482 - accuracy: 0.5552
Epoch 10/20
56/56 [==============================] - 0s 6ms/step - loss: 2.7492 - accuracy: 0.5198
Epoch 11/20
56/56 [==============================] - 0s 6ms/step - loss: 2.7007 - accuracy: 0.5662
Epoch 12/20
56/56 [==============================] - 0s 6ms/step - loss: 2.6829 - accuracy: 0.5547
Epoch 13/20
56/56 [==============================] - 0s 6ms/step - loss: 2.6595 - accuracy: 0.5815
Epoch 14/20
56/56 [==============================] - 0s 6ms/step - loss: 2.6131 - accuracy: 0.5787
Epoch 15/20
56/56 [==============================] - 0s 6ms/step - loss: 2.5747 - accuracy: 0.5812
Epoch 16/20
56/56 [==============================] - 0s 6ms/step - loss: 2.5297 - accuracy: 0.5870
Epoch 17/20
56/56 [==============================] - 0s 6ms/step - loss: 2.4982 - accuracy: 0.5965
Epoch 18/20
56/56 [==============================] - 0s 8ms/step - loss: 2.4683 - accuracy: 0.6020
Epoch 19/20
56/56 [==============================] - 0s 7ms/step - loss: 2.4525 - accuracy: 0.5935
Epoch 20/20
56/56 [==============================] - 0s 6ms/step - loss: 2.4054 - accuracy: 0.6100
14/14 [==============================] - 0s 2ms/step - loss: 0.9028 - accuracy: 0.5523


For 38: Test ACC=[0.9028178453445435, 0.5523272156715393]
Confusion Matrix
[[1560  462  891]
 [  78  375  134]
 [   6   16   23]]
Classification Report
              precision    recall  f1-score   support

           0       0.95      0.54      0.68      2913
           1       0.44      0.64      0.52       587
           2       0.02      0.51      0.04        45

    accuracy                           0.55      3545
   macro avg       0.47      0.56      0.42      3545
weighted avg       0.85      0.55      0.65      3545

trainingshape 39
(19534, 7)
(19534, 7, 1)
testingshape 39
(4885, 7)
(4885, 7, 1)
nb occurences
Counter({0: 17090, 1: 2444})
weights={0: 1.1430076067875952, 1: 7.9926350245499185}
Model: "sequential_34"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_68 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_69 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_34 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_34 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
77/77 [==============================] - 1s 7ms/step - loss: 1.5086 - accuracy: 0.7697
Epoch 2/20
77/77 [==============================] - 1s 7ms/step - loss: 1.3670 - accuracy: 0.5787
Epoch 3/20
77/77 [==============================] - 0s 6ms/step - loss: 1.3416 - accuracy: 0.5985
Epoch 4/20
77/77 [==============================] - 1s 7ms/step - loss: 1.3226 - accuracy: 0.5778
Epoch 5/20
77/77 [==============================] - 0s 6ms/step - loss: 1.3114 - accuracy: 0.5719
Epoch 6/20
77/77 [==============================] - 0s 6ms/step - loss: 1.3012 - accuracy: 0.5587
Epoch 7/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2884 - accuracy: 0.5638
Epoch 8/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2771 - accuracy: 0.5581
Epoch 9/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2674 - accuracy: 0.5615
Epoch 10/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2581 - accuracy: 0.5752
Epoch 11/20
77/77 [==============================] - 0s 6ms/step - loss: 1.2475 - accuracy: 0.5713
Epoch 12/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2394 - accuracy: 0.5723
Epoch 13/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2312 - accuracy: 0.5690
Epoch 14/20
77/77 [==============================] - 1s 7ms/step - loss: 1.2122 - accuracy: 0.5720
Epoch 15/20
77/77 [==============================] - 1s 8ms/step - loss: 1.1936 - accuracy: 0.5670
Epoch 16/20
77/77 [==============================] - 1s 7ms/step - loss: 1.1746 - accuracy: 0.5717
Epoch 17/20
77/77 [==============================] - 1s 7ms/step - loss: 1.1582 - accuracy: 0.5982
Epoch 18/20
77/77 [==============================] - 1s 8ms/step - loss: 1.1432 - accuracy: 0.6275
Epoch 19/20
77/77 [==============================] - 1s 7ms/step - loss: 1.1274 - accuracy: 0.6592
Epoch 20/20
77/77 [==============================] - 0s 6ms/step - loss: 1.1315 - accuracy: 0.6755
20/20 [==============================] - 0s 2ms/step - loss: 0.6402 - accuracy: 0.5754


For 39: Test ACC=[0.6401579976081848, 0.5754349827766418]
Confusion Matrix
[[2281 1992]
 [  82  530]]
Classification Report
              precision    recall  f1-score   support

           0       0.97      0.53      0.69      4273
           1       0.21      0.87      0.34       612

    accuracy                           0.58      4885
   macro avg       0.59      0.70      0.51      4885
weighted avg       0.87      0.58      0.64      4885

trainingshape 40
(5403, 7)
(5403, 7, 1)
testingshape 40
(1352, 7)
(1352, 7, 1)
nb occurences
Counter({0: 4740, 1: 663})
weights={0: 1.139873417721519, 1: 8.149321266968325}
Model: "sequential_35"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_70 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_71 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_35 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_35 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
22/22 [==============================] - 0s 7ms/step - loss: 1.3880 - accuracy: 0.6498
Epoch 2/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3870 - accuracy: 0.1997
Epoch 3/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3862 - accuracy: 0.1962
Epoch 4/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3862 - accuracy: 0.8753
Epoch 5/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3860 - accuracy: 0.2521
Epoch 6/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3857 - accuracy: 0.2730
Epoch 7/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3861 - accuracy: 0.8730
Epoch 8/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3862 - accuracy: 0.1601
Epoch 9/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3872 - accuracy: 0.7470
Epoch 10/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3857 - accuracy: 0.1710
Epoch 11/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3853 - accuracy: 0.5306
Epoch 12/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3849 - accuracy: 0.5976
Epoch 13/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3851 - accuracy: 0.7307
Epoch 14/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3847 - accuracy: 0.8582
Epoch 15/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3846 - accuracy: 0.2700
Epoch 16/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3842 - accuracy: 0.7649
Epoch 17/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3836 - accuracy: 0.3178
Epoch 18/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3838 - accuracy: 0.5756
Epoch 19/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3854 - accuracy: 0.8751
Epoch 20/20
22/22 [==============================] - 0s 6ms/step - loss: 1.3825 - accuracy: 0.3963
6/6 [==============================] - 0s 2ms/step - loss: 0.7008 - accuracy: 0.2737


For 40: Test ACC=[0.7008328437805176, 0.27366864681243896]
Confusion Matrix
[[219 967]
 [ 15 151]]
Classification Report
              precision    recall  f1-score   support

           0       0.94      0.18      0.31      1186
           1       0.14      0.91      0.24       166

    accuracy                           0.27      1352
   macro avg       0.54      0.55      0.27      1352
weighted avg       0.84      0.27      0.30      1352

trainingshape 41
(12937, 7)
(12937, 7, 1)
testingshape 41
(3236, 7)
(3236, 7, 1)
nb occurences
Counter({0: 11960, 1: 977})
weights={0: 1.0816889632107023, 1: 13.241555783009213}
Model: "sequential_36"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
gru_72 (GRU)                 (None, 7, 8)              264
_________________________________________________________________
gru_73 (GRU)                 (None, 8)                 432
_________________________________________________________________
dense_36 (Dense)             (None, 2)                 18
_________________________________________________________________
activation_36 (Activation)   (None, 2)                 0
=================================================================
Total params: 714
Trainable params: 714
Non-trainable params: 0
_________________________________________________________________
None
Epoch 1/20
51/51 [==============================] - 0s 7ms/step - loss: 1.3925 - accuracy: 0.4428
Epoch 2/20
51/51 [==============================] - 0s 7ms/step - loss: 1.3791 - accuracy: 0.5824
Epoch 3/20
51/51 [==============================] - 0s 7ms/step - loss: 1.3662 - accuracy: 0.4132
Epoch 4/20
51/51 [==============================] - 0s 7ms/step - loss: 1.3558 - accuracy: 0.3952
Epoch 5/20
51/51 [==============================] - 0s 6ms/step - loss: 1.3475 - accuracy: 0.4256
Epoch 6/20
51/51 [==============================] - 0s 6ms/step - loss: 1.3418 - accuracy: 0.4215
Epoch 7/20
51/51 [==============================] - 0s 6ms/step - loss: 1.3252 - accuracy: 0.4333
Epoch 8/20
51/51 [==============================] - 0s 6ms/step - loss: 1.3010 - accuracy: 0.5392
Epoch 9/20
51/51 [==============================] - 0s 7ms/step - loss: 1.2810 - accuracy: 0.6842
Epoch 10/20
51/51 [==============================] - 0s 7ms/step - loss: 1.2575 - accuracy: 0.7053
Epoch 11/20
51/51 [==============================] - 0s 7ms/step - loss: 1.2370 - accuracy: 0.7278
Epoch 12/20
51/51 [==============================] - 0s 8ms/step - loss: 1.2160 - accuracy: 0.7172
Epoch 13/20
51/51 [==============================] - 0s 6ms/step - loss: 1.1936 - accuracy: 0.7431
Epoch 14/20
51/51 [==============================] - 0s 7ms/step - loss: 1.1679 - accuracy: 0.7573
Epoch 15/20
51/51 [==============================] - 0s 7ms/step - loss: 1.1405 - accuracy: 0.7734
Epoch 16/20
51/51 [==============================] - 0s 6ms/step - loss: 1.1255 - accuracy: 0.8031
Epoch 17/20
51/51 [==============================] - 0s 7ms/step - loss: 1.0978 - accuracy: 0.8163
Epoch 18/20
51/51 [==============================] - 0s 6ms/step - loss: 1.0792 - accuracy: 0.8344
Epoch 19/20
51/51 [==============================] - 0s 6ms/step - loss: 1.0721 - accuracy: 0.8355
Epoch 20/20
51/51 [==============================] - 0s 7ms/step - loss: 1.0568 - accuracy: 0.8432
13/13 [==============================] - 0s 2ms/step - loss: 0.4448 - accuracy: 0.8736


For 41: Test ACC=[0.44475099444389343, 0.8736094236373901]
Confusion Matrix
[[2692  299]
 [ 110  135]]
Classification Report
              precision    recall  f1-score   support

           0       0.96      0.90      0.93      2991
           1       0.31      0.55      0.40       245

    accuracy                           0.87      3236
   macro avg       0.64      0.73      0.66      3236
weighted avg       0.91      0.87      0.89      3236